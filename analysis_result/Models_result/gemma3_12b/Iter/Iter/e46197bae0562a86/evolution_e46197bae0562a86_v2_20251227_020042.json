{
  "sha256": "e46197bae0562a86bbbb3997e50665da481b171e4651496d51be11220e7f609b",
  "prompt_version": "v2",
  "iterations": [
    {
      "iteration": 0,
      "prompt_version": "v2",
      "yara_rule": "rule Bypass_Sample_Evasion\n{\n    meta:\n        description = \"Evasion bypass rule - API Call 2\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { E8 ?? ?? ?? ?? 85 C0 0F 84 ?? ?? ?? ?? 8B 45 ?? }\n        $pattern1 = { 6A ?? 5A 8B CE E8 ?? ?? ?? ?? 85 C0 0F 84 ?? ?? ?? ?? }\n        $pattern2 = { 6A ?? 5A 8B CE E8 ?? ?? ?? ?? 55 8B EC }\n\n    condition:\n        any of them\n}",
      "pattern_type": "UNKNOWN",
      "confidence": 50,
      "opcodes": "",
      "task_id": "55",
      "status": "rule_hit",
      "rule_hit": true,
      "baseline_signatures": 16,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule hit but no new signatures",
      "improvement_suggestions": [
        "The skip offset needs to be adjusted to accurately bypass the irrelevant code and allow the debugger to continue execution.  A more thorough analysis of the surrounding code is required to determine the correct offset. It's possible the offset is too small, causing it to jump back into the same block of code."
      ],
      "debugger_log": "=== 6056.log ===\nCAPE Sandbox - Debugger log: Sat Dec 27 15:33:43 2025\nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7744 ECX=0x43e2f64 EDX=0x43d4ba8 ESI=0x43a84d8 EDI=0x43e2f64 ESP=0x19d090 *ESP=0x6c82e0 \"TL\" EBP=0x19d164\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e4988 EDX=0x43d4ba8 ESI=0x43e51f4 EDI=0x43e4988 ESP=0x19d090 *ESP=0x6c82e0 \"TL\" EBP=0x19d164\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e5248 EDX=0x43d4ba8 ESI=0x43e52f4 EDI=0x43e5248 ESP=0x19d090 *ESP=0x6c82e0 \"TL\" EBP=0x19d164\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e5e64 EDX=0x43d4ba8 ESI=0x43e6178 EDI=0x43e5e64 ESP=0x19d090 *ESP=0x6c82e0 \"TL\" EBP=0x19d164\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e61e4 EDX=0x43d4ba8 ESI=0x43e6294 EDI=0x43e61e4 ESP=0x19d090 *ESP=0x6c82e0 \"TL\" EBP=0x19d164\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e62b8 EDX=0x43d4ba8 ESI=0x43a84d8 EDI=0x43e62b8 ESP=0x19cfa0 *ESP=0x0 EBP=0x19d074\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e65d4 EDX=0x43d4ba8 ESI=0x43e666c EDI=0x43e65d4 ESP=0x19cfa0 *ESP=0x0 EBP=0x19d074\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e6924 EDX=0x43d4ba8 ESI=0x43e6a98 EDI=0x43e6924 ESP=0x19cfa0 *ESP=0x0 EBP=0x19d074\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e6f00 EDX=0x43d4ba8 ESI=0x43e6294 EDI=0x43e6f00 ESP=0x19d090 *ESP=0x6c82e0 \"TL\" EBP=0x19d164\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e6fc4 EDX=0x43d4ba8 ESI=0x43a84d8 EDI=0x43e6fc4 ESP=0x19cfa0 *ESP=0x0 EBP=0x19d074\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e7280 EDX=0x43d4ba8 ESI=0x43e7324 EDI=0x43e7280 ESP=0x19cfa0 *ESP=0x0 EBP=0x19d074\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e7384 EDX=0x43d4ba8 ESI=0x43e7424 EDI=0x43e7384 ESP=0x19cfa0 *ESP=0x0 EBP=0x19d074\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e7b20 EDX=0x43d4ba8 ESI=0x43e7bb8 EDI=0x43e7b20 ESP=0x19cfa0 *ESP=0x0 EBP=0x19d074\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x08D00D9C (thread 6124) EBX=0x43a7a6c ECX=0x43e7c10 EDX=0x43d4ba8 ESI=0x43e7cb0 EDI=0x43e7c10 ESP=0x19cfa0 *ESP=0x0 EBP=0x19d074\n0x08D00D9C  E8A77C38FB               CALL      0xfb387cac                    \nActionDispatcher: skipping instruction.\n0x08D00DA1  85C0                     TEST      EAX, EAX                      \n",
      "raw_response": "```yara\nrule Bypass_Sample_Evasion\n{\n    meta:\n        description = \"Evasion bypass rule - API Call 2\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { E8 ?? ?? ?? ?? 85 C0 0F 84 ?? ?? ?? ?? 8B 45 ?? }\n        $pattern1 = { 6A ?? 5A 8B CE E8 ?? ?? ?? ?? 85 C0 0F 84 ?? ?? ?? ?? }\n        $pattern2 = { 6A ?? 5A 8B CE E8 ?? ?? ?? ?? 55 8B EC }\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\gemma3_12b\\Iter\\Iter\\e46197bae0562a86\\iter0_v2.yar"
    },
    {
      "iteration": 1,
      "prompt_version": "v2",
      "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 6A 5B }\n        $pattern1 = { 85 C0 0F 84 33 FD FF FF }\n        $pattern2 = { 8B 85 F0 FE FF FF }\n\n    condition:\n        any of them\n}",
      "pattern_type": "CALL_TEST_JE",
      "confidence": 65,
      "opcodes": "",
      "task_id": "56",
      "status": "bypass_success",
      "rule_hit": true,
      "baseline_signatures": 16,
      "new_signatures": 22,
      "new_signature_names": [
        "terminates_remote_process",
        "queries_keyboard_layout",
        "antiav_detectfile",
        "http_request",
        "creates_suspended_process",
        "persistence_autorun_tasks",
        "antivm_generic_system",
        "queries_computer_name",
        "reads_self",
        "suspicious_command_tools",
        "infostealer_cookies",
        "queries_locale_api",
        "uses_windows_utilities_to_create_scheduled_task",
        "uses_windows_utilities",
        "cmdline_obfuscation",
        "recon_beacon",
        "stealth_window",
        "antisandbox_sleep",
        "injection_write_process",
        "resumethread_remote_process",
        "dynamic_function_loading",
        "stealth_timeout"
      ],
      "new_signature_details": [
        {
          "name": "queries_computer_name",
          "description": "Queries computer hostname",
          "categories": [
            "system_discovery"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 7056,
              "cid": 133
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "dynamic_function_loading",
          "description": "Dynamic (imported) function loading detected",
          "categories": [
            "anti-debug"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 40,
          "references": [],
          "data": [
            {
              "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3833
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3834
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3835
            },
            {
              "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3836
            },
            {
              "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3837
            },
            {
              "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3838
            },
            {
              "DynamicLoader": "apphelp.dll/SdbQueryContext"
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3839
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 155
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 156
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 157
            },
            {
              "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 158
            },
            {
              "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 159
            },
            {
              "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 160
            },
            {
              "DynamicLoader": "apphelp.dll/SdbQueryContext"
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 161
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "queries_keyboard_layout",
          "description": "Queries the keyboard layout",
          "categories": [
            "location_discovery"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 6168,
              "cid": 3912
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4398
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4965
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "queries_locale_api",
          "description": "Queries the computer locale (possible geofencing)",
          "categories": [
            "location_discovery",
            "geofence"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 6168,
              "cid": 1068
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 1089
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3688
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4272
            },
            {
              "type": "call",
              "pid": 7056,
              "cid": 135
            },
            {
              "type": "call",
              "pid": 7056,
              "cid": 141
            },
            {
              "type": "call",
              "pid": 7056,
              "cid": 164
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 71
            },
            {
              "type": "call",
              "pid": 2228,
              "cid": 2540
            },
            {
              "type": "call",
              "pid": 2228,
              "cid": 6903
            },
            {
              "type": "call",
              "pid": 2228,
              "cid": 10553
            },
            {
              "type": "call",
              "pid": 2228,
              "cid": 14194
            },
            {
              "type": "call",
              "pid": 2228,
              "cid": 17839
            },
            {
              "type": "call",
              "pid": 2228,
              "cid": 21469
            },
            {
              "type": "call",
              "pid": 2228,
              "cid": 25108
            },
            {
              "type": "call",
              "pid": 2228,
              "cid": 28750
            },
            {
              "type": "call",
              "pid": 6008,
              "cid": 67
            },
            {
              "type": "call",
              "pid": 3172,
              "cid": 23
            },
            {
              "type": "call",
              "pid": 3172,
              "cid": 32
            },
            {
              "type": "call",
              "pid": 3808,
              "cid": 23
            },
            {
              "type": "call",
              "pid": 3808,
              "cid": 32
            },
            {
              "type": "call",
              "pid": 5216,
              "cid": 67
            },
            {
              "type": "call",
              "pid": 2796,
              "cid": 20
            },
            {
              "type": "call",
              "pid": 2796,
              "cid": 29
            },
            {
              "type": "call",
              "pid": 5140,
              "cid": 23
            },
            {
              "type": "call",
              "pid": 5140,
              "cid": 32
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "stealth_timeout",
          "description": "Possible date expiration check, exits too soon after checking local time",
          "categories": [
            "stealth"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 40,
          "references": [],
          "data": [
            {
              "process": "rjl67Lu28.exe, PID 2912"
            },
            {
              "type": "call",
              "pid": 2912,
              "cid": 579
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antisandbox_sleep",
          "description": "A process attempted to delay the analysis task.",
          "categories": [
            "anti-sandbox"
          ],
          "severity": 2,
          "weight": 4,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 7724,
              "cid": 837
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 912
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 992
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 998
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 1004
            },
            {
              "type": "call",
              "pid": 9172,
              "cid": 2067
            },
            {
              "type": "call",
              "pid": 7140,
              "cid": 2148
            },
            {
              "type": "call",
              "pid": 6164,
              "cid": 2132
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4401
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4480
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4482
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4878
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4888
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4898
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4967
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4990
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 5022
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 5027
            },
            {
              "type": "call",
              "pid": 2228,
              "cid": 6165
            },
            {
              "type": "call",
              "pid": 2228,
              "cid": 12137
            },
            {
              "type": "call",
              "pid": 2228,
              "cid": 19423
            },
            {
              "type": "call",
              "pid": 2228,
              "cid": 26391
            },
            {
              "note": "mnolyk.exe tried to sleep 386.0 seconds, actually delayed analysis time by 0.0 seconds"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "http_request",
          "description": "Performs HTTP requests potentially not found in PCAP.",
          "categories": [
            "network"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 6168,
              "cid": 4971
            },
            {
              "url": "193.233.20.15:80//dF30Hn4m/index.php"
            },
            {
              "url": "193.233.20.15:80//dF30Hn4m/index.php"
            },
            {
              "url": "http://193.233.20.15/dF30Hn4m/Plugins/cred64.dll"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "creates_suspended_process",
          "description": "Creates a process in a suspended state, likely for injection",
          "categories": [
            "injection",
            "process hollowing"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 50,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 1056,
              "cid": 3
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "resumethread_remote_process",
          "description": "Resumed a thread in another process",
          "categories": [
            "injection",
            "unpacking"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "thread_resumed": "Process mnolyk.exe with process ID 6168 resumed a thread in another process with the process ID 7056"
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3858
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4343
            },
            {
              "thread_resumed": "Process cmd.exe with process ID 8376 resumed a thread in another process with the process ID 6008"
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 175
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 247
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 306
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 357
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 428
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 488
            },
            {
              "thread_resumed": "Process svchost.exe with process ID 1056 resumed a thread in another process with the process ID 2228"
            },
            {
              "type": "call",
              "pid": 1056,
              "cid": 4
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "injection_write_process",
          "description": "Writes to the memory another process",
          "categories": [
            "injection",
            "unpacking"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "write_memory": "Process mnolyk.exe with process ID 6168 wrote to the memory of process handle 0x00000520"
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3849
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3851
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3852
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4330
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4332
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4333
            },
            {
              "write_memory": "Process cmd.exe with process ID 8376 wrote to the memory of process handle 0x000002d4"
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 171
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 173
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 174
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 243
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 245
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 246
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 302
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 304
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 305
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 353
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 355
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 356
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 424
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 426
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 427
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 484
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 486
            },
            {
              "type": "call",
              "pid": 8376,
              "cid": 487
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "reads_self",
          "description": "Reads data out of its own binary image",
          "categories": [
            "generic"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 30,
          "references": [],
          "data": [
            {
              "self_read": "process: rjl67Lu28.exe, pid: 2912, offset: 0x00000000, length: 0x00032000"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "stealth_window",
          "description": "A process created a hidden window",
          "categories": [
            "stealth"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "process": "rjl67Lu28.exe -> C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe"
            },
            {
              "type": "call",
              "pid": 2912,
              "cid": 574
            },
            {
              "process": "mnolyk.exe -> SCHTASKS"
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3900
            },
            {
              "process": "mnolyk.exe -> cmd"
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4400
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "terminates_remote_process",
          "description": "Terminates another process",
          "categories": [
            "persistence",
            "stealth"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 1056,
              "cid": 0
            },
            {
              "process": "svchost.exe"
            },
            {
              "type": "call",
              "pid": 1056,
              "cid": 15
            },
            {
              "process": "svchost.exe"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "uses_windows_utilities",
          "description": "Uses Windows utilities for basic functionality",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
            },
            {
              "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
            },
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "C:\\Windows\\system32\\cmd.exe  /S /D /c\" echo Y\""
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "uses_windows_utilities_to_create_scheduled_task",
          "description": "Uses Windows utilities to create a scheduled task",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antivm_generic_system",
          "description": "Checks the system manufacturer, likely for anti-virtualization",
          "categories": [
            "anti-vm"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [],
          "new_data": [
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 2228
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            }
          ],
          "alert": false,
          "families": []
        },
        {
          "name": "infostealer_cookies",
          "description": "Touches a file containing cookies, possibly for information gathering",
          "categories": [
            "infostealer"
          ],
          "severity": 3,
          "weight": 4,
          "confidence": 100,
          "references": [],
          "data": [],
          "new_data": [
            {
              "process": {
                "process_name": "mnolyk.exe",
                "process_id": 6168
              },
              "signs": [
                {
                  "type": "file",
                  "value": "C:\\Users\\sanya\\AppData\\Local\\Microsoft\\Windows\\INetCookies"
                }
              ]
            }
          ],
          "alert": false,
          "families": []
        },
        {
          "name": "persistence_autorun_tasks",
          "description": "Installs itself for autorun at Windows startup",
          "categories": [
            "persistence"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 9108,
              "cid": 225
            },
            {
              "type": "call",
              "pid": 3552,
              "cid": 228
            },
            {
              "type": "call",
              "pid": 8796,
              "cid": 219
            },
            {
              "type": "call",
              "pid": 8236,
              "cid": 212
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 953
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 959
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 963
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 967
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 971
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 977
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 981
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 988
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 1010
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 1013
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 1017
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 1021
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 1025
            },
            {
              "type": "call",
              "pid": 7724,
              "cid": 1029
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 38
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3161
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3162
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3163
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3164
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3253
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3254
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3255
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 3256
            },
            {
              "task": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "recon_beacon",
          "description": "A process sent information about the computer to a remote location.",
          "categories": [
            "network",
            "discovery"
          ],
          "severity": 3,
          "weight": 2,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 6168,
              "cid": 4496
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4882
            },
            {
              "type": "call",
              "pid": 6168,
              "cid": 4994
            },
            {
              "Beacon": "mnolyk.exe: id=260811189190&vs=3.67&sd=c51b61&os=1&bi=1&ar=1&pc=DESKTOP-KJGI8L3&un=sanya&dm=&av=13&lv=0&og=1"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antiav_detectfile",
          "description": "Attempts to identify installed AV products by installation directory",
          "categories": [
            "anti-av"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "file": "C:\\ProgramData\\AVAST Software"
            },
            {
              "file": "C:\\ProgramData\\Avira"
            },
            {
              "file": "C:\\ProgramData\\Kaspersky Lab"
            },
            {
              "file": "C:\\ProgramData\\ESET"
            },
            {
              "file": "C:\\ProgramData\\Panda Security"
            },
            {
              "file": "C:\\ProgramData\\Bitdefender"
            },
            {
              "file": "C:\\ProgramData\\AVG"
            },
            {
              "file": "C:\\ProgramData\\Doctor Web"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "cmdline_obfuscation",
          "description": "Appears to use command line obfuscation",
          "categories": [
            "command"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [
            "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf"
          ],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "suspicious_command_tools",
          "description": "Uses suspicious command line tools or Windows utilities",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
            },
            {
              "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
            },
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "CACLS  \"mnolyk.exe\" /P \"sanya:N\""
            },
            {
              "command": "CACLS  \"mnolyk.exe\" /P \"sanya:R\" /E"
            },
            {
              "command": "CACLS  \"..\\4f9dd6f8a7\" /P \"sanya:N\""
            },
            {
              "command": "CACLS  \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        }
      ],
      "failure_reason": null,
      "improvement_suggestions": [],
      "debugger_log": "=== 6164.log ===\nCAPE Sandbox - Debugger log: Sat Dec 27 15:01:08 2025\nBreakpoint 2 hit by instruction at 0x06E61CEB (thread 8824) EAX=0x41a1c00 ECX=0x1 EDX=0x147 ESI=0x41a1b08 EDI=0x19e718 ESP=0x19e5f0 *ESP=0x3de8f14 EBP=0x19e728\n0x06E61CEB  8B85F0FEFFFF             MOV       EAX, [EBP-0x110]              \nActionDispatcher: skipping instruction.\n0x06E61CF1  83780400                 CMP       DWORD [EAX+0x4], 0x0          \n\n\n=== 7140.log ===\nCAPE Sandbox - Debugger log: Sat Dec 27 15:00:44 2025\nBreakpoint 2 hit by instruction at 0x04161CEB (thread 2580) EAX=0x4345418 ECX=0x1 EDX=0x147 ESI=0x4345320 EDI=0x19e718 \" S4\" ESP=0x19e5f0 *ESP=0x3f48f14 EBP=0x19e728\n0x04161CEB  8B85F0FEFFFF             MOV       EAX, [EBP-0x110]              \nActionDispatcher: skipping instruction.\n0x04161CF1  83780400                 CMP       DWORD [EAX+0x4], 0x0          \n\n\n=== 9172.log ===\nCAPE Sandbox - Debugger log: Sat Dec 27 15:00:18 2025\nBreakpoint 2 hit by instruction at 0x04391CEB (thread 2992) EAX=0x43e1c00 ECX=0x1 EDX=0x147 ESI=0x43e1b08 EDI=0x19e718 ESP=0x19e5f0 *ESP=0x3f48f14 EBP=0x19e728\n0x04391CEB  8B85F0FEFFFF             MOV       EAX, [EBP-0x110]              \nActionDispatcher: skipping instruction.\n0x04391CF1  83780400                 CMP       DWORD [EAX+0x4], 0x0          \n",
      "raw_response": "**EVOLUTION_REASONING**: The previous rule hit but didn't bypass, indicating it matched the wrong location. We need to shift the bypass point earlier in the trace to target the evasion check itself. I'm focusing on Strategy A (Evasion Check) and selecting patterns that seem to be part of a conditional check before the ExitProcess call. The patterns are carefully selected from the trace and are concrete where possible.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 65\n\n**REASONING**: These patterns target a common structure of evasion checks: a call to a function, followed by a test of a register (likely the return value of the called function), and then a conditional jump based on the result. By bypassing this conditional check, we hope to prevent the malware from detecting the debugger.\n\n**YARA_RULE**:\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 6A 5B }\n        $pattern1 = { 85 C0 0F 84 33 FD FF FF }\n        $pattern2 = { 8B 85 F0 FE FF FF }\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\gemma3_12b\\Iter\\Iter\\e46197bae0562a86\\iter1_v2.yar"
    }
  ],
  "best_attempt": {
    "iteration": 1,
    "prompt_version": "v2",
    "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 6A 5B }\n        $pattern1 = { 85 C0 0F 84 33 FD FF FF }\n        $pattern2 = { 8B 85 F0 FE FF FF }\n\n    condition:\n        any of them\n}",
    "pattern_type": "CALL_TEST_JE",
    "confidence": 65,
    "opcodes": "",
    "task_id": "56",
    "status": "bypass_success",
    "rule_hit": true,
    "baseline_signatures": 16,
    "new_signatures": 22,
    "new_signature_names": [
      "terminates_remote_process",
      "queries_keyboard_layout",
      "antiav_detectfile",
      "http_request",
      "creates_suspended_process",
      "persistence_autorun_tasks",
      "antivm_generic_system",
      "queries_computer_name",
      "reads_self",
      "suspicious_command_tools",
      "infostealer_cookies",
      "queries_locale_api",
      "uses_windows_utilities_to_create_scheduled_task",
      "uses_windows_utilities",
      "cmdline_obfuscation",
      "recon_beacon",
      "stealth_window",
      "antisandbox_sleep",
      "injection_write_process",
      "resumethread_remote_process",
      "dynamic_function_loading",
      "stealth_timeout"
    ],
    "new_signature_details": [
      {
        "name": "queries_computer_name",
        "description": "Queries computer hostname",
        "categories": [
          "system_discovery"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 7056,
            "cid": 133
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "dynamic_function_loading",
        "description": "Dynamic (imported) function loading detected",
        "categories": [
          "anti-debug"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 40,
        "references": [],
        "data": [
          {
            "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3833
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3834
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3835
          },
          {
            "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3836
          },
          {
            "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3837
          },
          {
            "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3838
          },
          {
            "DynamicLoader": "apphelp.dll/SdbQueryContext"
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3839
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 155
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 156
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 157
          },
          {
            "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 158
          },
          {
            "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 159
          },
          {
            "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 160
          },
          {
            "DynamicLoader": "apphelp.dll/SdbQueryContext"
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 161
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "queries_keyboard_layout",
        "description": "Queries the keyboard layout",
        "categories": [
          "location_discovery"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 6168,
            "cid": 3912
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4398
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4965
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "queries_locale_api",
        "description": "Queries the computer locale (possible geofencing)",
        "categories": [
          "location_discovery",
          "geofence"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 6168,
            "cid": 1068
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 1089
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3688
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4272
          },
          {
            "type": "call",
            "pid": 7056,
            "cid": 135
          },
          {
            "type": "call",
            "pid": 7056,
            "cid": 141
          },
          {
            "type": "call",
            "pid": 7056,
            "cid": 164
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 71
          },
          {
            "type": "call",
            "pid": 2228,
            "cid": 2540
          },
          {
            "type": "call",
            "pid": 2228,
            "cid": 6903
          },
          {
            "type": "call",
            "pid": 2228,
            "cid": 10553
          },
          {
            "type": "call",
            "pid": 2228,
            "cid": 14194
          },
          {
            "type": "call",
            "pid": 2228,
            "cid": 17839
          },
          {
            "type": "call",
            "pid": 2228,
            "cid": 21469
          },
          {
            "type": "call",
            "pid": 2228,
            "cid": 25108
          },
          {
            "type": "call",
            "pid": 2228,
            "cid": 28750
          },
          {
            "type": "call",
            "pid": 6008,
            "cid": 67
          },
          {
            "type": "call",
            "pid": 3172,
            "cid": 23
          },
          {
            "type": "call",
            "pid": 3172,
            "cid": 32
          },
          {
            "type": "call",
            "pid": 3808,
            "cid": 23
          },
          {
            "type": "call",
            "pid": 3808,
            "cid": 32
          },
          {
            "type": "call",
            "pid": 5216,
            "cid": 67
          },
          {
            "type": "call",
            "pid": 2796,
            "cid": 20
          },
          {
            "type": "call",
            "pid": 2796,
            "cid": 29
          },
          {
            "type": "call",
            "pid": 5140,
            "cid": 23
          },
          {
            "type": "call",
            "pid": 5140,
            "cid": 32
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "stealth_timeout",
        "description": "Possible date expiration check, exits too soon after checking local time",
        "categories": [
          "stealth"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 40,
        "references": [],
        "data": [
          {
            "process": "rjl67Lu28.exe, PID 2912"
          },
          {
            "type": "call",
            "pid": 2912,
            "cid": 579
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "antisandbox_sleep",
        "description": "A process attempted to delay the analysis task.",
        "categories": [
          "anti-sandbox"
        ],
        "severity": 2,
        "weight": 4,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 7724,
            "cid": 837
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 912
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 992
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 998
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 1004
          },
          {
            "type": "call",
            "pid": 9172,
            "cid": 2067
          },
          {
            "type": "call",
            "pid": 7140,
            "cid": 2148
          },
          {
            "type": "call",
            "pid": 6164,
            "cid": 2132
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4401
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4480
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4482
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4878
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4888
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4898
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4967
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4990
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 5022
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 5027
          },
          {
            "type": "call",
            "pid": 2228,
            "cid": 6165
          },
          {
            "type": "call",
            "pid": 2228,
            "cid": 12137
          },
          {
            "type": "call",
            "pid": 2228,
            "cid": 19423
          },
          {
            "type": "call",
            "pid": 2228,
            "cid": 26391
          },
          {
            "note": "mnolyk.exe tried to sleep 386.0 seconds, actually delayed analysis time by 0.0 seconds"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "http_request",
        "description": "Performs HTTP requests potentially not found in PCAP.",
        "categories": [
          "network"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 6168,
            "cid": 4971
          },
          {
            "url": "193.233.20.15:80//dF30Hn4m/index.php"
          },
          {
            "url": "193.233.20.15:80//dF30Hn4m/index.php"
          },
          {
            "url": "http://193.233.20.15/dF30Hn4m/Plugins/cred64.dll"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "creates_suspended_process",
        "description": "Creates a process in a suspended state, likely for injection",
        "categories": [
          "injection",
          "process hollowing"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 50,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 1056,
            "cid": 3
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "resumethread_remote_process",
        "description": "Resumed a thread in another process",
        "categories": [
          "injection",
          "unpacking"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "thread_resumed": "Process mnolyk.exe with process ID 6168 resumed a thread in another process with the process ID 7056"
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3858
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4343
          },
          {
            "thread_resumed": "Process cmd.exe with process ID 8376 resumed a thread in another process with the process ID 6008"
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 175
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 247
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 306
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 357
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 428
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 488
          },
          {
            "thread_resumed": "Process svchost.exe with process ID 1056 resumed a thread in another process with the process ID 2228"
          },
          {
            "type": "call",
            "pid": 1056,
            "cid": 4
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "injection_write_process",
        "description": "Writes to the memory another process",
        "categories": [
          "injection",
          "unpacking"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "write_memory": "Process mnolyk.exe with process ID 6168 wrote to the memory of process handle 0x00000520"
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3849
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3851
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3852
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4330
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4332
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4333
          },
          {
            "write_memory": "Process cmd.exe with process ID 8376 wrote to the memory of process handle 0x000002d4"
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 171
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 173
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 174
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 243
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 245
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 246
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 302
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 304
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 305
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 353
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 355
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 356
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 424
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 426
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 427
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 484
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 486
          },
          {
            "type": "call",
            "pid": 8376,
            "cid": 487
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "reads_self",
        "description": "Reads data out of its own binary image",
        "categories": [
          "generic"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 30,
        "references": [],
        "data": [
          {
            "self_read": "process: rjl67Lu28.exe, pid: 2912, offset: 0x00000000, length: 0x00032000"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "stealth_window",
        "description": "A process created a hidden window",
        "categories": [
          "stealth"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "process": "rjl67Lu28.exe -> C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe"
          },
          {
            "type": "call",
            "pid": 2912,
            "cid": 574
          },
          {
            "process": "mnolyk.exe -> SCHTASKS"
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3900
          },
          {
            "process": "mnolyk.exe -> cmd"
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4400
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "terminates_remote_process",
        "description": "Terminates another process",
        "categories": [
          "persistence",
          "stealth"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 1056,
            "cid": 0
          },
          {
            "process": "svchost.exe"
          },
          {
            "type": "call",
            "pid": 1056,
            "cid": 15
          },
          {
            "process": "svchost.exe"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "uses_windows_utilities",
        "description": "Uses Windows utilities for basic functionality",
        "categories": [
          "command",
          "lateral"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 80,
        "references": [],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
          },
          {
            "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
          },
          {
            "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "C:\\Windows\\system32\\cmd.exe  /S /D /c\" echo Y\""
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "uses_windows_utilities_to_create_scheduled_task",
        "description": "Uses Windows utilities to create a scheduled task",
        "categories": [
          "command",
          "lateral"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 80,
        "references": [],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "antivm_generic_system",
        "description": "Checks the system manufacturer, likely for anti-virtualization",
        "categories": [
          "anti-vm"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [],
        "new_data": [
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 2228
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          }
        ],
        "alert": false,
        "families": []
      },
      {
        "name": "infostealer_cookies",
        "description": "Touches a file containing cookies, possibly for information gathering",
        "categories": [
          "infostealer"
        ],
        "severity": 3,
        "weight": 4,
        "confidence": 100,
        "references": [],
        "data": [],
        "new_data": [
          {
            "process": {
              "process_name": "mnolyk.exe",
              "process_id": 6168
            },
            "signs": [
              {
                "type": "file",
                "value": "C:\\Users\\sanya\\AppData\\Local\\Microsoft\\Windows\\INetCookies"
              }
            ]
          }
        ],
        "alert": false,
        "families": []
      },
      {
        "name": "persistence_autorun_tasks",
        "description": "Installs itself for autorun at Windows startup",
        "categories": [
          "persistence"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 9108,
            "cid": 225
          },
          {
            "type": "call",
            "pid": 3552,
            "cid": 228
          },
          {
            "type": "call",
            "pid": 8796,
            "cid": 219
          },
          {
            "type": "call",
            "pid": 8236,
            "cid": 212
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 953
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 959
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 963
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 967
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 971
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 977
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 981
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 988
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 1010
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 1013
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 1017
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 1021
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 1025
          },
          {
            "type": "call",
            "pid": 7724,
            "cid": 1029
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 38
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3161
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3162
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3163
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3164
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3253
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3254
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3255
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 3256
          },
          {
            "task": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "recon_beacon",
        "description": "A process sent information about the computer to a remote location.",
        "categories": [
          "network",
          "discovery"
        ],
        "severity": 3,
        "weight": 2,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 6168,
            "cid": 4496
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4882
          },
          {
            "type": "call",
            "pid": 6168,
            "cid": 4994
          },
          {
            "Beacon": "mnolyk.exe: id=260811189190&vs=3.67&sd=c51b61&os=1&bi=1&ar=1&pc=DESKTOP-KJGI8L3&un=sanya&dm=&av=13&lv=0&og=1"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "antiav_detectfile",
        "description": "Attempts to identify installed AV products by installation directory",
        "categories": [
          "anti-av"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "file": "C:\\ProgramData\\AVAST Software"
          },
          {
            "file": "C:\\ProgramData\\Avira"
          },
          {
            "file": "C:\\ProgramData\\Kaspersky Lab"
          },
          {
            "file": "C:\\ProgramData\\ESET"
          },
          {
            "file": "C:\\ProgramData\\Panda Security"
          },
          {
            "file": "C:\\ProgramData\\Bitdefender"
          },
          {
            "file": "C:\\ProgramData\\AVG"
          },
          {
            "file": "C:\\ProgramData\\Doctor Web"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "cmdline_obfuscation",
        "description": "Appears to use command line obfuscation",
        "categories": [
          "command"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [
          "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf"
        ],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "suspicious_command_tools",
        "description": "Uses suspicious command line tools or Windows utilities",
        "categories": [
          "command",
          "lateral"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 80,
        "references": [],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
          },
          {
            "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
          },
          {
            "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "CACLS  \"mnolyk.exe\" /P \"sanya:N\""
          },
          {
            "command": "CACLS  \"mnolyk.exe\" /P \"sanya:R\" /E"
          },
          {
            "command": "CACLS  \"..\\4f9dd6f8a7\" /P \"sanya:N\""
          },
          {
            "command": "CACLS  \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      }
    ],
    "failure_reason": null,
    "improvement_suggestions": [],
    "debugger_log": "=== 6164.log ===\nCAPE Sandbox - Debugger log: Sat Dec 27 15:01:08 2025\nBreakpoint 2 hit by instruction at 0x06E61CEB (thread 8824) EAX=0x41a1c00 ECX=0x1 EDX=0x147 ESI=0x41a1b08 EDI=0x19e718 ESP=0x19e5f0 *ESP=0x3de8f14 EBP=0x19e728\n0x06E61CEB  8B85F0FEFFFF             MOV       EAX, [EBP-0x110]              \nActionDispatcher: skipping instruction.\n0x06E61CF1  83780400                 CMP       DWORD [EAX+0x4], 0x0          \n\n\n=== 7140.log ===\nCAPE Sandbox - Debugger log: Sat Dec 27 15:00:44 2025\nBreakpoint 2 hit by instruction at 0x04161CEB (thread 2580) EAX=0x4345418 ECX=0x1 EDX=0x147 ESI=0x4345320 EDI=0x19e718 \" S4\" ESP=0x19e5f0 *ESP=0x3f48f14 EBP=0x19e728\n0x04161CEB  8B85F0FEFFFF             MOV       EAX, [EBP-0x110]              \nActionDispatcher: skipping instruction.\n0x04161CF1  83780400                 CMP       DWORD [EAX+0x4], 0x0          \n\n\n=== 9172.log ===\nCAPE Sandbox - Debugger log: Sat Dec 27 15:00:18 2025\nBreakpoint 2 hit by instruction at 0x04391CEB (thread 2992) EAX=0x43e1c00 ECX=0x1 EDX=0x147 ESI=0x43e1b08 EDI=0x19e718 ESP=0x19e5f0 *ESP=0x3f48f14 EBP=0x19e728\n0x04391CEB  8B85F0FEFFFF             MOV       EAX, [EBP-0x110]              \nActionDispatcher: skipping instruction.\n0x04391CF1  83780400                 CMP       DWORD [EAX+0x4], 0x0          \n",
    "raw_response": "**EVOLUTION_REASONING**: The previous rule hit but didn't bypass, indicating it matched the wrong location. We need to shift the bypass point earlier in the trace to target the evasion check itself. I'm focusing on Strategy A (Evasion Check) and selecting patterns that seem to be part of a conditional check before the ExitProcess call. The patterns are carefully selected from the trace and are concrete where possible.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 65\n\n**REASONING**: These patterns target a common structure of evasion checks: a call to a function, followed by a test of a register (likely the return value of the called function), and then a conditional jump based on the result. By bypassing this conditional check, we hope to prevent the malware from detecting the debugger.\n\n**YARA_RULE**:\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 6A 5B }\n        $pattern1 = { 85 C0 0F 84 33 FD FF FF }\n        $pattern2 = { 8B 85 F0 FE FF FF }\n\n    condition:\n        any of them\n}\n```",
    "yara_file": "ablation_results\\gemma3_12b\\Iter\\Iter\\e46197bae0562a86\\iter1_v2.yar"
  },
  "best_score": 22,
  "optimization_history": [
    "Iteration 1: rule_hit - Rule hit but no new signatures",
    "Iteration 2: SUCCESS - 22 new signatures"
  ],
  "successful_patterns": [
    ""
  ],
  "failed_patterns": [
    ""
  ]
}