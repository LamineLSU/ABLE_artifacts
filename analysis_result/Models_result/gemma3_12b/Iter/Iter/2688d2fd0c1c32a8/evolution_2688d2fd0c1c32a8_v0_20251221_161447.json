{
  "sha256": "2688d2fd0c1c32a805b04f52c7f684d024783c6b0c4a7ab38cf055412cce6e99",
  "prompt_version": "v0",
  "iterations": [
    {
      "iteration": 0,
      "prompt_version": "v0",
      "yara_rule": "rule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 6A ?? 5A 8B CE E8 ?? ?? ?? ?? 85 C0 } //PUSH + POP + MOV + CALL + TEST\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? 8B 45 ?? } //TEST EAX + JZ + MOV\n        $pattern2 = { 68 40 11 ?? 68 40 11 ?? 33 C9 } //PUSH + PUSH + PUSH + XOR\n\n    condition:\n        any of them\n}",
      "pattern_type": "UNKNOWN",
      "confidence": 50,
      "opcodes": "",
      "task_id": "1346",
      "status": "rule_hit",
      "rule_hit": true,
      "baseline_signatures": 15,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule hit but no new signatures",
      "improvement_suggestions": [
        "Instead of blindly skipping instructions based on a fixed offset, the rule needs to be more context-aware. A better approach is to analyze the value of EAX"
      ],
      "debugger_log": "=== 6028.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 05:11:46 2025\nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae8a10 ECX=0x10fe83c EDX=0x7078880 ESI=0x10fe85c EDI=0x10fe83c ESP=0x10fe7dc *ESP=0x0 EBP=0x10fe88c\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10fe83c EDX=0x46a67d8 ESI=0x10fe85c EDI=0x10fe83c ESP=0x10fe7dc *ESP=0x0 EBP=0x10fe88c\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b38bb0 ECX=0x10fe468 EDX=0x74231d8 ESI=0x10fe488 EDI=0x10fe468 ESP=0x10fe408 *ESP=0x0 EBP=0x10fe4b8\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10fe468 EDX=0x46a67d8 ESI=0x10fe488 EDI=0x10fe468 ESP=0x10fe408 *ESP=0x0 EBP=0x10fe4b8\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b3e0a4 ECX=0x10feb20 EDX=0x16454ac ESI=0x10feb40 EDI=0x10feb20 ESP=0x10feac0 *ESP=0x0 EBP=0x10feb70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb20 EDX=0x46a67d8 ESI=0x10feb40 EDI=0x10feb20 ESP=0x10feac0 *ESP=0x0 EBP=0x10feb70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b3ea18 ECX=0x10feb20 EDX=0x1644f4c ESI=0x10feb40 EDI=0x10feb20 ESP=0x10feac0 *ESP=0x0 EBP=0x10feb70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1ca0 ECX=0x10feb20 EDX=0x46a68e8 ESI=0x10feb40 EDI=0x10feb20 ESP=0x10feac0 *ESP=0x0 EBP=0x10feb70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb20 EDX=0x46a67d8 ESI=0x10feb40 EDI=0x10feb20 ESP=0x10feac0 *ESP=0x10101 EBP=0x10feb70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cf4 ECX=0x10fe464 EDX=0x46afe08 ESI=0x10fe484 EDI=0x10fe464 ESP=0x10fe3ec *ESP=0x0 EBP=0x10fe4b4\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10fe464 EDX=0x46a67d8 ESI=0x10fe484 EDI=0x10fe464 ESP=0x10fe3ec *ESP=0x0 EBP=0x10fe4b4\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b40bc8 ECX=0x10feb5c EDX=0x7070a80 ESI=0x10feb7c EDI=0x10feb5c ESP=0x10feae0 *ESP=0x0 EBP=0x10febac\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb5c EDX=0x46a67d8 ESI=0x10feb7c EDI=0x10feb5c ESP=0x10feae0 *ESP=0x0 EBP=0x10febac\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b40bc8 ECX=0x10feb50 EDX=0x7070a80 ESI=0x10feb70 EDI=0x10feb50 ESP=0x10fead4 *ESP=0x0 EBP=0x10feba0\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb50 EDX=0x46a67d8 ESI=0x10feb70 EDI=0x10feb50 ESP=0x10fead4 *ESP=0x0 EBP=0x10feba0\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b40bc8 ECX=0x10fea20 EDX=0x7070a80 ESI=0x10fea40 EDI=0x10fea20 ESP=0x10fe9a4 *ESP=0x0 EBP=0x10fea70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10fea20 EDX=0x46a67d8 ESI=0x10fea40 EDI=0x10fea20 ESP=0x10fe9a4 *ESP=0x0 EBP=0x10fea70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b43a40 ECX=0x10feb5c EDX=0x7474174 ESI=0x10feb7c EDI=0x10feb5c ESP=0x10feae0 *ESP=0x0 EBP=0x10febac\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb5c EDX=0x46a67d8 ESI=0x10feb7c EDI=0x10feb5c ESP=0x10feae0 *ESP=0x0 EBP=0x10febac\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b43a40 ECX=0x10feb50 EDX=0x7474174 ESI=0x10feb70 EDI=0x10feb50 ESP=0x10fead4 *ESP=0x0 EBP=0x10feba0\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb50 EDX=0x46a67d8 ESI=0x10feb70 EDI=0x10feb50 ESP=0x10fead4 *ESP=0x0 EBP=0x10feba0\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b43a40 ECX=0x10fea20 EDX=0x7474174 ESI=0x10fea40 EDI=0x10fea20 ESP=0x10fe9a4 *ESP=0x0 EBP=0x10fea70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10fea20 EDX=0x46a67d8 ESI=0x10fea40 EDI=0x10fea20 ESP=0x10fe9a4 *ESP=0x0 EBP=0x10fea70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b445f0 ECX=0x10feb5c EDX=0x74746ac ESI=0x10feb7c EDI=0x10feb5c ESP=0x10feae0 *ESP=0x0 EBP=0x10febac\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb5c EDX=0x46a67d8 ESI=0x10feb7c EDI=0x10feb5c ESP=0x10feae0 *ESP=0x0 EBP=0x10febac\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b445f0 ECX=0x10feb50 EDX=0x74746ac ESI=0x10feb70 EDI=0x10feb50 ESP=0x10fead4 *ESP=0x0 EBP=0x10feba0\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb50 EDX=0x46a67d8 ESI=0x10feb70 EDI=0x10feb50 ESP=0x10fead4 *ESP=0x0 EBP=0x10feba0\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b445f0 ECX=0x10fea20 EDX=0x74746ac ESI=0x10fea40 EDI=0x10fea20 ESP=0x10fe9a4 *ESP=0x0 EBP=0x10fea70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10fea20 EDX=0x46a67d8 ESI=0x10fea40 EDI=0x10fea20 ESP=0x10fe9a4 *ESP=0x0 EBP=0x10fea70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b45194 ECX=0x10feb5c EDX=0x7474b2c ESI=0x10feb7c EDI=0x10feb5c ESP=0x10feae0 *ESP=0x0 EBP=0x10febac\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb5c EDX=0x46a67d8 ESI=0x10feb7c EDI=0x10feb5c ESP=0x10feae0 *ESP=0x0 EBP=0x10febac\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b45194 ECX=0x10feb50 EDX=0x7474b2c ESI=0x10feb70 EDI=0x10feb50 ESP=0x10fead4 *ESP=0x0 EBP=0x10feba0\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb50 EDX=0x46a67d8 ESI=0x10feb70 EDI=0x10feb50 ESP=0x10fead4 *ESP=0x0 EBP=0x10feba0\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b45194 ECX=0x10fea20 EDX=0x7474b2c ESI=0x10fea40 EDI=0x10fea20 ESP=0x10fe9a4 *ESP=0x0 EBP=0x10fea70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10fea20 EDX=0x46a67d8 ESI=0x10fea40 EDI=0x10fea20 ESP=0x10fe9a4 *ESP=0x0 EBP=0x10fea70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b45d30 ECX=0x10feb5c EDX=0x7474fac ESI=0x10feb7c EDI=0x10feb5c ESP=0x10feae0 *ESP=0x0 EBP=0x10febac\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb5c EDX=0x46a67d8 ESI=0x10feb7c EDI=0x10feb5c ESP=0x10feae0 *ESP=0x0 EBP=0x10febac\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b45d30 ECX=0x10feb50 EDX=0x7474fac ESI=0x10feb70 EDI=0x10feb50 ESP=0x10fead4 *ESP=0x0 EBP=0x10feba0\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb50 EDX=0x46a67d8 ESI=0x10feb70 EDI=0x10feb50 ESP=0x10fead4 *ESP=0x0 EBP=0x10feba0\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b45d30 ECX=0x10fea20 EDX=0x7474fac ESI=0x10fea40 EDI=0x10fea20 ESP=0x10fe9a4 *ESP=0x0 EBP=0x10fea70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10fea20 EDX=0x46a67d8 ESI=0x10fea40 EDI=0x10fea20 ESP=0x10fe9a4 *ESP=0x0 EBP=0x10fea70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b468f0 ECX=0x10feb5c EDX=0x7475480 ESI=0x10feb7c EDI=0x10feb5c ESP=0x10feae0 *ESP=0x0 EBP=0x10febac\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb5c EDX=0x46a67d8 ESI=0x10feb7c EDI=0x10feb5c ESP=0x10feae0 *ESP=0x0 EBP=0x10febac\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b468f0 ECX=0x10feb50 EDX=0x7475480 ESI=0x10feb70 EDI=0x10feb50 ESP=0x10fead4 *ESP=0x0 EBP=0x10feba0\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10feb50 EDX=0x46a67d8 ESI=0x10feb70 EDI=0x10feb50 ESP=0x10fead4 *ESP=0x0 EBP=0x10feba0\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4b468f0 ECX=0x10fea20 EDX=0x7475480 ESI=0x10fea40 EDI=0x10fea20 ESP=0x10fe9a4 *ESP=0x0 EBP=0x10fea70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \nBreakpoint 1 hit by instruction at 0x071E02FF (thread 6072) EAX=0x1 EBX=0x4ae1cd8 ECX=0x10fea20 EDX=0x46a67d8 ESI=0x10fea40 EDI=0x10fea20 ESP=0x10fe9a4 *ESP=0x0 EBP=0x10fea70\n0x071E02FF  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x071E0301  0F8409020000             JZ        0x20f                         \n",
      "raw_response": "```yara\nrule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 6A ?? 5A 8B CE E8 ?? ?? ?? ?? 85 C0 } //PUSH + POP + MOV + CALL + TEST\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? 8B 45 ?? } //TEST EAX + JZ + MOV\n        $pattern2 = { 68 40 11 ?? 68 40 11 ?? 33 C9 } //PUSH + PUSH + PUSH + XOR\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\gemma3_12b\\Iter\\Iter\\2688d2fd0c1c32a8\\iter0_v0.yar"
    },
    {
      "iteration": 1,
      "prompt_version": "v0",
      "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 6A 5B }\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? 8B }\n        $pattern2 = { 85 C0 0F 84 ?? ?? ?? ?? 8B 85 }\n\n    condition:\n        any of them\n}",
      "pattern_type": "CALL_TEST_JE",
      "confidence": 65,
      "opcodes": "",
      "task_id": "1347",
      "status": "bypass_success",
      "rule_hit": true,
      "baseline_signatures": 15,
      "new_signatures": 1,
      "new_signature_names": [
        "stealth_timeout"
      ],
      "new_signature_details": [
        {
          "name": "stealth_timeout",
          "description": "Possible date expiration check, exits too soon after checking local time",
          "categories": [
            "stealth"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 40,
          "references": [],
          "data": [
            {
              "process": "2688d2fd0c1c32a805b0.exe, PID 3452"
            },
            {
              "type": "call",
              "pid": 3452,
              "cid": 201
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        }
      ],
      "failure_reason": null,
      "improvement_suggestions": [],
      "debugger_log": "=== 3452.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 00:37:35 2025\nBreakpoint 2 hit by instruction at 0x00E95A19 (thread 9100) EAX=0x1 ECX=0x46a5e79c ESI=0xe991e4 \"C:\\Users\\sanya\\AppData\\Local\\Temp\\IXP000.TMP\\\" 2688d2fd0c1c32a805b0.exe EDI=0x1 ESP=0x4ff274 *ESP=0x1 EBP=0x4ff5b0\nBreak at 0x00E95A19 in 2688d2fd0c1c32a805b0.exe (RVA 0x5a19, thread 9100, Stack 0x004F2000-0x00500000, ImageBase 0x00E90000)\n0x00E95A19  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x00E95A1B  0F8480010000             JZ        0x186                         \nBreakpoint 2 hit by instruction at 0x00E95A19 (thread 9100) EAX=0x1 ECX=0x46a5e658 ESI=0x4ff70c \"C:\\\" EDI=0x1 ESP=0x4ff3b8 *ESP=0x1 EBP=0x4ff6f4\n0x00E95A19  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x00E95A1B  0F8480010000             JZ        0x186                         \nBreakpoint 2 hit by instruction at 0x00E95A19 (thread 9100) EAX=0x1 ECX=0x46a5e658 ESI=0x4ff70c \"C:\\Windows\" EDI=0x1 ESP=0x4ff3b8 *ESP=0x1 EBP=0x4ff6f4\n0x00E95A19  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x00E95A1B  0F8480010000             JZ        0x186                         \n",
      "raw_response": "**EVOLUTION_REASONING**: The previous rule hit but found no new signatures, indicating it matched the wrong part of the code. The analysis suggested focusing on the value of EAX before the exit, as the exit decision is likely conditional. I've chosen three different patterns from the trace that appear to be involved in conditional checks before the `ExitProcess` call.  I'm prioritizing patterns that involve `test eax, eax` and `je` instructions, as these are common elements in conditional checks. I'm using wildcards for offsets within the patterns to allow for some flexibility.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 65\n\n**REASONING**: These patterns target sections of code involved in conditional checks before the exit. The `test eax, eax` followed by `je` instructions are common patterns for conditional branching. The inclusion of `push` and `pop` instructions suggests stack manipulation that could be relevant to the execution flow. Using concrete bytes where possible increases specificity and reduces the chance of false positives.\n\n**YARA_RULE**:\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 6A 5B }\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? 8B }\n        $pattern2 = { 85 C0 0F 84 ?? ?? ?? ?? 8B 85 }\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\gemma3_12b\\Iter\\Iter\\2688d2fd0c1c32a8\\iter1_v0.yar"
    }
  ],
  "best_attempt": {
    "iteration": 1,
    "prompt_version": "v0",
    "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 6A 5B }\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? 8B }\n        $pattern2 = { 85 C0 0F 84 ?? ?? ?? ?? 8B 85 }\n\n    condition:\n        any of them\n}",
    "pattern_type": "CALL_TEST_JE",
    "confidence": 65,
    "opcodes": "",
    "task_id": "1347",
    "status": "bypass_success",
    "rule_hit": true,
    "baseline_signatures": 15,
    "new_signatures": 1,
    "new_signature_names": [
      "stealth_timeout"
    ],
    "new_signature_details": [
      {
        "name": "stealth_timeout",
        "description": "Possible date expiration check, exits too soon after checking local time",
        "categories": [
          "stealth"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 40,
        "references": [],
        "data": [
          {
            "process": "2688d2fd0c1c32a805b0.exe, PID 3452"
          },
          {
            "type": "call",
            "pid": 3452,
            "cid": 201
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      }
    ],
    "failure_reason": null,
    "improvement_suggestions": [],
    "debugger_log": "=== 3452.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 00:37:35 2025\nBreakpoint 2 hit by instruction at 0x00E95A19 (thread 9100) EAX=0x1 ECX=0x46a5e79c ESI=0xe991e4 \"C:\\Users\\sanya\\AppData\\Local\\Temp\\IXP000.TMP\\\" 2688d2fd0c1c32a805b0.exe EDI=0x1 ESP=0x4ff274 *ESP=0x1 EBP=0x4ff5b0\nBreak at 0x00E95A19 in 2688d2fd0c1c32a805b0.exe (RVA 0x5a19, thread 9100, Stack 0x004F2000-0x00500000, ImageBase 0x00E90000)\n0x00E95A19  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x00E95A1B  0F8480010000             JZ        0x186                         \nBreakpoint 2 hit by instruction at 0x00E95A19 (thread 9100) EAX=0x1 ECX=0x46a5e658 ESI=0x4ff70c \"C:\\\" EDI=0x1 ESP=0x4ff3b8 *ESP=0x1 EBP=0x4ff6f4\n0x00E95A19  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x00E95A1B  0F8480010000             JZ        0x186                         \nBreakpoint 2 hit by instruction at 0x00E95A19 (thread 9100) EAX=0x1 ECX=0x46a5e658 ESI=0x4ff70c \"C:\\Windows\" EDI=0x1 ESP=0x4ff3b8 *ESP=0x1 EBP=0x4ff6f4\n0x00E95A19  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x00E95A1B  0F8480010000             JZ        0x186                         \n",
    "raw_response": "**EVOLUTION_REASONING**: The previous rule hit but found no new signatures, indicating it matched the wrong part of the code. The analysis suggested focusing on the value of EAX before the exit, as the exit decision is likely conditional. I've chosen three different patterns from the trace that appear to be involved in conditional checks before the `ExitProcess` call.  I'm prioritizing patterns that involve `test eax, eax` and `je` instructions, as these are common elements in conditional checks. I'm using wildcards for offsets within the patterns to allow for some flexibility.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 65\n\n**REASONING**: These patterns target sections of code involved in conditional checks before the exit. The `test eax, eax` followed by `je` instructions are common patterns for conditional branching. The inclusion of `push` and `pop` instructions suggests stack manipulation that could be relevant to the execution flow. Using concrete bytes where possible increases specificity and reduces the chance of false positives.\n\n**YARA_RULE**:\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 6A 5B }\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? 8B }\n        $pattern2 = { 85 C0 0F 84 ?? ?? ?? ?? 8B 85 }\n\n    condition:\n        any of them\n}\n```",
    "yara_file": "ablation_results\\gemma3_12b\\Iter\\Iter\\2688d2fd0c1c32a8\\iter1_v0.yar"
  },
  "best_score": 1,
  "optimization_history": [
    "Iteration 1: rule_hit - Rule hit but no new signatures",
    "Iteration 2: SUCCESS - 1 new signatures"
  ],
  "successful_patterns": [
    ""
  ],
  "failed_patterns": [
    ""
  ]
}