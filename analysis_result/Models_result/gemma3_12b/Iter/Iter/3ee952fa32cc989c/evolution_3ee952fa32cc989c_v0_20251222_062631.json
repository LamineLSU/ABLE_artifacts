{
  "sha256": "3ee952fa32cc989c8387c0719f843c8df7ee906a7b93646a7e4152abb5d4c943",
  "prompt_version": "v0",
  "iterations": [
    {
      "iteration": 0,
      "prompt_version": "v0",
      "yara_rule": "rule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 8B FF 55 8B EC FF 75 08 }  // mov edi, edi; push ebp; mov ebp, esp; push dword ptr [ebp+08h]\n        $pattern1 = { 53 6A 40 53 68 40 11 F3 00 } // pop ebx; push 0x40; pop ebx; push 0x40; push 0xF31140\n        $pattern2 = { E8 C8 FF FF FF 59 FF 75 08 } // call 0040E7C3h; pop ecx; push dword ptr [ebp+08h]\n\n    condition:\n        any of them\n}",
      "pattern_type": "UNKNOWN",
      "confidence": 50,
      "opcodes": "",
      "task_id": "1466",
      "status": "rule_hit",
      "rule_hit": true,
      "baseline_signatures": 16,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule hit but no new signatures",
      "improvement_suggestions": [
        "Remove the `cape_options` entirely. The intended behavior of skipping instructions is not being achieved correctly, and is leading to incorrect results and debugger lockups.  Let the YARA rule simply match the identified pattern without attempting to skip any instructions.  This will allow the analysis to continue and potentially reveal further insights into the sample's behavior."
      ],
      "debugger_log": "=== 1652.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 12:38:21 2025\nBreakpoint 0 hit by instruction at 0x00224CC0 (thread 516) EAX=0x44998 ECX=0x224cc0 scI80XI39.exe EDX=0x5100000 ESI=0x224cc0 scI80XI39.exe EDI=0x34ea660 ESP=0x2fbfa94 *ESP=0x6ba13bfc \"Y3\" cabinet.dll EBP=0x2fbfaa4\nBreak at 0x00224CC0 in scI80XI39.exe (RVA 0x4cc0, thread 516, Stack 0x02FB2000-0x02FC0000, ImageBase 0x00220000)\n0x00224CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00224CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00224CC0 (thread 516) EAX=0x44998 EBX=0x34fe780 \" `\" ECX=0x224cc0 scI80XI39.exe EDX=0x5100000 ESI=0x224cc0 scI80XI39.exe EDI=0x34d1f28 \"LDIC\" ESP=0x2fbfaa0 *ESP=0x6ba1b4c3 cabinet.dll EBP=0x2fbfad8\n0x00224CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00224CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00224CC0 (thread 516) EAX=0x44998 EBX=0x34fe780 ECX=0x224cc0 scI80XI39.exe EDX=0x5100000 ESI=0x224cc0 scI80XI39.exe EDI=0x34d1f28 ESP=0x2fbfaa0 *ESP=0x6ba1b4db cabinet.dll EBP=0x2fbfad8\n0x00224CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00224CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00224CC0 (thread 516) EAX=0x44998 EBX=0x34fe780 ECX=0x224cc0 scI80XI39.exe EDX=0x5100000 ESI=0x224cc0 scI80XI39.exe EDI=0x34d1f28 ESP=0x2fbfaa0 *ESP=0x6ba1b4ea \"Y^[3\" cabinet.dll EBP=0x2fbfad8\n0x00224CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00224CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00224CC0 (thread 516) EAX=0x44998 ECX=0x224cc0 scI80XI39.exe EDX=0x5100000 ESI=0x224cc0 scI80XI39.exe EDI=0x34ea660 ESP=0x2fbfab0 \" ?\" *ESP=0x6ba13f0d cabinet.dll EBP=0x2fbfad8\n0x00224CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00224CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00224CC0 (thread 516) EAX=0x44998 ECX=0x224cc0 scI80XI39.exe EDX=0x5100000 ESI=0x224cc0 scI80XI39.exe EDI=0x34ea660 ESP=0x2fbfab0 \"\u001e?\" *ESP=0x6ba13f1e cabinet.dll EBP=0x2fbfad8\n0x00224CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00224CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00224CC0 (thread 516) EAX=0x44998 ECX=0x224cc0 scI80XI39.exe EDX=0x5100000 ESI=0x224cc0 scI80XI39.exe EDI=0x34ea660 ESP=0x2fbfac8 *ESP=0x6ba13bb8 cabinet.dll EBP=0x2fbfad8\n0x00224CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00224CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00224CC0 (thread 516) EAX=0x44998 ECX=0x224cc0 scI80XI39.exe EDX=0x5100000 ESI=0x224cc0 scI80XI39.exe EDI=0x34ea660 ESP=0x2fbfac8 *ESP=0x6ba13bcf cabinet.dll EBP=0x2fbfad8\n0x00224CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00224CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00224CC0 (thread 516) EAX=0x44998 ECX=0x224cc0 scI80XI39.exe EDX=0x5100000 ESI=0x224cc0 scI80XI39.exe EDI=0x34ea660 ESP=0x2fbfac8 *ESP=0x6ba13bfc \"Y3\" cabinet.dll EBP=0x2fbfad8\n0x00224CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00224CC2  55                       PUSH      EBP                           \n\n\n=== 1660.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 12:39:21 2025\nBreakpoint 0 hit by instruction at 0x00405F73 (thread 7928) EBX=0x1 ECX=0x4011d4 kaO05cF.exe EDX=0xc00057f5 EDI=0xfffffffe ESP=0x19fee4 *ESP=0x4041e8 kaO05cF.exe EBP=0x19feec\nBreak at 0x00405F73 in kaO05cF.exe (RVA 0x5f73, thread 7928, Stack 0x00193000-0x001A0000, ImageBase 0x00400000)\n0x00405F73  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00405F75  55                       PUSH      EBP                           \n\n\n=== 4664.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 12:38:08 2025\nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 7864) EAX=0xa4998 ECX=0x524cc0 3ee952fa32cc989c8387.exe EDX=0x5100000 ESI=0x524cc0 3ee952fa32cc989c8387.exe EDI=0x2b39988 ESP=0x271f880 *ESP=0x6ba13bfc \"Y3\" cabinet.dll EBP=0x271f890\nBreak at 0x00524CC0 in 3ee952fa32cc989c8387.exe (RVA 0x4cc0, thread 7864, Stack 0x02712000-0x02720000, ImageBase 0x00520000)\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 7864) EAX=0xa4998 EBX=0x2b4d798 \"  \" ECX=0x524cc0 3ee952fa32cc989c8387.exe EDX=0x5100000 ESI=0x524cc0 3ee952fa32cc989c8387.exe EDI=0x2b21218 \"LDIC\" ESP=0x271f88c *ESP=0x6ba1b4c3 cabinet.dll EBP=0x271f8c4\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 7864) EAX=0xa4998 EBX=0x2b4d798 ECX=0x524cc0 3ee952fa32cc989c8387.exe EDX=0x5100000 ESI=0x524cc0 3ee952fa32cc989c8387.exe EDI=0x2b21218 ESP=0x271f88c *ESP=0x6ba1b4db cabinet.dll EBP=0x271f8c4\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 7864) EAX=0xa4998 EBX=0x2b4d798 ECX=0x524cc0 3ee952fa32cc989c8387.exe EDX=0x5100000 ESI=0x524cc0 3ee952fa32cc989c8387.exe EDI=0x2b21218 ESP=0x271f88c *ESP=0x6ba1b4ea \"Y^[3\" cabinet.dll EBP=0x271f8c4\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 7864) EAX=0xa4998 ECX=0x524cc0 3ee952fa32cc989c8387.exe EDX=0x5100000 ESI=0x524cc0 3ee952fa32cc989c8387.exe EDI=0x2b39988 ESP=0x271f89c \" ?\" *ESP=0x6ba13f0d cabinet.dll EBP=0x271f8c4\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 7864) EAX=0xa4998 ECX=0x524cc0 3ee952fa32cc989c8387.exe EDX=0x5100000 ESI=0x524cc0 3ee952fa32cc989c8387.exe EDI=0x2b39988 ESP=0x271f89c \"\u001e?\" *ESP=0x6ba13f1e cabinet.dll EBP=0x271f8c4\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 7864) EAX=0xa4998 ECX=0x524cc0 3ee952fa32cc989c8387.exe EDX=0x5100000 ESI=0x524cc0 3ee952fa32cc989c8387.exe EDI=0x2b39988 ESP=0x271f8b4 *ESP=0x6ba13bb8 cabinet.dll EBP=0x271f8c4\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 7864) EAX=0xa4998 ECX=0x524cc0 3ee952fa32cc989c8387.exe EDX=0x5100000 ESI=0x524cc0 3ee952fa32cc989c8387.exe EDI=0x2b39988 ESP=0x271f8b4 *ESP=0x6ba13bcf cabinet.dll EBP=0x271f8c4\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 7864) EAX=0xa4998 ECX=0x524cc0 3ee952fa32cc989c8387.exe EDX=0x5100000 ESI=0x524cc0 3ee952fa32cc989c8387.exe EDI=0x2b39988 ESP=0x271f8b4 *ESP=0x6ba13bfc \"Y3\" cabinet.dll EBP=0x271f8c4\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \n\n\n=== 5080.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 12:38:33 2025\nBreakpoint 0 hit by instruction at 0x007F4CC0 (thread 5532) EAX=0xfe998 ECX=0x7f4cc0 sbh77bA39.exe EDX=0x5100000 ESI=0x7f4cc0 sbh77bA39.exe EDI=0x365a430 ESP=0x327f87c *ESP=0x6ba13bfc \"Y3\" cabinet.dll EBP=0x327f88c\nBreak at 0x007F4CC0 in sbh77bA39.exe (RVA 0x4cc0, thread 5532, Stack 0x03272000-0x03280000, ImageBase 0x007F0000)\n0x007F4CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x007F4CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x007F4CC0 (thread 5532) EAX=0xfe998 EBX=0x366e798 ECX=0x7f4cc0 sbh77bA39.exe EDX=0x5100000 ESI=0x7f4cc0 sbh77bA39.exe EDI=0x3641ed0 \"LDIC\" ESP=0x327f888 *ESP=0x6ba1b4c3 cabinet.dll EBP=0x327f8c0\n0x007F4CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x007F4CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x007F4CC0 (thread 5532) EAX=0xfe998 EBX=0x366e798 ECX=0x7f4cc0 sbh77bA39.exe EDX=0x5100000 ESI=0x7f4cc0 sbh77bA39.exe EDI=0x3641ed0 ESP=0x327f888 *ESP=0x6ba1b4db cabinet.dll EBP=0x327f8c0\n0x007F4CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x007F4CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x007F4CC0 (thread 5532) EAX=0xfe998 EBX=0x366e798 ECX=0x7f4cc0 sbh77bA39.exe EDX=0x5100000 ESI=0x7f4cc0 sbh77bA39.exe EDI=0x3641ed0 ESP=0x327f888 *ESP=0x6ba1b4ea \"Y^[3\" cabinet.dll EBP=0x327f8c0\n0x007F4CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x007F4CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x007F4CC0 (thread 5532) EAX=0xfe998 ECX=0x7f4cc0 sbh77bA39.exe EDX=0x5100000 ESI=0x7f4cc0 sbh77bA39.exe EDI=0x365a430 ESP=0x327f898 \" ?\" *ESP=0x6ba13f0d cabinet.dll EBP=0x327f8c0\n0x007F4CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x007F4CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x007F4CC0 (thread 5532) EAX=0xfe998 ECX=0x7f4cc0 sbh77bA39.exe EDX=0x5100000 ESI=0x7f4cc0 sbh77bA39.exe EDI=0x365a430 ESP=0x327f898 \"\u001e?\" *ESP=0x6ba13f1e cabinet.dll EBP=0x327f8c0\n0x007F4CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x007F4CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x007F4CC0 (thread 5532) EAX=0xfe998 ECX=0x7f4cc0 sbh77bA39.exe EDX=0x5100000 ESI=0x7f4cc0 sbh77bA39.exe EDI=0x365a430 ESP=0x327f8b0 *ESP=0x6ba13bb8 cabinet.dll EBP=0x327f8c0\n0x007F4CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x007F4CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x007F4CC0 (thread 5532) EAX=0xfe998 ECX=0x7f4cc0 sbh77bA39.exe EDX=0x5100000 ESI=0x7f4cc0 sbh77bA39.exe EDI=0x365a430 ESP=0x327f8b0 *ESP=0x6ba13bcf cabinet.dll EBP=0x327f8c0\n0x007F4CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x007F4CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x007F4CC0 (thread 5532) EAX=0xfe998 ECX=0x7f4cc0 sbh77bA39.exe EDX=0x5100000 ESI=0x7f4cc0 sbh77bA39.exe EDI=0x365a430 ESP=0x327f8b0 *ESP=0x6ba13bfc \"Y3\" cabinet.dll EBP=0x327f8c0\n0x007F4CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x007F4CC2  55                       PUSH      EBP                           \n\n\n=== 8020.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 12:38:47 2025\nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 1908) EAX=0xa4998 ECX=0x524cc0 sfE92lZ33.exe EDX=0x5100000 ESI=0x524cc0 sfE92lZ33.exe EDI=0x293a1f0 ESP=0x39f5b4 *ESP=0x6ba13bfc \"Y3\" cabinet.dll EBP=0x39f5c4\nBreak at 0x00524CC0 in sfE92lZ33.exe (RVA 0x4cc0, thread 1908, Stack 0x00392000-0x003A0000, ImageBase 0x00520000)\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 1908) EAX=0xa4998 EBX=0x294e770 \" `\" ECX=0x524cc0 sfE92lZ33.exe EDX=0x5100000 ESI=0x524cc0 sfE92lZ33.exe EDI=0x2921f40 \"LDIC\" ESP=0x39f5c0 *ESP=0x6ba1b4c3 cabinet.dll EBP=0x39f5f8\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 1908) EAX=0xa4998 EBX=0x294e770 ECX=0x524cc0 sfE92lZ33.exe EDX=0x5100000 ESI=0x524cc0 sfE92lZ33.exe EDI=0x2921f40 ESP=0x39f5c0 *ESP=0x6ba1b4db cabinet.dll EBP=0x39f5f8\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 1908) EAX=0xa4998 EBX=0x294e770 ECX=0x524cc0 sfE92lZ33.exe EDX=0x5100000 ESI=0x524cc0 sfE92lZ33.exe EDI=0x2921f40 ESP=0x39f5c0 *ESP=0x6ba1b4ea \"Y^[3\" cabinet.dll EBP=0x39f5f8\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 1908) EAX=0xa4998 ECX=0x524cc0 sfE92lZ33.exe EDX=0x5100000 ESI=0x524cc0 sfE92lZ33.exe EDI=0x293a1f0 ESP=0x39f5d0 \" ?\" *ESP=0x6ba13f0d cabinet.dll EBP=0x39f5f8\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 1908) EAX=0xa4998 ECX=0x524cc0 sfE92lZ33.exe EDX=0x5100000 ESI=0x524cc0 sfE92lZ33.exe EDI=0x293a1f0 ESP=0x39f5d0 \"\u001e?\" *ESP=0x6ba13f1e cabinet.dll EBP=0x39f5f8\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 1908) EAX=0xa4998 ECX=0x524cc0 sfE92lZ33.exe EDX=0x5100000 ESI=0x524cc0 sfE92lZ33.exe EDI=0x293a1f0 ESP=0x39f5e8 *ESP=0x6ba13bb8 cabinet.dll EBP=0x39f5f8\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 1908) EAX=0xa4998 ECX=0x524cc0 sfE92lZ33.exe EDX=0x5100000 ESI=0x524cc0 sfE92lZ33.exe EDI=0x293a1f0 ESP=0x39f5e8 *ESP=0x6ba13bcf cabinet.dll EBP=0x39f5f8\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \nBreakpoint 0 hit by instruction at 0x00524CC0 (thread 1908) EAX=0xa4998 ECX=0x524cc0 sfE92lZ33.exe EDX=0x5100000 ESI=0x524cc0 sfE92lZ33.exe EDI=0x293a1f0 ESP=0x39f5e8 *ESP=0x6ba13bfc \"Y3\" cabinet.dll EBP=0x39f5f8\n0x00524CC0  8BFF                     MOV       EDI, EDI                      \nActionDispatcher: skipping instruction.\n0x00524CC2  55                       PUSH      EBP                           \n",
      "raw_response": "<unused6172>\n```yara\nrule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 8B FF 55 8B EC FF 75 08 }  // mov edi, edi; push ebp; mov ebp, esp; push dword ptr [ebp+08h]\n        $pattern1 = { 53 6A 40 53 68 40 11 F3 00 } // pop ebx; push 0x40; pop ebx; push 0x40; push 0xF31140\n        $pattern2 = { E8 C8 FF FF FF 59 FF 75 08 } // call 0040E7C3h; pop ecx; push dword ptr [ebp+08h]\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\gemma3_12b\\Iter\\Iter\\3ee952fa32cc989c\\iter0_v0.yar"
    },
    {
      "iteration": 1,
      "prompt_version": "v0",
      "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 6A 5B }\n        $pattern1 = { 85 C0 0F 84 33 FD FF FF }\n        $pattern2 = { 8B 85 F0 FE FF FF }\n\n    condition:\n        any of them\n}",
      "pattern_type": "CALL_TEST_JE",
      "confidence": 70,
      "opcodes": "",
      "task_id": "1467",
      "status": "bypass_success",
      "rule_hit": true,
      "baseline_signatures": 16,
      "new_signatures": 22,
      "new_signature_names": [
        "persistence_autorun_tasks",
        "queries_computer_name",
        "dynamic_function_loading",
        "recon_beacon",
        "terminates_remote_process",
        "antisandbox_sleep",
        "stealth_timeout",
        "antiav_detectfile",
        "queries_locale_api",
        "cmdline_obfuscation",
        "reads_self",
        "queries_keyboard_layout",
        "creates_suspended_process",
        "infostealer_cookies",
        "antivm_generic_system",
        "stealth_window",
        "suspicious_command_tools",
        "injection_write_process",
        "uses_windows_utilities_to_create_scheduled_task",
        "uses_windows_utilities",
        "http_request",
        "resumethread_remote_process"
      ],
      "new_signature_details": [
        {
          "name": "queries_computer_name",
          "description": "Queries computer hostname",
          "categories": [
            "system_discovery"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 9204,
              "cid": 134
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "dynamic_function_loading",
          "description": "Dynamic (imported) function loading detected",
          "categories": [
            "anti-debug"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 40,
          "references": [],
          "data": [
            {
              "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3817
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3818
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3819
            },
            {
              "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3820
            },
            {
              "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3821
            },
            {
              "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3822
            },
            {
              "DynamicLoader": "apphelp.dll/SdbQueryContext"
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3823
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 153
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 154
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 155
            },
            {
              "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 156
            },
            {
              "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 157
            },
            {
              "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 158
            },
            {
              "DynamicLoader": "apphelp.dll/SdbQueryContext"
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 159
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "queries_keyboard_layout",
          "description": "Queries the keyboard layout",
          "categories": [
            "location_discovery"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 8328,
              "cid": 3899
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4522
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 5055
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "queries_locale_api",
          "description": "Queries the computer locale (possible geofencing)",
          "categories": [
            "location_discovery",
            "geofence"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 8328,
              "cid": 1067
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 1088
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3672
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3993
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4014
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4397
            },
            {
              "type": "call",
              "pid": 9204,
              "cid": 136
            },
            {
              "type": "call",
              "pid": 9204,
              "cid": 141
            },
            {
              "type": "call",
              "pid": 9204,
              "cid": 163
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 70
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 2542
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 6870
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 10527
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 14174
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 17812
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 21459
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 25096
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 28734
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 31336
            },
            {
              "type": "call",
              "pid": 1480,
              "cid": 67
            },
            {
              "type": "call",
              "pid": 6916,
              "cid": 22
            },
            {
              "type": "call",
              "pid": 6916,
              "cid": 31
            },
            {
              "type": "call",
              "pid": 3984,
              "cid": 21
            },
            {
              "type": "call",
              "pid": 3984,
              "cid": 30
            },
            {
              "type": "call",
              "pid": 8088,
              "cid": 67
            },
            {
              "type": "call",
              "pid": 6320,
              "cid": 22
            },
            {
              "type": "call",
              "pid": 6320,
              "cid": 31
            },
            {
              "type": "call",
              "pid": 3336,
              "cid": 21
            },
            {
              "type": "call",
              "pid": 3336,
              "cid": 30
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "stealth_timeout",
          "description": "Possible date expiration check, exits too soon after checking local time",
          "categories": [
            "stealth"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 40,
          "references": [],
          "data": [
            {
              "process": "rEz44fi71.exe, PID 3264"
            },
            {
              "type": "call",
              "pid": 3264,
              "cid": 580
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antisandbox_sleep",
          "description": "A process attempted to delay the analysis task.",
          "categories": [
            "anti-sandbox"
          ],
          "severity": 2,
          "weight": 4,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 4900,
              "cid": 822
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 896
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 976
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 982
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 988
            },
            {
              "type": "call",
              "pid": 2352,
              "cid": 2111
            },
            {
              "type": "call",
              "pid": 8992,
              "cid": 2136
            },
            {
              "type": "call",
              "pid": 8092,
              "cid": 2084
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4525
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4604
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4606
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4937
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4978
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4988
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 5066
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 5092
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 5129
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 5136
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 5147
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 6132
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 12176
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 20284
            },
            {
              "type": "call",
              "pid": 5264,
              "cid": 27395
            },
            {
              "note": "mnolyk.exe tried to sleep 566.0 seconds, actually delayed analysis time by 0.0 seconds"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "http_request",
          "description": "Performs HTTP requests potentially not found in PCAP.",
          "categories": [
            "network"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 8328,
              "cid": 5073
            },
            {
              "url": "193.233.20.15:80//dF30Hn4m/index.php"
            },
            {
              "url": "193.233.20.15:80//dF30Hn4m/index.php"
            },
            {
              "url": "http://193.233.20.15/dF30Hn4m/Plugins/cred64.dll"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "creates_suspended_process",
          "description": "Creates a process in a suspended state, likely for injection",
          "categories": [
            "injection",
            "process hollowing"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 50,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 1056,
              "cid": 2
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "resumethread_remote_process",
          "description": "Resumed a thread in another process",
          "categories": [
            "injection",
            "unpacking"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "thread_resumed": "Process mnolyk.exe with process ID 8328 resumed a thread in another process with the process ID 9204"
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3842
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4467
            },
            {
              "thread_resumed": "Process cmd.exe with process ID 3144 resumed a thread in another process with the process ID 1480"
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 173
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 244
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 303
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 354
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 425
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 484
            },
            {
              "thread_resumed": "Process svchost.exe with process ID 1056 resumed a thread in another process with the process ID 5264"
            },
            {
              "type": "call",
              "pid": 1056,
              "cid": 3
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "injection_write_process",
          "description": "Writes to the memory another process",
          "categories": [
            "injection",
            "unpacking"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "write_memory": "Process mnolyk.exe with process ID 8328 wrote to the memory of process handle 0x00000500"
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3833
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3835
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3836
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4454
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4456
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4457
            },
            {
              "write_memory": "Process cmd.exe with process ID 3144 wrote to the memory of process handle 0x000002d0"
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 169
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 171
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 172
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 240
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 242
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 243
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 299
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 301
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 302
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 350
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 352
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 353
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 421
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 423
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 424
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 480
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 482
            },
            {
              "type": "call",
              "pid": 3144,
              "cid": 483
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "reads_self",
          "description": "Reads data out of its own binary image",
          "categories": [
            "generic"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 30,
          "references": [],
          "data": [
            {
              "self_read": "process: rEz44fi71.exe, pid: 3264, offset: 0x00000000, length: 0x00032000"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "stealth_window",
          "description": "A process created a hidden window",
          "categories": [
            "stealth"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "process": "rEz44fi71.exe -> C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe"
            },
            {
              "type": "call",
              "pid": 3264,
              "cid": 575
            },
            {
              "process": "mnolyk.exe -> SCHTASKS"
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3878
            },
            {
              "process": "mnolyk.exe -> cmd"
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 4524
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "terminates_remote_process",
          "description": "Terminates another process",
          "categories": [
            "persistence",
            "stealth"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 1056,
              "cid": 0
            },
            {
              "process": "svchost.exe"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "uses_windows_utilities",
          "description": "Uses Windows utilities for basic functionality",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
            },
            {
              "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
            },
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "C:\\Windows\\system32\\cmd.exe  /S /D /c\" echo Y\""
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "uses_windows_utilities_to_create_scheduled_task",
          "description": "Uses Windows utilities to create a scheduled task",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antivm_generic_system",
          "description": "Checks the system manufacturer, likely for anti-virtualization",
          "categories": [
            "anti-vm"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [],
          "new_data": [
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 5264
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            }
          ],
          "alert": false,
          "families": []
        },
        {
          "name": "infostealer_cookies",
          "description": "Touches a file containing cookies, possibly for information gathering",
          "categories": [
            "infostealer"
          ],
          "severity": 3,
          "weight": 4,
          "confidence": 100,
          "references": [],
          "data": [],
          "new_data": [
            {
              "process": {
                "process_name": "mnolyk.exe",
                "process_id": 8328
              },
              "signs": [
                {
                  "type": "file",
                  "value": "C:\\Users\\sanya\\AppData\\Local\\Microsoft\\Windows\\INetCookies"
                }
              ]
            }
          ],
          "alert": false,
          "families": []
        },
        {
          "name": "persistence_autorun_tasks",
          "description": "Installs itself for autorun at Windows startup",
          "categories": [
            "persistence"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 4264,
              "cid": 227
            },
            {
              "type": "call",
              "pid": 8416,
              "cid": 229
            },
            {
              "type": "call",
              "pid": 8764,
              "cid": 221
            },
            {
              "type": "call",
              "pid": 3508,
              "cid": 214
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 937
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 943
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 947
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 951
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 955
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 961
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 965
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 972
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 994
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 997
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 1001
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 1005
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 1009
            },
            {
              "type": "call",
              "pid": 4900,
              "cid": 1013
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 38
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3142
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3143
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3144
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3145
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3234
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3235
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3236
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 3237
            },
            {
              "task": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "recon_beacon",
          "description": "A process sent information about the computer to a remote location.",
          "categories": [
            "network",
            "discovery"
          ],
          "severity": 3,
          "weight": 2,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 8328,
              "cid": 4620
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 5060
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 5096
            },
            {
              "type": "call",
              "pid": 8328,
              "cid": 5141
            },
            {
              "Beacon": "mnolyk.exe: id=260811189190&vs=3.67&sd=c51b61&os=1&bi=1&ar=1&pc=DESKTOP-KJGI8L3&un=sanya&dm=&av=13&lv=0&og=1"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antiav_detectfile",
          "description": "Attempts to identify installed AV products by installation directory",
          "categories": [
            "anti-av"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "file": "C:\\ProgramData\\AVAST Software"
            },
            {
              "file": "C:\\ProgramData\\Avira"
            },
            {
              "file": "C:\\ProgramData\\Kaspersky Lab"
            },
            {
              "file": "C:\\ProgramData\\ESET"
            },
            {
              "file": "C:\\ProgramData\\Panda Security"
            },
            {
              "file": "C:\\ProgramData\\Bitdefender"
            },
            {
              "file": "C:\\ProgramData\\AVG"
            },
            {
              "file": "C:\\ProgramData\\Doctor Web"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "cmdline_obfuscation",
          "description": "Appears to use command line obfuscation",
          "categories": [
            "command"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [
            "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf"
          ],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "suspicious_command_tools",
          "description": "Uses suspicious command line tools or Windows utilities",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
            },
            {
              "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
            },
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "CACLS  \"mnolyk.exe\" /P \"sanya:N\""
            },
            {
              "command": "CACLS  \"mnolyk.exe\" /P \"sanya:R\" /E"
            },
            {
              "command": "CACLS  \"..\\4f9dd6f8a7\" /P \"sanya:N\""
            },
            {
              "command": "CACLS  \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        }
      ],
      "failure_reason": null,
      "improvement_suggestions": [],
      "debugger_log": "=== 2352.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 22:05:53 2025\nBreakpoint 2 hit by instruction at 0x09291CEB (thread 3724) EAX=0x6841bf4 ECX=0x1 EDX=0x147 ESI=0x6841afc EDI=0x19f520 ESP=0x19f3f8 *ESP=0x66f8f14 EBP=0x19f530\n0x09291CEB  8B85F0FEFFFF             MOV       EAX, [EBP-0x110]              \nActionDispatcher: skipping instruction.\n0x09291CF1  83780400                 CMP       DWORD [EAX+0x4], 0x0          \n\n\n=== 8092.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 22:06:45 2025\nBreakpoint 2 hit by instruction at 0x09311CEB (thread 4308) EAX=0x6851c00 ECX=0x1 EDX=0x147 ESI=0x6851b08 EDI=0x19f520 ESP=0x19f3f8 *ESP=0x6498f14 EBP=0x19f530\n0x09311CEB  8B85F0FEFFFF             MOV       EAX, [EBP-0x110]              \nActionDispatcher: skipping instruction.\n0x09311CF1  83780400                 CMP       DWORD [EAX+0x4], 0x0          \n\n\n=== 8992.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 22:06:22 2025\nBreakpoint 2 hit by instruction at 0x09241CEB (thread 7020) EAX=0x682540c ECX=0x1 EDX=0x147 ESI=0x6825314 EDI=0x19f520 \"\u0014S\" ESP=0x19f3f8 *ESP=0x64c8f14 EBP=0x19f530\n0x09241CEB  8B85F0FEFFFF             MOV       EAX, [EBP-0x110]              \nActionDispatcher: skipping instruction.\n0x09241CF1  83780400                 CMP       DWORD [EAX+0x4], 0x0          \n",
      "raw_response": "**EVOLUTION_REASONING**: The previous attempt resulted in a rule hit with no new signatures, indicating the rule was matching the wrong location or the cape options were interfering. The feedback suggested removing cape_options and focusing on matching specific patterns within the trace. I've selected three distinct patterns from the trace, concentrating on sequences related to the exit process and conditional checks before it. I've chosen concrete byte sequences to improve specificity and reduce the likelihood of false positives.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 70\n\n**REASONING**: These patterns are taken directly from the trace and target the conditional checks and calls that lead to the ExitProcess function. By focusing on these specific sequences, the rule should bypass the evasion logic without triggering false positives. The cape_options are included as requested, although their effectiveness is uncertain after the previous failure.\n\n**YARA_RULE**:\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 6A 5B }\n        $pattern1 = { 85 C0 0F 84 33 FD FF FF }\n        $pattern2 = { 8B 85 F0 FE FF FF }\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\gemma3_12b\\Iter\\Iter\\3ee952fa32cc989c\\iter1_v0.yar"
    }
  ],
  "best_attempt": {
    "iteration": 1,
    "prompt_version": "v0",
    "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 6A 5B }\n        $pattern1 = { 85 C0 0F 84 33 FD FF FF }\n        $pattern2 = { 8B 85 F0 FE FF FF }\n\n    condition:\n        any of them\n}",
    "pattern_type": "CALL_TEST_JE",
    "confidence": 70,
    "opcodes": "",
    "task_id": "1467",
    "status": "bypass_success",
    "rule_hit": true,
    "baseline_signatures": 16,
    "new_signatures": 22,
    "new_signature_names": [
      "persistence_autorun_tasks",
      "queries_computer_name",
      "dynamic_function_loading",
      "recon_beacon",
      "terminates_remote_process",
      "antisandbox_sleep",
      "stealth_timeout",
      "antiav_detectfile",
      "queries_locale_api",
      "cmdline_obfuscation",
      "reads_self",
      "queries_keyboard_layout",
      "creates_suspended_process",
      "infostealer_cookies",
      "antivm_generic_system",
      "stealth_window",
      "suspicious_command_tools",
      "injection_write_process",
      "uses_windows_utilities_to_create_scheduled_task",
      "uses_windows_utilities",
      "http_request",
      "resumethread_remote_process"
    ],
    "new_signature_details": [
      {
        "name": "queries_computer_name",
        "description": "Queries computer hostname",
        "categories": [
          "system_discovery"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 9204,
            "cid": 134
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "dynamic_function_loading",
        "description": "Dynamic (imported) function loading detected",
        "categories": [
          "anti-debug"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 40,
        "references": [],
        "data": [
          {
            "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3817
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3818
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3819
          },
          {
            "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3820
          },
          {
            "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3821
          },
          {
            "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3822
          },
          {
            "DynamicLoader": "apphelp.dll/SdbQueryContext"
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3823
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 153
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 154
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 155
          },
          {
            "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 156
          },
          {
            "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 157
          },
          {
            "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 158
          },
          {
            "DynamicLoader": "apphelp.dll/SdbQueryContext"
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 159
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "queries_keyboard_layout",
        "description": "Queries the keyboard layout",
        "categories": [
          "location_discovery"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 8328,
            "cid": 3899
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4522
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 5055
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "queries_locale_api",
        "description": "Queries the computer locale (possible geofencing)",
        "categories": [
          "location_discovery",
          "geofence"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 8328,
            "cid": 1067
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 1088
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3672
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3993
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4014
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4397
          },
          {
            "type": "call",
            "pid": 9204,
            "cid": 136
          },
          {
            "type": "call",
            "pid": 9204,
            "cid": 141
          },
          {
            "type": "call",
            "pid": 9204,
            "cid": 163
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 70
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 2542
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 6870
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 10527
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 14174
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 17812
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 21459
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 25096
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 28734
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 31336
          },
          {
            "type": "call",
            "pid": 1480,
            "cid": 67
          },
          {
            "type": "call",
            "pid": 6916,
            "cid": 22
          },
          {
            "type": "call",
            "pid": 6916,
            "cid": 31
          },
          {
            "type": "call",
            "pid": 3984,
            "cid": 21
          },
          {
            "type": "call",
            "pid": 3984,
            "cid": 30
          },
          {
            "type": "call",
            "pid": 8088,
            "cid": 67
          },
          {
            "type": "call",
            "pid": 6320,
            "cid": 22
          },
          {
            "type": "call",
            "pid": 6320,
            "cid": 31
          },
          {
            "type": "call",
            "pid": 3336,
            "cid": 21
          },
          {
            "type": "call",
            "pid": 3336,
            "cid": 30
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "stealth_timeout",
        "description": "Possible date expiration check, exits too soon after checking local time",
        "categories": [
          "stealth"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 40,
        "references": [],
        "data": [
          {
            "process": "rEz44fi71.exe, PID 3264"
          },
          {
            "type": "call",
            "pid": 3264,
            "cid": 580
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "antisandbox_sleep",
        "description": "A process attempted to delay the analysis task.",
        "categories": [
          "anti-sandbox"
        ],
        "severity": 2,
        "weight": 4,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 4900,
            "cid": 822
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 896
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 976
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 982
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 988
          },
          {
            "type": "call",
            "pid": 2352,
            "cid": 2111
          },
          {
            "type": "call",
            "pid": 8992,
            "cid": 2136
          },
          {
            "type": "call",
            "pid": 8092,
            "cid": 2084
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4525
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4604
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4606
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4937
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4978
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4988
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 5066
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 5092
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 5129
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 5136
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 5147
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 6132
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 12176
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 20284
          },
          {
            "type": "call",
            "pid": 5264,
            "cid": 27395
          },
          {
            "note": "mnolyk.exe tried to sleep 566.0 seconds, actually delayed analysis time by 0.0 seconds"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "http_request",
        "description": "Performs HTTP requests potentially not found in PCAP.",
        "categories": [
          "network"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 8328,
            "cid": 5073
          },
          {
            "url": "193.233.20.15:80//dF30Hn4m/index.php"
          },
          {
            "url": "193.233.20.15:80//dF30Hn4m/index.php"
          },
          {
            "url": "http://193.233.20.15/dF30Hn4m/Plugins/cred64.dll"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "creates_suspended_process",
        "description": "Creates a process in a suspended state, likely for injection",
        "categories": [
          "injection",
          "process hollowing"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 50,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 1056,
            "cid": 2
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "resumethread_remote_process",
        "description": "Resumed a thread in another process",
        "categories": [
          "injection",
          "unpacking"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "thread_resumed": "Process mnolyk.exe with process ID 8328 resumed a thread in another process with the process ID 9204"
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3842
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4467
          },
          {
            "thread_resumed": "Process cmd.exe with process ID 3144 resumed a thread in another process with the process ID 1480"
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 173
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 244
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 303
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 354
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 425
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 484
          },
          {
            "thread_resumed": "Process svchost.exe with process ID 1056 resumed a thread in another process with the process ID 5264"
          },
          {
            "type": "call",
            "pid": 1056,
            "cid": 3
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "injection_write_process",
        "description": "Writes to the memory another process",
        "categories": [
          "injection",
          "unpacking"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "write_memory": "Process mnolyk.exe with process ID 8328 wrote to the memory of process handle 0x00000500"
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3833
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3835
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3836
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4454
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4456
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4457
          },
          {
            "write_memory": "Process cmd.exe with process ID 3144 wrote to the memory of process handle 0x000002d0"
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 169
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 171
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 172
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 240
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 242
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 243
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 299
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 301
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 302
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 350
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 352
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 353
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 421
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 423
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 424
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 480
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 482
          },
          {
            "type": "call",
            "pid": 3144,
            "cid": 483
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "reads_self",
        "description": "Reads data out of its own binary image",
        "categories": [
          "generic"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 30,
        "references": [],
        "data": [
          {
            "self_read": "process: rEz44fi71.exe, pid: 3264, offset: 0x00000000, length: 0x00032000"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "stealth_window",
        "description": "A process created a hidden window",
        "categories": [
          "stealth"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "process": "rEz44fi71.exe -> C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe"
          },
          {
            "type": "call",
            "pid": 3264,
            "cid": 575
          },
          {
            "process": "mnolyk.exe -> SCHTASKS"
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3878
          },
          {
            "process": "mnolyk.exe -> cmd"
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 4524
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "terminates_remote_process",
        "description": "Terminates another process",
        "categories": [
          "persistence",
          "stealth"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 1056,
            "cid": 0
          },
          {
            "process": "svchost.exe"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "uses_windows_utilities",
        "description": "Uses Windows utilities for basic functionality",
        "categories": [
          "command",
          "lateral"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 80,
        "references": [],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
          },
          {
            "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
          },
          {
            "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "C:\\Windows\\system32\\cmd.exe  /S /D /c\" echo Y\""
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "uses_windows_utilities_to_create_scheduled_task",
        "description": "Uses Windows utilities to create a scheduled task",
        "categories": [
          "command",
          "lateral"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 80,
        "references": [],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "antivm_generic_system",
        "description": "Checks the system manufacturer, likely for anti-virtualization",
        "categories": [
          "anti-vm"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [],
        "new_data": [
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 5264
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          }
        ],
        "alert": false,
        "families": []
      },
      {
        "name": "infostealer_cookies",
        "description": "Touches a file containing cookies, possibly for information gathering",
        "categories": [
          "infostealer"
        ],
        "severity": 3,
        "weight": 4,
        "confidence": 100,
        "references": [],
        "data": [],
        "new_data": [
          {
            "process": {
              "process_name": "mnolyk.exe",
              "process_id": 8328
            },
            "signs": [
              {
                "type": "file",
                "value": "C:\\Users\\sanya\\AppData\\Local\\Microsoft\\Windows\\INetCookies"
              }
            ]
          }
        ],
        "alert": false,
        "families": []
      },
      {
        "name": "persistence_autorun_tasks",
        "description": "Installs itself for autorun at Windows startup",
        "categories": [
          "persistence"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 4264,
            "cid": 227
          },
          {
            "type": "call",
            "pid": 8416,
            "cid": 229
          },
          {
            "type": "call",
            "pid": 8764,
            "cid": 221
          },
          {
            "type": "call",
            "pid": 3508,
            "cid": 214
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 937
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 943
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 947
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 951
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 955
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 961
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 965
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 972
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 994
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 997
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 1001
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 1005
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 1009
          },
          {
            "type": "call",
            "pid": 4900,
            "cid": 1013
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 38
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3142
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3143
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3144
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3145
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3234
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3235
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3236
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 3237
          },
          {
            "task": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "recon_beacon",
        "description": "A process sent information about the computer to a remote location.",
        "categories": [
          "network",
          "discovery"
        ],
        "severity": 3,
        "weight": 2,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 8328,
            "cid": 4620
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 5060
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 5096
          },
          {
            "type": "call",
            "pid": 8328,
            "cid": 5141
          },
          {
            "Beacon": "mnolyk.exe: id=260811189190&vs=3.67&sd=c51b61&os=1&bi=1&ar=1&pc=DESKTOP-KJGI8L3&un=sanya&dm=&av=13&lv=0&og=1"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "antiav_detectfile",
        "description": "Attempts to identify installed AV products by installation directory",
        "categories": [
          "anti-av"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "file": "C:\\ProgramData\\AVAST Software"
          },
          {
            "file": "C:\\ProgramData\\Avira"
          },
          {
            "file": "C:\\ProgramData\\Kaspersky Lab"
          },
          {
            "file": "C:\\ProgramData\\ESET"
          },
          {
            "file": "C:\\ProgramData\\Panda Security"
          },
          {
            "file": "C:\\ProgramData\\Bitdefender"
          },
          {
            "file": "C:\\ProgramData\\AVG"
          },
          {
            "file": "C:\\ProgramData\\Doctor Web"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "cmdline_obfuscation",
        "description": "Appears to use command line obfuscation",
        "categories": [
          "command"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [
          "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf"
        ],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "suspicious_command_tools",
        "description": "Uses suspicious command line tools or Windows utilities",
        "categories": [
          "command",
          "lateral"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 80,
        "references": [],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
          },
          {
            "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\4f9dd6f8a7\\mnolyk.exe\" /F"
          },
          {
            "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\4f9dd6f8a7\" /P \"sanya:N\"&&CACLS \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "CACLS  \"mnolyk.exe\" /P \"sanya:N\""
          },
          {
            "command": "CACLS  \"mnolyk.exe\" /P \"sanya:R\" /E"
          },
          {
            "command": "CACLS  \"..\\4f9dd6f8a7\" /P \"sanya:N\""
          },
          {
            "command": "CACLS  \"..\\4f9dd6f8a7\" /P \"sanya:R\" /E"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      }
    ],
    "failure_reason": null,
    "improvement_suggestions": [],
    "debugger_log": "=== 2352.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 22:05:53 2025\nBreakpoint 2 hit by instruction at 0x09291CEB (thread 3724) EAX=0x6841bf4 ECX=0x1 EDX=0x147 ESI=0x6841afc EDI=0x19f520 ESP=0x19f3f8 *ESP=0x66f8f14 EBP=0x19f530\n0x09291CEB  8B85F0FEFFFF             MOV       EAX, [EBP-0x110]              \nActionDispatcher: skipping instruction.\n0x09291CF1  83780400                 CMP       DWORD [EAX+0x4], 0x0          \n\n\n=== 8092.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 22:06:45 2025\nBreakpoint 2 hit by instruction at 0x09311CEB (thread 4308) EAX=0x6851c00 ECX=0x1 EDX=0x147 ESI=0x6851b08 EDI=0x19f520 ESP=0x19f3f8 *ESP=0x6498f14 EBP=0x19f530\n0x09311CEB  8B85F0FEFFFF             MOV       EAX, [EBP-0x110]              \nActionDispatcher: skipping instruction.\n0x09311CF1  83780400                 CMP       DWORD [EAX+0x4], 0x0          \n\n\n=== 8992.log ===\nCAPE Sandbox - Debugger log: Mon Dec 22 22:06:22 2025\nBreakpoint 2 hit by instruction at 0x09241CEB (thread 7020) EAX=0x682540c ECX=0x1 EDX=0x147 ESI=0x6825314 EDI=0x19f520 \"\u0014S\" ESP=0x19f3f8 *ESP=0x64c8f14 EBP=0x19f530\n0x09241CEB  8B85F0FEFFFF             MOV       EAX, [EBP-0x110]              \nActionDispatcher: skipping instruction.\n0x09241CF1  83780400                 CMP       DWORD [EAX+0x4], 0x0          \n",
    "raw_response": "**EVOLUTION_REASONING**: The previous attempt resulted in a rule hit with no new signatures, indicating the rule was matching the wrong location or the cape options were interfering. The feedback suggested removing cape_options and focusing on matching specific patterns within the trace. I've selected three distinct patterns from the trace, concentrating on sequences related to the exit process and conditional checks before it. I've chosen concrete byte sequences to improve specificity and reduce the likelihood of false positives.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 70\n\n**REASONING**: These patterns are taken directly from the trace and target the conditional checks and calls that lead to the ExitProcess function. By focusing on these specific sequences, the rule should bypass the evasion logic without triggering false positives. The cape_options are included as requested, although their effectiveness is uncertain after the previous failure.\n\n**YARA_RULE**:\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 6A 5B }\n        $pattern1 = { 85 C0 0F 84 33 FD FF FF }\n        $pattern2 = { 8B 85 F0 FE FF FF }\n\n    condition:\n        any of them\n}\n```",
    "yara_file": "ablation_results\\gemma3_12b\\Iter\\Iter\\3ee952fa32cc989c\\iter1_v0.yar"
  },
  "best_score": 22,
  "optimization_history": [
    "Iteration 1: rule_hit - Rule hit but no new signatures",
    "Iteration 2: SUCCESS - 22 new signatures"
  ],
  "successful_patterns": [
    ""
  ],
  "failed_patterns": [
    ""
  ]
}