{
  "pipeline": "Simplified Bypass Pipeline with CAPE Validation",
  "timestamp": "2025-12-13T08:41:27.531608",
  "llm_type": "ollama",
  "binary_path": "/home/cape/Downloads/malware_samples/matched_exe/caf00150589120b59ea0145206e2aacad383d3cc18431674fd58cc84f49b0e25.exe",
  "multi_vm_enabled": true,
  "evolving_enabled": true,
  "max_iterations": 3,
  "min_signature_improvement": 1,
  "pe2_enabled": false,
  "retry_on_error": true,
  "max_retries": 3,
  "use_retry_feedback": true,
  "vm_configs": [
    {
      "name": "cape_vm1",
      "host": "192.168.197.146"
    },
    {
      "name": "cape_vm2",
      "host": "192.168.197.147"
    },
    {
      "name": "cape_vm3",
      "host": "192.168.197.148"
    },
    {
      "name": "cape_vm4",
      "host": "192.168.197.141"
    }
  ],
  "samples_processed": [],
  "evaluations": {},
  "yara_rules_generated": [],
  "baseline_result": {
    "task_id": "920",
    "signature_names": [
      "antivm_checks_available_memory",
      "queries_user_name",
      "dead_connect",
      "static_pe_pdbpath",
      "antidebug_setunhandledexceptionfilter",
      "language_check_registry",
      "antidebug_guardpages",
      "createtoolhelp32snapshot_module_enumeration",
      "packer_entropy",
      "dropper",
      "injection_rwx",
      "antiav_servicestop",
      "persistence_autorun",
      "procmem_yara",
      "deletes_executed_files",
      "disables_windowsupdate"
    ],
    "signature_count": 16
  },
  "cape_validations": [],
  "successful_bypasses": [
    {
      "prompt_version": "v3",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\caf00150589120b5\\iter1_v3.yar",
      "new_signatures": [
        "queries_keyboard_layout",
        "resumethread_remote_process",
        "reads_self",
        "stealth_timeout",
        "injection_write_process",
        "uses_windows_utilities",
        "suspicious_command_tools",
        "persistence_autorun_tasks",
        "cmdline_obfuscation",
        "http_request",
        "stealth_window",
        "antiav_detectfile",
        "infostealer_cookies",
        "queries_locale_api"
      ],
      "new_signature_details": [
        {
          "name": "queries_keyboard_layout",
          "description": "Queries the keyboard layout",
          "categories": [
            "location_discovery"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 6996,
              "cid": 3794
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 4425
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "queries_locale_api",
          "description": "Queries the computer locale (possible geofencing)",
          "categories": [
            "location_discovery",
            "geofence"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 6996,
              "cid": 1066
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 1087
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3573
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3893
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3914
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 4297
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "stealth_timeout",
          "description": "Possible date expiration check, exits too soon after checking local time",
          "categories": [
            "stealth"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 40,
          "references": [],
          "data": [
            {
              "process": "hk08BD16OP32.exe, PID 7976"
            },
            {
              "type": "call",
              "pid": 7976,
              "cid": 581
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "http_request",
          "description": "Performs HTTP requests potentially not found in PCAP.",
          "categories": [
            "network"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "url": "193.233.20.14:80//BR54nmB3/index.php"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "resumethread_remote_process",
          "description": "Resumed a thread in another process",
          "categories": [
            "injection",
            "unpacking"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "thread_resumed": "Process mnolyk.exe with process ID 6996 resumed a thread in another process with the process ID 3084"
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3743
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 4368
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "injection_write_process",
          "description": "Writes to the memory another process",
          "categories": [
            "injection",
            "unpacking"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "write_memory": "Process mnolyk.exe with process ID 6996 wrote to the memory of process handle 0x000004d8"
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3734
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3736
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3737
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 4355
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 4357
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 4358
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "reads_self",
          "description": "Reads data out of its own binary image",
          "categories": [
            "generic"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 30,
          "references": [],
          "data": [
            {
              "self_read": "process: hk08BD16OP32.exe, pid: 7976, offset: 0x00000000, length: 0x00032000"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "stealth_window",
          "description": "A process created a hidden window",
          "categories": [
            "stealth"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "process": "hk08BD16OP32.exe -> C:\\Users\\sanya\\AppData\\Local\\Temp\\465af4af92\\mnolyk.exe"
            },
            {
              "type": "call",
              "pid": 7976,
              "cid": 576
            },
            {
              "process": "mnolyk.exe -> SCHTASKS"
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3796
            },
            {
              "process": "mnolyk.exe -> cmd"
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 4423
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "uses_windows_utilities",
          "description": "Uses Windows utilities for basic functionality",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\465af4af92\\mnolyk.exe\" /F"
            },
            {
              "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\465af4af92\\mnolyk.exe\" /F"
            },
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\465af4af92\" /P \"sanya:N\"&&CACLS \"..\\465af4af92\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\465af4af92\" /P \"sanya:N\"&&CACLS \"..\\465af4af92\" /P \"sanya:R\" /E&&Exit"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "infostealer_cookies",
          "description": "Touches a file containing cookies, possibly for information gathering",
          "categories": [
            "infostealer"
          ],
          "severity": 3,
          "weight": 4,
          "confidence": 100,
          "references": [],
          "data": [],
          "new_data": [
            {
              "process": {
                "process_name": "mnolyk.exe",
                "process_id": 6996
              },
              "signs": [
                {
                  "type": "file",
                  "value": "C:\\Users\\sanya\\AppData\\Local\\Microsoft\\Windows\\INetCookies"
                }
              ]
            }
          ],
          "alert": false,
          "families": []
        },
        {
          "name": "persistence_autorun_tasks",
          "description": "Installs itself for autorun at Windows startup",
          "categories": [
            "persistence"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 6952,
              "cid": 233
            },
            {
              "type": "call",
              "pid": 7252,
              "cid": 237
            },
            {
              "type": "call",
              "pid": 8544,
              "cid": 229
            },
            {
              "type": "call",
              "pid": 8964,
              "cid": 231
            },
            {
              "type": "call",
              "pid": 7916,
              "cid": 225
            },
            {
              "type": "call",
              "pid": 1652,
              "cid": 219
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 961
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 967
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 971
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 975
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 979
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 985
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 989
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 996
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 1018
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 1021
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 1025
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 1029
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 1033
            },
            {
              "type": "call",
              "pid": 6796,
              "cid": 1037
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 962
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 969
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 975
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 981
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 987
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 993
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 999
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 1005
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 1029
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 1035
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 1041
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 1047
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 1053
            },
            {
              "type": "call",
              "pid": 8900,
              "cid": 1059
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 36
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3044
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3045
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3046
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3047
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3136
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3137
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3138
            },
            {
              "type": "call",
              "pid": 6996,
              "cid": 3139
            },
            {
              "task": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\465af4af92\\mnolyk.exe\" /F"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antiav_detectfile",
          "description": "Attempts to identify installed AV products by installation directory",
          "categories": [
            "anti-av"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "file": "C:\\ProgramData\\AVAST Software"
            },
            {
              "file": "C:\\ProgramData\\Avira"
            },
            {
              "file": "C:\\ProgramData\\Kaspersky Lab"
            },
            {
              "file": "C:\\ProgramData\\ESET"
            },
            {
              "file": "C:\\ProgramData\\Panda Security"
            },
            {
              "file": "C:\\ProgramData\\Bitdefender"
            },
            {
              "file": "C:\\ProgramData\\AVG"
            },
            {
              "file": "C:\\ProgramData\\Doctor Web"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "cmdline_obfuscation",
          "description": "Appears to use command line obfuscation",
          "categories": [
            "command"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [
            "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf"
          ],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\465af4af92\" /P \"sanya:N\"&&CACLS \"..\\465af4af92\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\465af4af92\" /P \"sanya:N\"&&CACLS \"..\\465af4af92\" /P \"sanya:R\" /E&&Exit"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "suspicious_command_tools",
          "description": "Uses suspicious command line tools or Windows utilities",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\465af4af92\\mnolyk.exe\" /F"
            },
            {
              "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\465af4af92\\mnolyk.exe\" /F"
            },
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\465af4af92\" /P \"sanya:N\"&&CACLS \"..\\465af4af92\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\465af4af92\" /P \"sanya:N\"&&CACLS \"..\\465af4af92\" /P \"sanya:R\" /E&&Exit"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        }
      ],
      "iterations": 2,
      "vm_host": "192.168.197.141"
    }
  ],
  "comparison": {},
  "evolution_states": {
    "v3": {
      "iterations": 2,
      "best_score": 14,
      "success": true,
      "vm_host": "192.168.197.141"
    },
    "v0": {
      "iterations": 3,
      "best_score": 0,
      "success": false,
      "vm_host": "192.168.197.146"
    },
    "v2": {
      "iterations": 3,
      "best_score": 0,
      "success": false,
      "vm_host": "192.168.197.148"
    },
    "v1": {
      "iterations": 3,
      "best_score": 0,
      "success": false,
      "vm_host": "192.168.197.147"
    }
  },
  "pe2_evolution": {},
  "retry_summaries": {}
}