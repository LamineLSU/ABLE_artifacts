{
  "sha256": "868f0c88c0833607909bc424e3d32f5458fd3d6dcb73f97e64f84926b131078e",
  "prompt_version": "v3",
  "iterations": [
    {
      "iteration": 0,
      "prompt_version": "v3",
      "yara_rule": "rule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 53 FF 15 ?? ?? ?? ?? E9 ?? ?? ?? ?? }  // PUSH EBX + CALL ExitProcess + JMP to skip exit\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? 8B 45 ?? }      // TEST EAX + JZ + MOV EAX to skip exit check\n        $pattern2 = { 85 C0 0F 84 ?? ?? ?? ?? 8B 4D ?? }      // TEST EAX + JZ + MOV EBP to skip exit check\n\n    condition:\n        any of them\n}",
      "pattern_type": "UNKNOWN",
      "confidence": 50,
      "opcodes": "",
      "task_id": "1759",
      "status": "rule_hit",
      "rule_hit": true,
      "baseline_signatures": 39,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule hit but no new signatures",
      "improvement_suggestions": [
        "Adjust patterns to match short jumps (74) and verify skip offsets based on actual code flow."
      ],
      "debugger_log": "=== 5312.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 17:22:22 2025\nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4025308 ECX=0x19dfd0 \"\fE\" EDX=0x4025308 ESI=0x40255a4 EDI=0x4025308 ESP=0x19dfdc *ESP=0x20d8cf0 \"R\u0011\" EBP=0x19dff4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4025308 ECX=0x19dfd0 EDX=0x40255dc ESI=0x40255a4 EDI=0x4025308 ESP=0x19dfdc *ESP=0x20d8cf0 \"R\u0011\" EBP=0x19dff4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x19d360 ECX=0x19d238 EDX=0x4037bb0 ESI=0x3ba92a0 EDI=0x4037bb0 ESP=0x19d244 *ESP=0x6ab9f4eb \"ZY_^[]\" clr.dll EBP=0x19d25c\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x77352eb0 FindResourceA  ECX=0x19cae8 EDX=0x403d154 ESI=0x403d154 EDI=0x77352eb0 FindResourceA  ESP=0x19caf4 *ESP=0x19cafc EBP=0x19cb0c\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x77360630 OpenProcess  ECX=0x19cae8 EDX=0x40b1bd4 ESI=0x40b1bd4 EDI=0x77360630 OpenProcess  ESP=0x19caf4 *ESP=0x19ca98 EBP=0x19cb0c\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x773604c0 VirtualProtect  ECX=0x19caf0 EDX=0x40b1cb4 ESI=0x40b1cb4 EDI=0x773604c0 VirtualProtect  ESP=0x19cafc *ESP=0x19caa0 EBP=0x19cb14\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) ECX=0x19caf4 EDX=0x40b1d64 ESI=0x40b1d64 EDI=0x77362ee0 CloseHandle  ESP=0x19cb00 *ESP=0x19caa4 EBP=0x19cb18\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4134e68 ESP=0x19d8e8 *ESP=0x20d90dc EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4134e68 ESP=0x19d8d8 *ESP=0x19d9f0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x4134e68 ESP=0x19d8ac *ESP=0xb7 EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x41352e0 ESP=0x19d8e8 *ESP=0x40b1ec0 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x41352e0 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x41352e0 ESP=0x19d8ac *ESP=0x1fd0078 EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4135524 ESP=0x19d8e8 *ESP=0x40b1f84 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4135524 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x4135524 ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4135768 ESP=0x19d8e8 *ESP=0x40b1fc4 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4135768 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x4135768 ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x41359ac ESP=0x19d8e8 *ESP=0x40b1ffc EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x41359ac ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x41359ac ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4135bfc ESP=0x19d8e8 *ESP=0x0 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4135bfc ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x4135bfc ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4135e40 ESP=0x19d8e8 \"| \u000b\" *ESP=0x40b207c EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4135e40 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x4135e40 ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136240 ESP=0x19d8e8 *ESP=0x0 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136240 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136240 ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136564 ESP=0x19d8e8 *ESP=0x0 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136564 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136564 ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136758 ESP=0x19d8e8 *ESP=0x40b2298 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136758 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136758 ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x413694c ESP=0x19d8e8 *ESP=0x40b22d4 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x413694c ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x413694c ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136b40 ESP=0x19d8e8 *ESP=0x40b22fc EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136b40 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136b40 ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136d34 ESP=0x19d8e8 \"D#\u000b\" *ESP=0x40b2344 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136d34 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136d34 ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136f18 ESP=0x19d8e8 *ESP=0x40b23d8 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136f18 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x4136f18 ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4137108 ESP=0x19d8e8 \"@$\u000b\" *ESP=0x40b2440 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x4137108 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x4137108 ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x413b2d8 ESP=0x19d8e8 *ESP=0x40b2490 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x413b2d8 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x413b2d8 ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8dc EDX=0x4134e74 ESI=0x4134e74 EDI=0x413b7f0 ESP=0x19d8e8 *ESP=0x40b24b0 EBP=0x19d900\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8cc EDX=0x4134e74 ESI=0x4134e74 EDI=0x413b7f0 ESP=0x19d8d8 *ESP=0x20d6fb0 EBP=0x19d8f0\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \nBreakpoint 2 hit by instruction at 0x021D7553 (thread 2604) EBX=0x4134e74 ECX=0x19d8a0 EDX=0x4134e74 ESI=0x4134e74 EDI=0x413b7f0 ESP=0x19d8ac *ESP=0x6fa528 \"TL\" EBP=0x19d8c4\n0x021D7553  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021D7555  0F84C9000000             JZ        0xcf                          \n\n\n=== 7720.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 17:23:37 2025\nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x9 ECX=0x2b9fafc EDX=0x1 ESI=0x4a9283a L\"/Create\" EDI=0x2b9f790 \"PARSER2\" ESP=0x2b9f710 *ESP=0x2b9fb10 EBP=0x2b9f758\nBreak at 0x007ADADC in schtasks.exe (RVA 0x1dadc, thread 1564, Stack 0x02B92000-0x02BA0000, ImageBase 0x00790000)\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x9 ECX=0x2e43eb0 EDX=0x1 EDI=0x2b9f790 \"PARSER2\" ESP=0x2b9f710 *ESP=0x2b9fb10 EBP=0x2b9f758\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x9 ECX=0x2e43cd0 EDX=0x1 EDI=0x2b9f790 \"PARSER2\" ESP=0x2b9f710 *ESP=0x2b9fb10 EBP=0x2b9f758\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x9 ECX=0x2e43b70 EDX=0x1 EDI=0x2b9f790 \"PARSER2\" ESP=0x2b9f710 *ESP=0x2b9fb10 EBP=0x2b9f758\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x9 ECX=0x2e43bb0 EDX=0x1 EDI=0x2b9f790 \"PARSER2\" ESP=0x2b9f710 *ESP=0x2b9fb10 EBP=0x2b9f758\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x9 ECX=0x2e43ef0 EDX=0x1 EDI=0x2b9f790 \"PARSER2\" ESP=0x2b9f710 *ESP=0x2b9fb10 EBP=0x2b9f758\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x9 ECX=0x2e43bd0 EDX=0x1 EDI=0x2b9f790 \"PARSER2\" ESP=0x2b9f710 *ESP=0x2b9fb10 EBP=0x2b9f758\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x9 ECX=0x2e43cf0 EDX=0x1 EDI=0x2b9f790 \"PARSER2\" ESP=0x2b9f710 *ESP=0x2b9fb10 EBP=0x2b9f758\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x9 ECX=0x2e43df0 EDX=0x1 EDI=0x2b9f790 \"PARSER2\" ESP=0x2b9f710 *ESP=0x2b9fb10 EBP=0x2b9f758\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x9 ECX=0x2e43d50 EDX=0x1 EDI=0x2b9f790 \"PARSER2\" ESP=0x2b9f710 *ESP=0x2b9fb10 EBP=0x2b9f758\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x1f ECX=0x2b9fa98 EDX=0x1 ESI=0x4a9283a L\"/Create\" EDI=0x2b9cc30 \"PARSER2\" ESP=0x2b9cb80 *ESP=0x2b9fa9c EBP=0x2b9cbc8\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x1f EDX=0x2 ESI=0x4a9284a L\"/SC\" EDI=0x2b9cc30 \"PARSER2\" ESP=0x2b9cb80 *ESP=0x2b9fa9c EBP=0x2b9cbc8\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x1f EDX=0x2 ESI=0x4a92860 L\"/MO\" EDI=0x2b9cc30 \"PARSER2\" ESP=0x2b9cb80 *ESP=0x2b9fa9c EBP=0x2b9cbc8\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x1f EDX=0x2 ESI=0x4a9286c L\"/TN\" EDI=0x2b9cc30 \"PARSER2\" ESP=0x2b9cb80 *ESP=0x2b9fa9c EBP=0x2b9cbc8\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x1f EDX=0x2 ESI=0x4a9288a L\"/TR\" EDI=0x2b9cc30 \"PARSER2\" ESP=0x2b9cb80 *ESP=0x2b9fa9c EBP=0x2b9cbc8\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \nBreakpoint 1 hit by instruction at 0x007ADADC (thread 1564) EAX=0x1 EBX=0x1f ECX=0x2b9fab4 EDX=0x2 ESI=0x4a92902 L\"/F\" EDI=0x2b9cc30 \"PARSER2\" ESP=0x2b9cb80 *ESP=0x2b9fa9c EBP=0x2b9cbc8\n0x007ADADC  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007ADADE  0F847F010000             JZ        0x185                         \n",
      "raw_response": "```yara\nrule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 53 FF 15 ?? ?? ?? ?? E9 ?? ?? ?? ?? }  // PUSH EBX + CALL ExitProcess + JMP to skip exit\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? 8B 45 ?? }      // TEST EAX + JZ + MOV EAX to skip exit check\n        $pattern2 = { 85 C0 0F 84 ?? ?? ?? ?? 8B 4D ?? }      // TEST EAX + JZ + MOV EBP to skip exit check\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\868f0c88c0833607\\iter0_v3.yar"
    },
    {
      "iteration": 1,
      "prompt_version": "v3",
      "yara_rule": "rule Bypass_Sample_Evolved  \n{  \n    meta:  \n        description = \"Evasion bypass rule - evolved\"  \n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"  \n\n    strings:  \n        $pattern0 = { 85 C0 74 12 6A 5B }  // Test+je + next instruction (evasion check)  \n        $pattern1 = { E8 ?? ?? ?? ?? 85 C0 0F 84 ?? ?? ?? ?? }  // Call + test+je (API check)  \n        $pattern2 = { 85 C0 74 07 8B 45 FC }  // Test+je leading to ExitProcess (exit decision)  \n\n    condition:  \n        any of them  \n}",
      "pattern_type": "CALL_TEST_JE",
      "confidence": 95,
      "opcodes": "",
      "task_id": "1760",
      "status": "bypass_crashed",
      "rule_hit": true,
      "baseline_signatures": 39,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule caused crash: ['exec_crash']",
      "improvement_suggestions": [
        "Refine the patterns to target only the specific instructions in the original trace and avoid matching unrelated API calls."
      ],
      "debugger_log": "=== 2940.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 17:28:52 2025\nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x4275308 ECX=0x4275308 EDX=0x4275308 ESI=0x42755a4 EDI=0x4275308 ESP=0x19dfdc *ESP=0x21e8cf0 \"R\u0011\" EBP=0x19dff4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x4275308 ECX=0x42755dc EDX=0x42755dc ESI=0x42755a4 EDI=0x4275308 ESP=0x19dfdc *ESP=0x21e8cf0 \"R\u0011\" EBP=0x19dff4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x19d360 ECX=0x4287bb0 EDX=0x4287bb0 ESI=0x3fb92a0 EDI=0x4287bb0 ESP=0x19d244 *ESP=0x6ab9f4eb \"ZY_^[]\" clr.dll EBP=0x19d25c\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x77352eb0 FindResourceA  ECX=0x428d154 EDX=0x428d154 ESI=0x428d154 EDI=0x77352eb0 FindResourceA  ESP=0x19caf4 *ESP=0x19cafc EBP=0x19cb0c\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x77360630 OpenProcess  ECX=0x4301bd4 EDX=0x4301bd4 ESI=0x4301bd4 EDI=0x77360630 OpenProcess  ESP=0x19caf4 *ESP=0x19ca98 EBP=0x19cb0c\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x773604c0 VirtualProtect  ECX=0x4301cb4 EDX=0x4301cb4 ESI=0x4301cb4 EDI=0x773604c0 VirtualProtect  ESP=0x19cafc *ESP=0x19caa0 EBP=0x19cb14\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) ECX=0x4301d64 EDX=0x4301d64 ESI=0x4301d64 EDI=0x77362ee0 CloseHandle  ESP=0x19cb00 *ESP=0x19caa4 EBP=0x19cb18\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4383490 ESP=0x19d8e8 *ESP=0x21e90dc EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4383490 ESP=0x19d8d8 *ESP=0x19d9f0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4383490 ESP=0x19d8ac *ESP=0xb7 EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x43838fc ESP=0x19d8e8 *ESP=0x4301ec0 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x43838fc ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x43838fc ESP=0x19d8ac *ESP=0x8a0078 EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4383b40 ESP=0x19d8e8 *ESP=0x4301f84 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4383b40 ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4383b40 ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4383d84 ESP=0x19d8e8 *ESP=0x4301fc4 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4383d84 ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4383d84 ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4383fc8 ESP=0x19d8e8 *ESP=0x4301ffc EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4383fc8 ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4383fc8 ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4384218 ESP=0x19d8e8 *ESP=0x0 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4384218 ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4384218 ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x438445c ESP=0x19d8e8 \"| 0\" *ESP=0x430207c EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x438445c ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x438445c ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x438485c ESP=0x19d8e8 *ESP=0x0 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x438485c ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x438485c ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4384b80 ESP=0x19d8e8 *ESP=0x0 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4384b80 ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4384b80 ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4384d74 ESP=0x19d8e8 *ESP=0x4302298 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4384d74 ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4384d74 ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4384f68 ESP=0x19d8e8 *ESP=0x43022d4 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4384f68 ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4384f68 ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4385168 ESP=0x19d8e8 *ESP=0x43022fc EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4385168 ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4385168 ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x438535c ESP=0x19d8e8 \"D#0\" *ESP=0x4302344 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x438535c ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x438535c ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4385540 ESP=0x19d8e8 *ESP=0x43023d8 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4385540 ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4385540 ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4385724 ESP=0x19d8e8 \"@$0\" *ESP=0x4302440 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4385724 ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4385724 ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x43898f4 ESP=0x19d8e8 *ESP=0x4302490 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x43898f4 ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x43898f4 ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4389e0c ESP=0x19d8e8 *ESP=0x43024b0 EBP=0x19d900\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4389e0c ESP=0x19d8d8 *ESP=0x21e6fb0 EBP=0x19d8f0\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x03E8754E (thread 5380) EBX=0x438349c ECX=0x438349c EDX=0x438349c ESI=0x438349c EDI=0x4389e0c ESP=0x19d8ac *ESP=0x666ef0 \"TL\" EBP=0x19d8c4\n0x03E8754E  E80D59D366               CALL      0x66d35912                    \nActionDispatcher: skipping instruction.\n0x03E87553  85C0                     TEST      EAX, EAX                      \n\n\n=== 4068.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 17:30:29 2025\nBreakpoint 1 hit by instruction at 0x00F63E53 (thread 5432) EAX=0x67e884 ECX=0xd911fc L\"sanya:N\" EDX=0x67e888 ESI=0xd911fc L\"sanya:N\" EDI=0x3 ESP=0x67e864 *ESP=0x67e884 EBP=0x67f8fc\nBreak at 0x00F63E53 in cacls.exe (RVA 0x3e53, thread 5432, Stack 0x00671000-0x00680000, ImageBase 0x00F60000)\n0x00F63E53  E8D2060000               CALL      0x6d7                         \nActionDispatcher: skipping instruction.\n0x00F63E58  85C0                     TEST      EAX, EAX                      \n\n\n=== 560.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 17:29:53 2025\nBreakpoint 1 hit by instruction at 0x00007FFA7FE8C286 (thread 7664) RBX=0x43553b0 RCX=0x4355588 RDX=0x4351af8 RSI=0x43550c0 RDI=0x4355218 RSP=0x93dc80 *RSP=0x4355588 RBP=0x6c R8=0x5 R9=0x435535c R10=0x42 R11=0x42 R12=0x4291450 R13=0x93e4c0 R14=0x21 R15=0x43551b8 Xmm0.Low=0x43553b0 Xmm1.Low=0x4355588\n0x00007FFA7FE8C286  E8CD84FCFF               CALL      0xfffffffffffc84d2            \nActionDispatcher: skipping instruction.\n0x00007FFA7FE8C28B  85C0                     TEST      EAX, EAX                      \nBreakpoint 1 hit by instruction at 0x00007FFA7FE8C286 (thread 7664) RBX=0x4355c88 RCX=0x4355e60 RDX=0x4351af8 RSI=0x43559f8 RDI=0x4355af0 RSP=0x93dbd0 \"`^5\" *RSP=0x4355e60 RBP=0x6c R8=0x5 R9=0x4355c34 R10=0x42 R11=0x42 R12=0x4291450 R13=0x93e4c0 R14=0x21 R15=0x43551b8 Xmm0.Low=0x4355c88 Xmm1.Low=0x4355e60\n0x00007FFA7FE8C286  E8CD84FCFF               CALL      0xfffffffffffc84d2            \nActionDispatcher: skipping instruction.\n0x00007FFA7FE8C28B  85C0                     TEST      EAX, EAX                      \n",
      "raw_response": "**EVOLUTION_REASONING**: The previous patterns matched the ExitProcess call but failed to capture evasion checks or conditional jumps that precede it. By focusing on test+je sequences (evasion checks) and the je instruction leading to ExitProcess (exit decision), we target critical control flow points. These patterns are derived directly from the trace, ensuring specificity while allowing flexibility for offset variations.  \n\n**PATTERN_TYPE**: CALL_TEST_JE  \n\n**CONFIDENCE**: 95  \n\n**REASONING**: The selected patterns capture test eax, eax followed by je instructions, which are common in evasion checks. The first pattern targets a conditional jump (74 12) after a test, the second captures a call to a function followed by a test+je sequence (useful for API checks), and the third focuses on the je instruction directly preceding ExitProcess. These patterns are concrete from the trace and avoid wildcards except for address/offset bytes, minimizing false positives.  \n\n**YARA_RULE**:  \n```yara  \nrule Bypass_Sample_Evolved  \n{  \n    meta:  \n        description = \"Evasion bypass rule - evolved\"  \n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"  \n\n    strings:  \n        $pattern0 = { 85 C0 74 12 6A 5B }  // Test+je + next instruction (evasion check)  \n        $pattern1 = { E8 ?? ?? ?? ?? 85 C0 0F 84 ?? ?? ?? ?? }  // Call + test+je (API check)  \n        $pattern2 = { 85 C0 74 07 8B 45 FC }  // Test+je leading to ExitProcess (exit decision)  \n\n    condition:  \n        any of them  \n}  \n```",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\868f0c88c0833607\\iter1_v3.yar"
    },
    {
      "iteration": 2,
      "prompt_version": "v3",
      "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { E8 ?? ?? ?? ?? 85 C0 0F 84 ?? ?? ?? ?? }  // CALL+TEST+JE sequence\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? }                  // TEST+JE sequence\n        $pattern2 = { 8B 85 ?? ?? ?? ?? 03 C3 03 C1 }            // Arithmetic check sequence\n\n    condition:\n        any of them\n}",
      "pattern_type": "CALL_TEST_JE",
      "confidence": 95,
      "opcodes": "",
      "task_id": "1761",
      "status": "bypass_crashed",
      "rule_hit": true,
      "baseline_signatures": 39,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule caused crash: ['exec_crash']",
      "improvement_suggestions": [
        "Adjust the pattern to target a different instruction sequence that is safe to skip, such as the TEST and JE pair in the original trace, and refine the skip offset to avoid disrupting critical code."
      ],
      "debugger_log": "=== 4592.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 16:16:38 2025\nBreakpoint 0 hit by instruction at 0x00473E53 (thread 8972) EAX=0x33e994 ECX=0x28d11fc L\"sanya:N\" EDX=0x33e998 ESI=0x28d11fc L\"sanya:N\" EDI=0x3 ESP=0x33e974 *ESP=0x33e994 EBP=0x33fa0c\nBreak at 0x00473E53 in cacls.exe (RVA 0x3e53, thread 8972, Stack 0x00331000-0x00340000, ImageBase 0x00470000)\n0x00473E53  E8D2060000               CALL      0x6d7                         \nActionDispatcher: skipping instruction.\n0x00473E58  85C0                     TEST      EAX, EAX                      \n\n\n=== 6228.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 16:15:28 2025\nBreakpoint 0 hit by instruction at 0x00007FFA7FACC286 (thread 5276) RBX=0x40d7cf8 RCX=0x40d7ed0 RDX=0x40d4458 RSI=0x40d7a08 RDI=0x40d7b60 RSP=0x58dc80 *RSP=0x40d7ed0 RBP=0x6c R8=0x5 R9=0x40d7ca4 R10=0x42 R11=0x42 R12=0x4011450 R13=0x58e4c0 R14=0x21 R15=0x40d7b00 Xmm0.Low=0x40d7cf8 Xmm1.Low=0x40d7ed0\n0x00007FFA7FACC286  E8CD84FCFF               CALL      0xfffffffffffc84d2            \nActionDispatcher: skipping instruction.\n0x00007FFA7FACC28B  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x00007FFA7FACC286 (thread 5276) RBX=0x40d85e8 RCX=0x40d87c0 RDX=0x40d4458 RSI=0x40d8358 RDI=0x40d8450 RSP=0x58dbd0 *RSP=0x40d87c0 RBP=0x6c R8=0x5 R9=0x40d8594 R10=0x42 R11=0x42 R12=0x4011450 R13=0x58e4c0 R14=0x21 R15=0x40d7b00 Xmm0.Low=0x40d85e8 Xmm1.Low=0x40d87c0\n0x00007FFA7FACC286  E8CD84FCFF               CALL      0xfffffffffffc84d2            \nActionDispatcher: skipping instruction.\n0x00007FFA7FACC28B  85C0                     TEST      EAX, EAX                      \n\n\n=== 9044.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 16:14:49 2025\nBreakpoint 1 hit by instruction at 0x021F87AE (thread 1920) ESI=0x424132c EDI=0x8b8198 ESP=0x19dc10 *ESP=0x6ab9f4eb \"ZY_^[]\" clr.dll EBP=0x19dc30\n0x021F87AE  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x021F87B0  0F847F000000             JZ        0x85                          \n",
      "raw_response": "**EVOLUTION_REASONING**: Refining patterns to target specific evasion logic before ExitProcess, avoiding API calls. Focused on CALL+TEST+JE sequences and arithmetic checks in the original trace to reduce false positives.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 95\n\n**REASONING**: These patterns target the core evasion logic (CALL+TEST+JE) and arithmetic checks in the original trace. Using concrete bytes from the trace ensures specificity while wildcards allow for variant tolerance. Avoiding API calls reduces crash risk.\n\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { E8 ?? ?? ?? ?? 85 C0 0F 84 ?? ?? ?? ?? }  // CALL+TEST+JE sequence\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? }                  // TEST+JE sequence\n        $pattern2 = { 8B 85 ?? ?? ?? ?? 03 C3 03 C1 }            // Arithmetic check sequence\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\868f0c88c0833607\\iter2_v3.yar"
    }
  ],
  "best_attempt": null,
  "best_score": 0,
  "optimization_history": [
    "Iteration 1: rule_hit - Rule hit but no new signatures",
    "Iteration 2: bypass_crashed - Rule caused crash: ['exec_crash']",
    "Iteration 3: bypass_crashed - Rule caused crash: ['exec_crash']"
  ],
  "successful_patterns": [],
  "failed_patterns": [
    "",
    "",
    ""
  ]
}