{
  "sha256": "77d6f1914af6caf909fa2a246fcec05f500f79dd56e5d0d466d55924695c702d",
  "prompt_version": "v2",
  "iterations": [
    {
      "iteration": 0,
      "prompt_version": "v2",
      "yara_rule": "rule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 6A 00 FF 15 ?? ?? ?? ?? }\n        $pattern1 = { 3B C7 75 E1 ?? ?? ?? ?? }\n        $pattern2 = { 53 57 57 57 FF 15 ?? ?? ?? ?? }\n\n    condition:\n        any of them\n}",
      "pattern_type": "UNKNOWN",
      "confidence": 50,
      "opcodes": "",
      "task_id": "185",
      "status": "rule_hit",
      "rule_hit": true,
      "baseline_signatures": 7,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule hit but no new signatures",
      "improvement_suggestions": [
        "Refine the patterns to target specific anti-analysis checks (e.g., `ExitProcess` or memory sanitization routines) and adjust skip offsets to avoid invalid code jumps."
      ],
      "debugger_log": "=== 8960.log ===\nCAPE Sandbox - Debugger log: Sun Dec 28 15:15:46 2025\nBreakpoint 1 hit by instruction at 0x00F4D080 (thread 8004) EBX=0xf59010 \"HAL9TH_DESKTOP-KJGI8L3_sanya\" 77d6f1914af6caf909fa2a24.exe ECX=0x1530000 EDX=0x1530000 ESI=0x1f0003 ESP=0xe5f96c *ESP=0xf4cf89 77d6f1914af6caf909fa2a24.exe EBP=0xe5f9c0\nBreak at 0x00F4D080 in 77d6f1914af6caf909fa2a24.exe (RVA 0xd080, thread 8004, Stack 0x00E52000-0x00E60000, ImageBase 0x00F40000)\n0x00F4D080  3BC7                     CMP       EAX, EDI                      \nActionDispatcher: skipping instruction.\n0x00F4D082  75E1                     JNZ       0xffffffe3                    \nBreakpoint 2 hit by instruction at 0x00F4D084 (thread 8004) EBX=0xf59010 \"HAL9TH_DESKTOP-KJGI8L3_sanya\" 77d6f1914af6caf909fa2a24.exe ECX=0x1530000 EDX=0x1530000 ESI=0x1f0003 ESP=0xe5f96c *ESP=0xf4cf89 77d6f1914af6caf909fa2a24.exe EBP=0xe5f9c0\n0x00F4D084  53                       PUSH      EBX                           \nActionDispatcher: skipping instruction.\n0x00F4D085  57                       PUSH      EDI                           \n",
      "raw_response": "```yara\nrule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 6A 00 FF 15 ?? ?? ?? ?? }\n        $pattern1 = { 3B C7 75 E1 ?? ?? ?? ?? }\n        $pattern2 = { 53 57 57 57 FF 15 ?? ?? ?? ?? }\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\77d6f1914af6caf9\\iter0_v2.yar"
    },
    {
      "iteration": 1,
      "prompt_version": "v2",
      "yara_rule": "rule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { FF 15 ?? ?? ?? ?? 3B C7 75 E1 }\n        $pattern1 = { FF 15 ?? ?? ?? ?? 8B F0 74 03 }\n        $pattern2 = { 74 03 75 01 FF 15 ?? ?? ?? ?? }\n\n    condition:\n        any of them\n}",
      "pattern_type": "UNKNOWN",
      "confidence": 50,
      "opcodes": "",
      "task_id": "186",
      "status": "rule_hit",
      "rule_hit": true,
      "baseline_signatures": 7,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule hit but no new signatures",
      "improvement_suggestions": [
        "Adjust the skip offset to avoid invalid jumps. Target relative calls (E8) instead of absolute calls (FF 15) to align with the actual code flow."
      ],
      "debugger_log": "=== 7028.log ===\nCAPE Sandbox - Debugger log: Sun Dec 28 16:59:21 2025\nBreakpoint 0 hit by instruction at 0x001AD07A (thread 8924) EAX=0x1b3000 77d6f1914af6caf909fa2a24.exe EBX=0x1b9010 \"HAL9TH_DESKTOP-KJGI8L3_sanya\" 77d6f1914af6caf909fa2a24.exe ECX=0x1b9000 77d6f1914af6caf909fa2a24.exe EDX=0x1b9000 77d6f1914af6caf909fa2a24.exe ESI=0x1f0003 77d6f1914af6caf909fa2a24.exe ESP=0xaffb78 *ESP=0x1f0003 77d6f1914af6caf909fa2a24.exe EBP=0xaffbd8\nBreak at 0x001AD07A in 77d6f1914af6caf909fa2a24.exe (RVA 0xd07a, thread 8924, Stack 0x00AF2000-0x00B00000, ImageBase 0x001A0000)\n0x001AD07A  FF15DC353B00             CALL      DWORD [0x3b35dc]              \nActionDispatcher: skipping instruction.\n0x001AD080  3BC7                     CMP       EAX, EDI                      \nBreakpoint 0 hit by instruction at 0x001AD07A (thread 8924) EBX=0x1b9010 \"HAL9TH_DESKTOP-KJGI8L3_sanya\" 77d6f1914af6caf909fa2a24.exe ECX=0x966afd96 ESI=0x1f0003 77d6f1914af6caf909fa2a24.exe ESP=0xaffb6c *ESP=0x1f0003 77d6f1914af6caf909fa2a24.exe EBP=0xaffbd8\n0x001AD07A  FF15DC353B00             CALL      DWORD [0x3b35dc]              \nActionDispatcher: skipping instruction.\n0x001AD080  3BC7                     CMP       EAX, EDI                      \nBreakpoint 1 hit by instruction at 0x001AD088 (thread 8924) EBX=0x1b9010 \"HAL9TH_DESKTOP-KJGI8L3_sanya\" 77d6f1914af6caf909fa2a24.exe ECX=0x966afd96 ESI=0x1f0003 77d6f1914af6caf909fa2a24.exe ESP=0xaffb5c *ESP=0x0 EBP=0xaffbd8\n0x001AD088  FF1524373B00             CALL      DWORD [0x3b3724]              \nActionDispatcher: skipping instruction.\n0x001AD08E  8BF0                     MOV       ESI, EAX                      \n",
      "raw_response": "```yara\nrule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { FF 15 ?? ?? ?? ?? 3B C7 75 E1 }\n        $pattern1 = { FF 15 ?? ?? ?? ?? 8B F0 74 03 }\n        $pattern2 = { 74 03 75 01 FF 15 ?? ?? ?? ?? }\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\77d6f1914af6caf9\\iter1_v2.yar"
    },
    {
      "iteration": 2,
      "prompt_version": "v2",
      "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { E8 ?? ?? ?? ?? 74 03 }\n        $pattern1 = { E8 ?? ?? ?? ?? 75 01 }\n        $pattern2 = { E8 A9 01 00 00 50 74 03 }\n\n    condition:\n        any of them\n}",
      "pattern_type": "CALL_TEST_JE",
      "confidence": 75,
      "opcodes": "",
      "task_id": "187",
      "status": "bypass_crashed",
      "rule_hit": true,
      "baseline_signatures": 7,
      "new_signatures": 4,
      "new_signature_names": [
        "enumerates_running_processes",
        "dead_connect",
        "recon_programs",
        "http_request"
      ],
      "new_signature_details": [
        {
          "name": "dead_connect",
          "description": "Attempts to connect to a dead IP:Port (1 unique times)",
          "categories": [
            "network"
          ],
          "severity": 1,
          "weight": 0,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 4016,
              "cid": 881
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 922
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 962
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1319
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1349
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "http_request",
          "description": "Performs HTTP requests potentially not found in PCAP.",
          "categories": [
            "network"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 4016,
              "cid": 1353
            },
            {
              "url": "162.0.238.10:80//752e382b4dcf5e3f.php"
            },
            {
              "url": "162.0.238.10:80//752e382b4dcf5e3f.php"
            },
            {
              "url": "162.0.238.10:80//752e382b4dcf5e3f.php"
            },
            {
              "url": "162.0.238.10:80//752e382b4dcf5e3f.php"
            },
            {
              "url": "http://162.0.238.10/dbe4ef521ee4cc21/sqlite3.dll"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "enumerates_running_processes",
          "description": "Enumerates running processes",
          "categories": [
            "discovery"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "process": "System with pid 4"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1144
            },
            {
              "process": "Registry with pid 92"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1145
            },
            {
              "process": "smss.exe with pid 336"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1146
            },
            {
              "process": "csrss.exe with pid 448"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1147
            },
            {
              "process": "wininit.exe with pid 524"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1148
            },
            {
              "process": "csrss.exe with pid 536"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1149
            },
            {
              "process": "winlogon.exe with pid 616"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1150
            },
            {
              "process": "services.exe with pid 656"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1151
            },
            {
              "process": "lsass.exe with pid 680"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1152
            },
            {
              "process": "svchost.exe with pid 776"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1153
            },
            {
              "process": "fontdrvhost.exe with pid 808"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1154
            },
            {
              "process": "fontdrvhost.exe with pid 816"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1155
            },
            {
              "process": "svchost.exe with pid 896"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1156
            },
            {
              "process": "svchost.exe with pid 956"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1157
            },
            {
              "process": "dwm.exe with pid 320"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1158
            },
            {
              "process": "svchost.exe with pid 404"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1159
            },
            {
              "process": "svchost.exe with pid 540"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1160
            },
            {
              "process": "svchost.exe with pid 396"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1161
            },
            {
              "process": "svchost.exe with pid 800"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1162
            },
            {
              "process": "svchost.exe with pid 1056"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1163
            },
            {
              "process": "svchost.exe with pid 1100"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1164
            },
            {
              "process": "svchost.exe with pid 1108"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1165
            },
            {
              "process": "svchost.exe with pid 1140"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1166
            },
            {
              "process": "svchost.exe with pid 1164"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1167
            },
            {
              "process": "svchost.exe with pid 1196"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1168
            },
            {
              "process": "svchost.exe with pid 1264"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1169
            },
            {
              "process": "svchost.exe with pid 1360"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1170
            },
            {
              "process": "svchost.exe with pid 1432"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1171
            },
            {
              "process": "svchost.exe with pid 1444"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1172
            },
            {
              "process": "svchost.exe with pid 1464"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1173
            },
            {
              "process": "svchost.exe with pid 1528"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1174
            },
            {
              "process": "Memory Compression with pid 1572"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1175
            },
            {
              "process": "svchost.exe with pid 1588"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1176
            },
            {
              "process": "svchost.exe with pid 1632"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1177
            },
            {
              "process": "svchost.exe with pid 1640"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1178
            },
            {
              "process": "svchost.exe with pid 1676"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1179
            },
            {
              "process": "svchost.exe with pid 1780"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1180
            },
            {
              "process": "svchost.exe with pid 1884"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1181
            },
            {
              "process": "svchost.exe with pid 1892"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1182
            },
            {
              "process": "svchost.exe with pid 1924"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1183
            },
            {
              "process": "svchost.exe with pid 1944"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1184
            },
            {
              "process": "svchost.exe with pid 1960"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1185
            },
            {
              "process": "svchost.exe with pid 2020"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1186
            },
            {
              "process": "svchost.exe with pid 2032"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1187
            },
            {
              "process": "svchost.exe with pid 2044"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1188
            },
            {
              "process": "spoolsv.exe with pid 2236"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1189
            },
            {
              "process": "svchost.exe with pid 2336"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1190
            },
            {
              "process": "svchost.exe with pid 2396"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1191
            },
            {
              "process": "svchost.exe with pid 2404"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1192
            },
            {
              "process": "svchost.exe with pid 2460"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1193
            },
            {
              "process": "svchost.exe with pid 2468"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1194
            },
            {
              "process": "svchost.exe with pid 2480"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1195
            },
            {
              "process": "svchost.exe with pid 2496"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1196
            },
            {
              "process": "svchost.exe with pid 2616"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1197
            },
            {
              "process": "svchost.exe with pid 2648"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1198
            },
            {
              "process": "MsMpEng.exe with pid 2672"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1199
            },
            {
              "process": "svchost.exe with pid 2680"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1200
            },
            {
              "process": "svchost.exe with pid 2720"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1201
            },
            {
              "process": "svchost.exe with pid 760"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1202
            },
            {
              "process": "svchost.exe with pid 3088"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1203
            },
            {
              "process": "NisSrv.exe with pid 3380"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1204
            },
            {
              "process": "svchost.exe with pid 3568"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1205
            },
            {
              "process": "svchost.exe with pid 3608"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1206
            },
            {
              "process": "svchost.exe with pid 3640"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1207
            },
            {
              "process": "svchost.exe with pid 3648"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1208
            },
            {
              "process": "sihost.exe with pid 3784"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1209
            },
            {
              "process": "svchost.exe with pid 3820"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1210
            },
            {
              "process": "svchost.exe with pid 3868"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1211
            },
            {
              "process": "MicrosoftEdgeUpdate.exe with pid 3936"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1212
            },
            {
              "process": "taskhostw.exe with pid 3972"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1213
            },
            {
              "process": "svchost.exe with pid 1008"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1214
            },
            {
              "process": "pyw.exe with pid 3256"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1215
            },
            {
              "process": "ctfmon.exe with pid 3244"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1216
            },
            {
              "process": "svchost.exe with pid 3544"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1217
            },
            {
              "process": "explorer.exe with pid 3176"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1218
            },
            {
              "process": "SearchIndexer.exe with pid 4112"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1219
            },
            {
              "process": "svchost.exe with pid 4284"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1220
            },
            {
              "process": "svchost.exe with pid 4364"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1221
            },
            {
              "process": "svchost.exe with pid 4436"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1222
            },
            {
              "process": "StartMenuExperienceHost.exe with pid 4932"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1223
            },
            {
              "process": "RuntimeBroker.exe with pid 5092"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1224
            },
            {
              "process": "pythonw.exe with pid 5100"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1225
            },
            {
              "process": "SearchApp.exe with pid 4760"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1226
            },
            {
              "process": "RuntimeBroker.exe with pid 5240"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1227
            },
            {
              "process": "svchost.exe with pid 5300"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1228
            },
            {
              "process": "dllhost.exe with pid 5416"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1229
            },
            {
              "process": "SettingSyncHost.exe with pid 5684"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1230
            },
            {
              "process": "LockApp.exe with pid 5856"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1231
            },
            {
              "process": "RuntimeBroker.exe with pid 5932"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1232
            },
            {
              "process": "RuntimeBroker.exe with pid 6020"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1233
            },
            {
              "process": "svchost.exe with pid 6104"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1234
            },
            {
              "process": "smartscreen.exe with pid 6280"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1235
            },
            {
              "process": "SecurityHealthSystray.exe with pid 6328"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1236
            },
            {
              "process": "SecurityHealthService.exe with pid 6356"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1237
            },
            {
              "process": "msedge.exe with pid 6424"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1238
            },
            {
              "process": "OneDrive.exe with pid 6444"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1239
            },
            {
              "process": "msedge.exe with pid 6528"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1240
            },
            {
              "process": "TextInputHost.exe with pid 6592"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1241
            },
            {
              "process": "msedge.exe with pid 6800"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1242
            },
            {
              "process": "msedge.exe with pid 6808"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1243
            },
            {
              "process": "msedge.exe with pid 6824"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1244
            },
            {
              "process": "svchost.exe with pid 7060"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1245
            },
            {
              "process": "dllhost.exe with pid 5564"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1246
            },
            {
              "process": "svchost.exe with pid 552"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1247
            },
            {
              "process": "msedge.exe with pid 3232"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1248
            },
            {
              "process": "msedge.exe with pid 7332"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1249
            },
            {
              "process": "svchost.exe with pid 7492"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1250
            },
            {
              "process": "svchost.exe with pid 7564"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1251
            },
            {
              "process": "ApplicationFrameHost.exe with pid 8116"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1252
            },
            {
              "process": "WinStore.App.exe with pid 8140"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1253
            },
            {
              "process": "RuntimeBroker.exe with pid 7396"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1254
            },
            {
              "process": "svchost.exe with pid 828"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1255
            },
            {
              "process": "audiodg.exe with pid 3476"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1256
            },
            {
              "process": "SkypeApp.exe with pid 532"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1257
            },
            {
              "process": "RuntimeBroker.exe with pid 1352"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1258
            },
            {
              "process": "SkypeBackgroundHost.exe with pid 2748"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1259
            },
            {
              "process": "svchost.exe with pid 3796"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1260
            },
            {
              "process": "svchost.exe with pid 4040"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1261
            },
            {
              "process": "svchost.exe with pid 8072"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1262
            },
            {
              "process": "svchost.exe with pid 5272"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1263
            },
            {
              "process": "svchost.exe with pid 7624"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1264
            },
            {
              "process": "SgrmBroker.exe with pid 6292"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1265
            },
            {
              "process": "svchost.exe with pid 388"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1266
            },
            {
              "process": "MoUsoCoreWorker.exe with pid 8092"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1267
            },
            {
              "process": "svchost.exe with pid 1452"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1268
            },
            {
              "process": "svchost.exe with pid 2068"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1269
            },
            {
              "process": "TrustedInstaller.exe with pid 8240"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1270
            },
            {
              "process": "TiWorker.exe with pid 8320"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1271
            },
            {
              "process": "svchost.exe with pid 8508"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1272
            },
            {
              "process": "svchost.exe with pid 8516"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1273
            },
            {
              "process": "svchost.exe with pid 8568"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1274
            },
            {
              "process": "svchost.exe with pid 8636"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1275
            },
            {
              "process": "dasHost.exe with pid 8672"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1276
            },
            {
              "process": "upfc.exe with pid 972"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1277
            },
            {
              "process": "CompatTelRunner.exe with pid 8928"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1278
            },
            {
              "process": "OneDriveStandaloneUpdater.exe with pid 4944"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1279
            },
            {
              "process": "OneDriveStandaloneUpdater.exe with pid 9056"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1280
            },
            {
              "process": "svchost.exe with pid 5476"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1281
            },
            {
              "process": "conhost.exe with pid 4264"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1282
            },
            {
              "process": "svchost.exe with pid 9196"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1283
            },
            {
              "process": "77d6f1914af6caf909fa2a24.exe with pid 4016"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1284
            },
            {
              "process": "ShellExperienceHost.exe with pid 8412"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1285
            },
            {
              "process": "RuntimeBroker.exe with pid 9204"
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1286
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "recon_programs",
          "description": "Collects information about installed applications",
          "categories": [
            "discovery"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 20,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 4016,
              "cid": 1049
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1074
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1079
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1084
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1089
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1094
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1099
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1104
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1109
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1114
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1119
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1124
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1132
            },
            {
              "type": "call",
              "pid": 4016,
              "cid": 1137
            },
            {
              "Program": "Python 3.11.5 pip Bootstrap"
            },
            {
              "Program": "Python 3.11.5 Development Libraries"
            },
            {
              "Program": "Python 3.11.5 Documentation"
            },
            {
              "Program": "Python 3.11.5 Standard Library"
            },
            {
              "Program": "Python Launcher"
            },
            {
              "Program": "Python 3.11.5 Executables"
            },
            {
              "Program": "Microsoft Edge"
            },
            {
              "Program": "Python 3.11.5 Add to Path"
            },
            {
              "Program": "Python 3.11.5"
            },
            {
              "Program": "Python 3.11.5 Utility Scripts"
            },
            {
              "Program": "Python 3.11.5 Tcl/Tk Support"
            },
            {
              "Program": "Python 3.11.5 Test Suite"
            },
            {
              "Program": "Python 3.11.5 Core Interpreter"
            },
            {
              "Program": "Microsoft OneDrive"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        }
      ],
      "failure_reason": "Rule caused crash: ['exec_crash']",
      "improvement_suggestions": [],
      "debugger_log": "=== 4016.log ===\nCAPE Sandbox - Debugger log: Sun Dec 28 16:22:47 2025\nBreakpoint 0 hit by instruction at 0x00CAD095 (thread 5492) EAX=0x228 EBX=0xcb9010 \"HAL9TH_DESKTOP-KJGI8L3_sanya\" 77d6f1914af6caf909fa2a24.exe ECX=0xf30000 EDX=0xf30000 ESI=0x228 ESP=0xb3fb6c *ESP=0xcacf89 77d6f1914af6caf909fa2a24.exe EBP=0xb3fbc0\nBreak at 0x00CAD095 in 77d6f1914af6caf909fa2a24.exe (RVA 0xd095, thread 5492, Stack 0x00B32000-0x00B40000, ImageBase 0x00CA0000)\n0x00CAD095  E830FEFFFF               CALL      0xfffffe35                    \nActionDispatcher: skipping instruction.\n0x00CAD09A  7403                     JZ        0x5                           \n",
      "raw_response": "**EVOLUTION_REASONING**: The previous attempts failed due to incorrect pattern matching. By focusing on relative calls (E8) and conditional jumps (JZ/JNZ) in the early trace, we target evasion checks. The patterns are derived directly from the trace, ensuring specificity while allowing flexibility for variants.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 75\n\n**REASONING**: These patterns capture the core evasion logic in the trace: relative calls (E8) followed by conditional jumps (JZ/JNZ) that likely check for evasion. Using concrete bytes from the trace ensures precision while wildcards allow for variant tolerance. The three distinct patterns cover different jump offsets and instruction sequences, increasing the likelihood of matching the target.\n\n**YARA_RULE**:\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { E8 ?? ?? ?? ?? 74 03 }\n        $pattern1 = { E8 ?? ?? ?? ?? 75 01 }\n        $pattern2 = { E8 A9 01 00 00 50 74 03 }\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\77d6f1914af6caf9\\iter2_v2.yar"
    }
  ],
  "best_attempt": {
    "iteration": 2,
    "prompt_version": "v2",
    "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { E8 ?? ?? ?? ?? 74 03 }\n        $pattern1 = { E8 ?? ?? ?? ?? 75 01 }\n        $pattern2 = { E8 A9 01 00 00 50 74 03 }\n\n    condition:\n        any of them\n}",
    "pattern_type": "CALL_TEST_JE",
    "confidence": 75,
    "opcodes": "",
    "task_id": "187",
    "status": "bypass_crashed",
    "rule_hit": true,
    "baseline_signatures": 7,
    "new_signatures": 4,
    "new_signature_names": [
      "enumerates_running_processes",
      "dead_connect",
      "recon_programs",
      "http_request"
    ],
    "new_signature_details": [
      {
        "name": "dead_connect",
        "description": "Attempts to connect to a dead IP:Port (1 unique times)",
        "categories": [
          "network"
        ],
        "severity": 1,
        "weight": 0,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 4016,
            "cid": 881
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 922
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 962
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1319
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1349
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "http_request",
        "description": "Performs HTTP requests potentially not found in PCAP.",
        "categories": [
          "network"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 4016,
            "cid": 1353
          },
          {
            "url": "162.0.238.10:80//752e382b4dcf5e3f.php"
          },
          {
            "url": "162.0.238.10:80//752e382b4dcf5e3f.php"
          },
          {
            "url": "162.0.238.10:80//752e382b4dcf5e3f.php"
          },
          {
            "url": "162.0.238.10:80//752e382b4dcf5e3f.php"
          },
          {
            "url": "http://162.0.238.10/dbe4ef521ee4cc21/sqlite3.dll"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "enumerates_running_processes",
        "description": "Enumerates running processes",
        "categories": [
          "discovery"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "process": "System with pid 4"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1144
          },
          {
            "process": "Registry with pid 92"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1145
          },
          {
            "process": "smss.exe with pid 336"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1146
          },
          {
            "process": "csrss.exe with pid 448"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1147
          },
          {
            "process": "wininit.exe with pid 524"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1148
          },
          {
            "process": "csrss.exe with pid 536"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1149
          },
          {
            "process": "winlogon.exe with pid 616"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1150
          },
          {
            "process": "services.exe with pid 656"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1151
          },
          {
            "process": "lsass.exe with pid 680"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1152
          },
          {
            "process": "svchost.exe with pid 776"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1153
          },
          {
            "process": "fontdrvhost.exe with pid 808"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1154
          },
          {
            "process": "fontdrvhost.exe with pid 816"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1155
          },
          {
            "process": "svchost.exe with pid 896"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1156
          },
          {
            "process": "svchost.exe with pid 956"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1157
          },
          {
            "process": "dwm.exe with pid 320"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1158
          },
          {
            "process": "svchost.exe with pid 404"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1159
          },
          {
            "process": "svchost.exe with pid 540"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1160
          },
          {
            "process": "svchost.exe with pid 396"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1161
          },
          {
            "process": "svchost.exe with pid 800"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1162
          },
          {
            "process": "svchost.exe with pid 1056"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1163
          },
          {
            "process": "svchost.exe with pid 1100"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1164
          },
          {
            "process": "svchost.exe with pid 1108"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1165
          },
          {
            "process": "svchost.exe with pid 1140"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1166
          },
          {
            "process": "svchost.exe with pid 1164"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1167
          },
          {
            "process": "svchost.exe with pid 1196"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1168
          },
          {
            "process": "svchost.exe with pid 1264"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1169
          },
          {
            "process": "svchost.exe with pid 1360"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1170
          },
          {
            "process": "svchost.exe with pid 1432"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1171
          },
          {
            "process": "svchost.exe with pid 1444"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1172
          },
          {
            "process": "svchost.exe with pid 1464"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1173
          },
          {
            "process": "svchost.exe with pid 1528"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1174
          },
          {
            "process": "Memory Compression with pid 1572"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1175
          },
          {
            "process": "svchost.exe with pid 1588"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1176
          },
          {
            "process": "svchost.exe with pid 1632"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1177
          },
          {
            "process": "svchost.exe with pid 1640"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1178
          },
          {
            "process": "svchost.exe with pid 1676"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1179
          },
          {
            "process": "svchost.exe with pid 1780"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1180
          },
          {
            "process": "svchost.exe with pid 1884"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1181
          },
          {
            "process": "svchost.exe with pid 1892"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1182
          },
          {
            "process": "svchost.exe with pid 1924"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1183
          },
          {
            "process": "svchost.exe with pid 1944"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1184
          },
          {
            "process": "svchost.exe with pid 1960"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1185
          },
          {
            "process": "svchost.exe with pid 2020"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1186
          },
          {
            "process": "svchost.exe with pid 2032"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1187
          },
          {
            "process": "svchost.exe with pid 2044"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1188
          },
          {
            "process": "spoolsv.exe with pid 2236"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1189
          },
          {
            "process": "svchost.exe with pid 2336"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1190
          },
          {
            "process": "svchost.exe with pid 2396"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1191
          },
          {
            "process": "svchost.exe with pid 2404"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1192
          },
          {
            "process": "svchost.exe with pid 2460"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1193
          },
          {
            "process": "svchost.exe with pid 2468"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1194
          },
          {
            "process": "svchost.exe with pid 2480"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1195
          },
          {
            "process": "svchost.exe with pid 2496"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1196
          },
          {
            "process": "svchost.exe with pid 2616"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1197
          },
          {
            "process": "svchost.exe with pid 2648"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1198
          },
          {
            "process": "MsMpEng.exe with pid 2672"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1199
          },
          {
            "process": "svchost.exe with pid 2680"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1200
          },
          {
            "process": "svchost.exe with pid 2720"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1201
          },
          {
            "process": "svchost.exe with pid 760"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1202
          },
          {
            "process": "svchost.exe with pid 3088"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1203
          },
          {
            "process": "NisSrv.exe with pid 3380"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1204
          },
          {
            "process": "svchost.exe with pid 3568"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1205
          },
          {
            "process": "svchost.exe with pid 3608"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1206
          },
          {
            "process": "svchost.exe with pid 3640"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1207
          },
          {
            "process": "svchost.exe with pid 3648"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1208
          },
          {
            "process": "sihost.exe with pid 3784"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1209
          },
          {
            "process": "svchost.exe with pid 3820"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1210
          },
          {
            "process": "svchost.exe with pid 3868"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1211
          },
          {
            "process": "MicrosoftEdgeUpdate.exe with pid 3936"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1212
          },
          {
            "process": "taskhostw.exe with pid 3972"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1213
          },
          {
            "process": "svchost.exe with pid 1008"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1214
          },
          {
            "process": "pyw.exe with pid 3256"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1215
          },
          {
            "process": "ctfmon.exe with pid 3244"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1216
          },
          {
            "process": "svchost.exe with pid 3544"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1217
          },
          {
            "process": "explorer.exe with pid 3176"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1218
          },
          {
            "process": "SearchIndexer.exe with pid 4112"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1219
          },
          {
            "process": "svchost.exe with pid 4284"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1220
          },
          {
            "process": "svchost.exe with pid 4364"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1221
          },
          {
            "process": "svchost.exe with pid 4436"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1222
          },
          {
            "process": "StartMenuExperienceHost.exe with pid 4932"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1223
          },
          {
            "process": "RuntimeBroker.exe with pid 5092"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1224
          },
          {
            "process": "pythonw.exe with pid 5100"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1225
          },
          {
            "process": "SearchApp.exe with pid 4760"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1226
          },
          {
            "process": "RuntimeBroker.exe with pid 5240"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1227
          },
          {
            "process": "svchost.exe with pid 5300"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1228
          },
          {
            "process": "dllhost.exe with pid 5416"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1229
          },
          {
            "process": "SettingSyncHost.exe with pid 5684"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1230
          },
          {
            "process": "LockApp.exe with pid 5856"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1231
          },
          {
            "process": "RuntimeBroker.exe with pid 5932"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1232
          },
          {
            "process": "RuntimeBroker.exe with pid 6020"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1233
          },
          {
            "process": "svchost.exe with pid 6104"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1234
          },
          {
            "process": "smartscreen.exe with pid 6280"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1235
          },
          {
            "process": "SecurityHealthSystray.exe with pid 6328"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1236
          },
          {
            "process": "SecurityHealthService.exe with pid 6356"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1237
          },
          {
            "process": "msedge.exe with pid 6424"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1238
          },
          {
            "process": "OneDrive.exe with pid 6444"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1239
          },
          {
            "process": "msedge.exe with pid 6528"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1240
          },
          {
            "process": "TextInputHost.exe with pid 6592"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1241
          },
          {
            "process": "msedge.exe with pid 6800"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1242
          },
          {
            "process": "msedge.exe with pid 6808"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1243
          },
          {
            "process": "msedge.exe with pid 6824"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1244
          },
          {
            "process": "svchost.exe with pid 7060"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1245
          },
          {
            "process": "dllhost.exe with pid 5564"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1246
          },
          {
            "process": "svchost.exe with pid 552"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1247
          },
          {
            "process": "msedge.exe with pid 3232"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1248
          },
          {
            "process": "msedge.exe with pid 7332"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1249
          },
          {
            "process": "svchost.exe with pid 7492"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1250
          },
          {
            "process": "svchost.exe with pid 7564"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1251
          },
          {
            "process": "ApplicationFrameHost.exe with pid 8116"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1252
          },
          {
            "process": "WinStore.App.exe with pid 8140"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1253
          },
          {
            "process": "RuntimeBroker.exe with pid 7396"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1254
          },
          {
            "process": "svchost.exe with pid 828"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1255
          },
          {
            "process": "audiodg.exe with pid 3476"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1256
          },
          {
            "process": "SkypeApp.exe with pid 532"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1257
          },
          {
            "process": "RuntimeBroker.exe with pid 1352"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1258
          },
          {
            "process": "SkypeBackgroundHost.exe with pid 2748"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1259
          },
          {
            "process": "svchost.exe with pid 3796"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1260
          },
          {
            "process": "svchost.exe with pid 4040"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1261
          },
          {
            "process": "svchost.exe with pid 8072"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1262
          },
          {
            "process": "svchost.exe with pid 5272"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1263
          },
          {
            "process": "svchost.exe with pid 7624"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1264
          },
          {
            "process": "SgrmBroker.exe with pid 6292"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1265
          },
          {
            "process": "svchost.exe with pid 388"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1266
          },
          {
            "process": "MoUsoCoreWorker.exe with pid 8092"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1267
          },
          {
            "process": "svchost.exe with pid 1452"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1268
          },
          {
            "process": "svchost.exe with pid 2068"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1269
          },
          {
            "process": "TrustedInstaller.exe with pid 8240"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1270
          },
          {
            "process": "TiWorker.exe with pid 8320"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1271
          },
          {
            "process": "svchost.exe with pid 8508"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1272
          },
          {
            "process": "svchost.exe with pid 8516"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1273
          },
          {
            "process": "svchost.exe with pid 8568"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1274
          },
          {
            "process": "svchost.exe with pid 8636"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1275
          },
          {
            "process": "dasHost.exe with pid 8672"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1276
          },
          {
            "process": "upfc.exe with pid 972"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1277
          },
          {
            "process": "CompatTelRunner.exe with pid 8928"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1278
          },
          {
            "process": "OneDriveStandaloneUpdater.exe with pid 4944"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1279
          },
          {
            "process": "OneDriveStandaloneUpdater.exe with pid 9056"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1280
          },
          {
            "process": "svchost.exe with pid 5476"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1281
          },
          {
            "process": "conhost.exe with pid 4264"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1282
          },
          {
            "process": "svchost.exe with pid 9196"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1283
          },
          {
            "process": "77d6f1914af6caf909fa2a24.exe with pid 4016"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1284
          },
          {
            "process": "ShellExperienceHost.exe with pid 8412"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1285
          },
          {
            "process": "RuntimeBroker.exe with pid 9204"
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1286
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "recon_programs",
        "description": "Collects information about installed applications",
        "categories": [
          "discovery"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 20,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 4016,
            "cid": 1049
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1074
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1079
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1084
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1089
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1094
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1099
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1104
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1109
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1114
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1119
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1124
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1132
          },
          {
            "type": "call",
            "pid": 4016,
            "cid": 1137
          },
          {
            "Program": "Python 3.11.5 pip Bootstrap"
          },
          {
            "Program": "Python 3.11.5 Development Libraries"
          },
          {
            "Program": "Python 3.11.5 Documentation"
          },
          {
            "Program": "Python 3.11.5 Standard Library"
          },
          {
            "Program": "Python Launcher"
          },
          {
            "Program": "Python 3.11.5 Executables"
          },
          {
            "Program": "Microsoft Edge"
          },
          {
            "Program": "Python 3.11.5 Add to Path"
          },
          {
            "Program": "Python 3.11.5"
          },
          {
            "Program": "Python 3.11.5 Utility Scripts"
          },
          {
            "Program": "Python 3.11.5 Tcl/Tk Support"
          },
          {
            "Program": "Python 3.11.5 Test Suite"
          },
          {
            "Program": "Python 3.11.5 Core Interpreter"
          },
          {
            "Program": "Microsoft OneDrive"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      }
    ],
    "failure_reason": "Rule caused crash: ['exec_crash']",
    "improvement_suggestions": [],
    "debugger_log": "=== 4016.log ===\nCAPE Sandbox - Debugger log: Sun Dec 28 16:22:47 2025\nBreakpoint 0 hit by instruction at 0x00CAD095 (thread 5492) EAX=0x228 EBX=0xcb9010 \"HAL9TH_DESKTOP-KJGI8L3_sanya\" 77d6f1914af6caf909fa2a24.exe ECX=0xf30000 EDX=0xf30000 ESI=0x228 ESP=0xb3fb6c *ESP=0xcacf89 77d6f1914af6caf909fa2a24.exe EBP=0xb3fbc0\nBreak at 0x00CAD095 in 77d6f1914af6caf909fa2a24.exe (RVA 0xd095, thread 5492, Stack 0x00B32000-0x00B40000, ImageBase 0x00CA0000)\n0x00CAD095  E830FEFFFF               CALL      0xfffffe35                    \nActionDispatcher: skipping instruction.\n0x00CAD09A  7403                     JZ        0x5                           \n",
    "raw_response": "**EVOLUTION_REASONING**: The previous attempts failed due to incorrect pattern matching. By focusing on relative calls (E8) and conditional jumps (JZ/JNZ) in the early trace, we target evasion checks. The patterns are derived directly from the trace, ensuring specificity while allowing flexibility for variants.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 75\n\n**REASONING**: These patterns capture the core evasion logic in the trace: relative calls (E8) followed by conditional jumps (JZ/JNZ) that likely check for evasion. Using concrete bytes from the trace ensures precision while wildcards allow for variant tolerance. The three distinct patterns cover different jump offsets and instruction sequences, increasing the likelihood of matching the target.\n\n**YARA_RULE**:\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { E8 ?? ?? ?? ?? 74 03 }\n        $pattern1 = { E8 ?? ?? ?? ?? 75 01 }\n        $pattern2 = { E8 A9 01 00 00 50 74 03 }\n\n    condition:\n        any of them\n}\n```",
    "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\77d6f1914af6caf9\\iter2_v2.yar"
  },
  "best_score": 4,
  "optimization_history": [
    "Iteration 1: rule_hit - Rule hit but no new signatures",
    "Iteration 2: rule_hit - Rule hit but no new signatures",
    "Iteration 3: SUCCESS - 4 new signatures"
  ],
  "successful_patterns": [
    ""
  ],
  "failed_patterns": [
    "",
    ""
  ]
}