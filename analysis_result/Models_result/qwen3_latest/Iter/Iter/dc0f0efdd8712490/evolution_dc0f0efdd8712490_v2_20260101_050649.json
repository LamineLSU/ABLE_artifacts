{
  "sha256": "dc0f0efdd8712490c0933700fe4ac72747dad123c41c574305e4f9e04f230010",
  "prompt_version": "v2",
  "iterations": [
    {
      "iteration": 0,
      "prompt_version": "v2",
      "yara_rule": "rule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 53 FF 15 ?? ?? ?? ?? }\n        $pattern1 = { FF 75 08 FF 15 ?? ?? ?? ?? }\n        $pattern2 = { E8 ?? ?? ?? ?? FF 15 ?? ?? ?? ?? }\n\n    condition:\n        any of them\n}",
      "pattern_type": "UNKNOWN",
      "confidence": 50,
      "opcodes": "",
      "task_id": "420",
      "status": "rule_hit",
      "rule_hit": true,
      "baseline_signatures": 40,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule hit but no new signatures",
      "improvement_suggestions": [
        "Refine the patterns to target specific opcodes with precise wildcards and adjust skip offsets to avoid invalid jumps."
      ],
      "debugger_log": "=== 6180.log ===\nCAPE Sandbox - Debugger log: Thu Jan  1 17:29:06 2026\nBreakpoint 0 hit by instruction at 0x0040C361 (thread 6064) EAX=0x9d7cfd6 ECX=0x19f8d0 ESI=0x19f8d0 EDI=0x1 ESP=0x19f874 *ESP=0x100 EBP=0x19f8a8\nBreak at 0x0040C361 in ahHl.exe (RVA 0xc361, thread 6064, Stack 0x00192000-0x001A0000, ImageBase 0x00400000)\n0x0040C361  53                       PUSH      EBX                           \nActionDispatcher: skipping instruction.\n0x0040C362  FF156C104000             CALL      LCMapStringW                  \nBreakpoint 1 hit by instruction at 0x0040C695 (thread 6064) EAX=0x4e4 EDX=0x5 ESI=0x19f8d0 EDI=0x1 ESP=0x19f878 *ESP=0x100 EBP=0x19f8a8\n0x0040C695  FF7508                   PUSH      DWORD [EBP+0x8]               \nActionDispatcher: skipping instruction.\n0x0040C698  FF153C114000             CALL      LCMapStringA                  \nBreakpoint 0 hit by instruction at 0x0040C361 (thread 6064) EAX=0x9d7cfb6 ECX=0x19f8f0 ESI=0x19f8f0 EDI=0x1 ESP=0x19f894 *ESP=0x100 EBP=0x19f8c8\n0x0040C361  53                       PUSH      EBX                           \nActionDispatcher: skipping instruction.\n0x0040C362  FF156C104000             CALL      LCMapStringW                  \nBreakpoint 1 hit by instruction at 0x0040C695 (thread 6064) EAX=0x4e4 EDX=0x5 ESI=0x19f8f0 EDI=0x1 ESP=0x19f898 *ESP=0x200 EBP=0x19f8c8\n0x0040C695  FF7508                   PUSH      DWORD [EBP+0x8]               \nActionDispatcher: skipping instruction.\n0x0040C698  FF153C114000             CALL      LCMapStringA                  \n",
      "raw_response": "```yara\nrule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 53 FF 15 ?? ?? ?? ?? }\n        $pattern1 = { FF 75 08 FF 15 ?? ?? ?? ?? }\n        $pattern2 = { E8 ?? ?? ?? ?? FF 15 ?? ?? ?? ?? }\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\dc0f0efdd8712490\\iter0_v2.yar"
    },
    {
      "iteration": 1,
      "prompt_version": "v2",
      "yara_rule": "rule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 0F 84 ?? ?? ?? ?? FF 15 ?? ?? ?? ?? }\n        $pattern1 = { 55 8B EC FF 75 08 E8 ?? ?? ?? ?? }\n        $pattern2 = { FF 75 08 FF 15 ?? ?? ?? ?? }\n\n    condition:\n        any of them\n}",
      "pattern_type": "UNKNOWN",
      "confidence": 50,
      "opcodes": "",
      "task_id": "421",
      "status": "bypass_crashed",
      "rule_hit": true,
      "baseline_signatures": 40,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule caused crash: ['exec_crash']",
      "improvement_suggestions": [
        "Replace the generic pattern with a more specific one targeting non-critical instructions from the original trace (e.g., the `CALL 0120667Fh` in TRACE #1) and add context bytes to ensure specificity."
      ],
      "debugger_log": "=== 3032.log ===\nCAPE Sandbox - Debugger log: Thu Jan  1 15:58:01 2026\nBreakpoint 2 hit by instruction at 0x00DF2382 (thread 8796) EAX=0x80 EBX=0xf1f608 ESI=0xf1f50c EDI=0xf1f4d0 \"H?\" ESP=0xf1f490 *ESP=0x80000000 EBP=0xf1f4a8\nBreak at 0x00DF2382 in xriv.exe (RVA 0x22382, thread 8796, Stack 0x00F12000-0x00F20000, ImageBase 0x00DD0000)\n0x00DF2382  FF7508                   PUSH      DWORD [EBP+0x8]               \nActionDispatcher: skipping instruction.\n0x00DF2385  FF1594E1DF00             CALL      0x6B798030                    \n\n\n=== 5156.log ===\nCAPE Sandbox - Debugger log: Thu Jan  1 15:57:41 2026\nBreakpoint 1 hit by instruction at 0x00407B67 (thread 2632) EBX=0x1 ECX=0x40116c ahHl.exe EDX=0xc00065b8 EDI=0xfffffffe ESP=0x19fee4 \"5N@\" *ESP=0x404e35 ahHl.exe EBP=0x19feec\nBreak at 0x00407B67 in ahHl.exe (RVA 0x7b67, thread 2632, Stack 0x00193000-0x001A0000, ImageBase 0x00400000)\n0x00407B67  55                       PUSH      EBP                           \nActionDispatcher: skipping instruction.\n0x00407B68  8BEC                     MOV       EBP, ESP                      \n",
      "raw_response": "```yara\nrule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85C0 7412 0F84 ?? ?? ?? ?? FF15 ?? ?? ?? ?? }\n        $pattern1 = { 55 8BEC FF7508 E8 ?? ?? ?? ?? }\n        $pattern2 = { FF7508 FF15 ?? ?? ?? ?? }\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\dc0f0efdd8712490\\iter1_v2.yar"
    },
    {
      "iteration": 2,
      "prompt_version": "v2",
      "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { E8 ?? ?? ?? ?? 85 C0 0F 84 ?? ?? ?? ?? }\n        $pattern1 = { 6A 5B 5A 8B CE E8 ?? ?? ?? ?? }\n        $pattern2 = { 8D 95 F0 FE FF FF 89 9D F0 FE FF FF }\n\n    condition:\n        any of them\n}",
      "pattern_type": "CALL_TEST_JE",
      "confidence": 75,
      "opcodes": "",
      "task_id": "422",
      "status": "bypass_crashed",
      "rule_hit": true,
      "baseline_signatures": 40,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule caused crash: ['exec_crash']",
      "improvement_suggestions": [
        "Refine the pattern to target specific instructions from the original trace (e.g., `01206183` or `01206188`) instead of generic sequences."
      ],
      "debugger_log": "=== 3924.log ===\nCAPE Sandbox - Debugger log: Thu Jan  1 16:02:47 2026\nBreakpoint 0 hit by instruction at 0x00007FFA7FB4C286 (thread 8936) RBX=0x49f1c18 RCX=0x49f1df0 RDX=0x49ee378 RSI=0x49f1928 RDI=0x49f1a80 RSP=0x10fda10 *RSP=0x49f1df0 RBP=0x6c R8=0x5 R9=0x49f1bc4 R10=0x42 R11=0x42 R12=0x4921450 R13=0x10fe250 R14=0x21 R15=0x49f1a20 Xmm0.Low=0x49f1c18 Xmm1.Low=0x49f1df0\n0x00007FFA7FB4C286  E8CD84FCFF               CALL      0xfffffffffffc84d2            \nActionDispatcher: skipping instruction.\n0x00007FFA7FB4C28B  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x00007FFA7FB4C286 (thread 8936) RBX=0x49f2508 RCX=0x49f26e0 RDX=0x49ee378 RSI=0x49f2278 RDI=0x49f2370 RSP=0x10fd960 *RSP=0x49f26e0 RBP=0x6c R8=0x5 R9=0x49f24b4 R10=0x42 R11=0x42 R12=0x4921450 R13=0x10fe250 R14=0x21 R15=0x49f1a20 Xmm0.Low=0x49f2508 Xmm1.Low=0x49f26e0\n0x00007FFA7FB4C286  E8CD84FCFF               CALL      0xfffffffffffc84d2            \nActionDispatcher: skipping instruction.\n0x00007FFA7FB4C28B  85C0                     TEST      EAX, EAX                      \n\n\n=== 3968.log ===\nCAPE Sandbox - Debugger log: Thu Jan  1 16:01:47 2026\nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x41f5300 ECX=0x41f5300 EDX=0x41f5300 ESI=0x41f559c EDI=0x41f5300 ESP=0x19e424 *ESP=0x4068cf0 \"R\u0011\" EBP=0x19e43c\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x41f5300 ECX=0x41f55d4 EDX=0x41f55d4 ESI=0x41f559c EDI=0x41f5300 ESP=0x19e424 *ESP=0x4068cf0 \"R\u0011\" EBP=0x19e43c\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x19d7b0 ECX=0x4207ba8 EDX=0x4207ba8 ESI=0x6e892a0 EDI=0x4207ba8 ESP=0x19d694 *ESP=0x6ab9f4eb \"ZY_^[]\" clr.dll EBP=0x19d6ac\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x77352eb0 FindResourceA  ECX=0x420d148 EDX=0x420d148 ESI=0x420d148 EDI=0x77352eb0 FindResourceA  ESP=0x19cf44 *ESP=0x19cf4c EBP=0x19cf5c\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x77360630 OpenProcess  ECX=0x4281bc4 EDX=0x4281bc4 ESI=0x4281bc4 EDI=0x77360630 OpenProcess  ESP=0x19cf44 *ESP=0x19cee8 EBP=0x19cf5c\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x773604c0 VirtualProtect  ECX=0x4281ca4 EDX=0x4281ca4 ESI=0x4281ca4 EDI=0x773604c0 VirtualProtect  ESP=0x19cf4c *ESP=0x19cef0 EBP=0x19cf64\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) ECX=0x4281d54 EDX=0x4281d54 ESI=0x4281d54 EDI=0x77362ee0 CloseHandle  ESP=0x19cf50 *ESP=0x19cef4 EBP=0x19cf68\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430bd38 ESP=0x19dd38 *ESP=0x40690dc EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430bd38 ESP=0x19dd28 *ESP=0x19de40 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430bd38 ESP=0x19dcfc *ESP=0xb7 EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430c1a4 ESP=0x19dd38 *ESP=0x4281eb0 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430c1a4 ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430c1a4 ESP=0x19dcfc *ESP=0x3db0078 EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430c3e8 ESP=0x19dd38 \"t\u001f(\" *ESP=0x4281f74 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430c3e8 ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430c3e8 ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430c62c ESP=0x19dd38 *ESP=0x4281fb4 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430c62c ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430c62c ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430c870 ESP=0x19dd38 *ESP=0x4281fec EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430c870 ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430c870 ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430cac0 ESP=0x19dd38 *ESP=0x0 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430cac0 ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430cac0 ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430cd04 ESP=0x19dd38 \"l (\" *ESP=0x428206c EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430cd04 ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430cd04 ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430d110 ESP=0x19dd38 *ESP=0x0 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430d110 ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430d110 ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430d434 ESP=0x19dd38 *ESP=0x0 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430d434 ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430d434 ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430d628 ESP=0x19dd38 *ESP=0x4282288 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430d628 ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430d628 ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430d81c ESP=0x19dd38 *ESP=0x42822c4 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430d81c ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430d81c ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430da10 ESP=0x19dd38 *ESP=0x42822ec EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430da10 ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430da10 ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430dc04 ESP=0x19dd38 \"4#(\" *ESP=0x4282334 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430dc04 ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430dc04 ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430dde8 ESP=0x19dd38 *ESP=0x42823c8 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430dde8 ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430dde8 ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430dfcc ESP=0x19dd38 \"0$(\" *ESP=0x4282430 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430dfcc ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x430dfcc ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x431219c ESP=0x19dd38 *ESP=0x4282480 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x431219c ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x431219c ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x43126b4 ESP=0x19dd38 *ESP=0x42824a0 EBP=0x19dd50\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x43126b4 ESP=0x19dd28 *ESP=0x4066fb0 EBP=0x19dd40\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \nBreakpoint 0 hit by instruction at 0x06E7754E (thread 4128) EBX=0x430bd44 ECX=0x430bd44 EDX=0x430bd44 ESI=0x430bd44 EDI=0x43126b4 ESP=0x19dcfc *ESP=0x796ad0 \"TL\" EBP=0x19dd14\n0x06E7754E  E80D59D463               CALL      0x63d45912                    \nActionDispatcher: skipping instruction.\n0x06E77553  85C0                     TEST      EAX, EAX                      \n\n\n=== 5060.log ===\nCAPE Sandbox - Debugger log: Thu Jan  1 16:03:05 2026\nBreakpoint 0 hit by instruction at 0x00363E53 (thread 8100) EAX=0x2d0e84c ECX=0x4aa11fc L\"sanya:N\" EDX=0x2d0e850 ESI=0x4aa11fc L\"sanya:N\" EDI=0x3 ESP=0x2d0e82c *ESP=0x2d0e84c EBP=0x2d0f8c4\nBreak at 0x00363E53 in cacls.exe (RVA 0x3e53, thread 8100, Stack 0x02D01000-0x02D10000, ImageBase 0x00360000)\n0x00363E53  E8D2060000               CALL      0x6d7                         \nActionDispatcher: skipping instruction.\n0x00363E58  85C0                     TEST      EAX, EAX                      \n",
      "raw_response": "**EVOLUTION_REASONING**: The previous rule caused a crash due to overly generic patterns. By focusing on specific non-critical instructions from the trace (e.g., CALLs followed by TEST/JE sequences and memory setup operations), we can increase specificity while avoiding crash-inducing overlaps. The three patterns are derived from distinct sections of the trace to balance specificity and variant tolerance.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 75\n\n**REASONING**: These patterns target critical evasion logic (CALL+TEST+JE) and memory setup (LEA+MOV) without overlapping with the exit call itself. The use of concrete bytes from the trace ensures specificity while wildcards allow for variant tolerance. This reduces false positives and avoids crash-inducing matches.\n\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { E8 ?? ?? ?? ?? 85 C0 0F 84 ?? ?? ?? ?? }\n        $pattern1 = { 6A 5B 5A 8B CE E8 ?? ?? ?? ?? }\n        $pattern2 = { 8D 95 F0 FE FF FF 89 9D F0 FE FF FF }\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\dc0f0efdd8712490\\iter2_v2.yar"
    }
  ],
  "best_attempt": null,
  "best_score": 0,
  "optimization_history": [
    "Iteration 1: rule_hit - Rule hit but no new signatures",
    "Iteration 2: bypass_crashed - Rule caused crash: ['exec_crash']",
    "Iteration 3: bypass_crashed - Rule caused crash: ['exec_crash']"
  ],
  "successful_patterns": [],
  "failed_patterns": [
    "",
    "",
    ""
  ]
}