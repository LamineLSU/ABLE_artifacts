{
  "sha256": "71e499ce826b286a667466a0f33ad9ae2b5598a853c759a7357014e6365bd223",
  "prompt_version": "v2",
  "iterations": [
    {
      "iteration": 0,
      "prompt_version": "v2",
      "yara_rule": "rule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 53 FF 15 ?? ?? ?? ?? }\n        $pattern1 = { E8 ?? ?? ?? ?? 8B 45 ?? }\n        $pattern2 = { 85 C0 0F 84 ?? ?? ?? ?? }\n\n    condition:\n        any of them\n}",
      "pattern_type": "UNKNOWN",
      "confidence": 50,
      "opcodes": "",
      "task_id": "1720",
      "status": "rule_hit",
      "rule_hit": true,
      "baseline_signatures": 15,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule hit but no new signatures",
      "improvement_suggestions": [
        "Replace the `skip` action with a `break` or adjust the skip offset to avoid invalid jumps. Prioritize patterns that do not disrupt control flow (e.g., non-conditional branches)."
      ],
      "debugger_log": "=== 6040.log ===\nCAPE Sandbox - Debugger log: Mon Dec 15 23:32:24 2025\nBreakpoint 2 hit by instruction at 0x00007FFA7FA8483E (thread 4028) RBX=0x46f13a8 RCX=0x30 RDX=0x46f1174 L\"System.Diagnostics.Eventing.FrameworkEventSource\" RDI=0x46f1174 L\"System.Diagnostics.Eventing.FrameworkEventSource\" RSP=0xefcd30 *RSP=0 R8=0x30 R11=0xf R12=0x30 R14=0x60 R15=0x46f11d4\n0x00007FFA7FA8483E  4885F6                   TEST      RSI, RSI                      \nActionDispatcher: skipping instruction.\n0x00007FFA7FA84841  7478                     JZ        0x7a                          \n\n\n=== 6204.log ===\nCAPE Sandbox - Debugger log: Mon Dec 15 23:32:27 2025\nBreakpoint 1 hit by instruction at 0x04ED6CF6 (thread 3000) EAX=0x4f11348 \"L<\" EBX=0x4f11254 ECX=0x4f11348 \"L<\" EDX=0x11aebb4 ESI=0x4f11348 \"L<\" ESP=0x11aebac \"H\u0013\" *ESP=0x4f11348 \"L<\" EBP=0x11aebd8\n0x04ED6CF6  E8CB7ACC65               CALL      0x65cc7ad0                    \nActionDispatcher: skipping instruction.\n0x04ED6CFB  8B45D8                   MOV       EAX, [EBP-0x28]               \n",
      "raw_response": "```yara\nrule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 53 FF 15 ?? ?? ?? ?? }\n        $pattern1 = { E8 ?? ?? ?? ?? 8B 45 ?? }\n        $pattern2 = { 85 C0 0F 84 ?? ?? ?? ?? }\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\71e499ce826b286a\\iter0_v2.yar"
    },
    {
      "iteration": 1,
      "prompt_version": "v2",
      "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 ?? 6A 5B }  // test eax, eax + je + push\n        $pattern1 = { E8 ?? ?? ?? ?? 85 C0 }  // call + test eax, eax\n        $pattern2 = { 85 C0 0F 84 ?? ?? ?? ?? }  // test eax, eax + je (long offset)\n\n    condition:\n        any of them\n}",
      "pattern_type": "CALL_TEST_JE",
      "confidence": 95,
      "opcodes": "",
      "task_id": "1721",
      "status": "bypass_crashed",
      "rule_hit": true,
      "baseline_signatures": 15,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule caused crash: ['exec_crash']",
      "improvement_suggestions": [],
      "debugger_log": "=== 7296.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 03:39:32 2025\nBreakpoint 1 hit by instruction at 0x00876FD0 (thread 7596) EAX=0x870000 \"MZ\" 71e499ce826b286a6674.exe ECX=0xe0 EDX=0x10b ESI=0x8710bc 71e499ce826b286a6674.exe EDI=0x8769b0 71e499ce826b286a6674.exe ESP=0x4df840 *ESP=0x870000 \"MZ\" 71e499ce826b286a6674.exe EBP=0x4df844\nBreak at 0x00876FD0 in 71e499ce826b286a6674.exe (RVA 0x6fd0, thread 7596, Stack 0x004D2000-0x004E0000, ImageBase 0x00870000)\n0x00876FD0  E87FFFFFFF               CALL      0xffffff84                    \nActionDispatcher: skipping instruction.\n0x00876FD5  85C0                     TEST      EAX, EAX                      \n",
      "raw_response": "**EVOLUTION_REASONING**: The initial pattern may have matched the exit instruction (003361F8) but failed to bypass earlier checks. By targeting the **EVASION CHECK** (Strategy A), we focus on the early test/jump sequences that likely trigger termination logic. The three patterns capture distinct but related check points in the trace, ensuring specificity while avoiding false positives. Using concrete bytes from the trace ensures accuracy, and wildcards handle variable offsets.\n\n**PATTERN_TYPE**: CALL_TEST_JE  \n**CONFIDENCE**: 95  \n\n**REASONING**: These patterns target critical check points in the trace where the code evaluates conditions (test eax, eax) and decides execution flow (je). By skipping these instructions, the bypass avoids triggering termination logic. The first pattern captures an early test/jump pair, the second links a call to a subsequent test, and the third handles a longer-range jump, covering different stages of the check logic.\n\n**YARA_RULE**:\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 ?? 6A 5B }  // test eax, eax + je + push\n        $pattern1 = { E8 ?? ?? ?? ?? 85 C0 }  // call + test eax, eax\n        $pattern2 = { 85 C0 0F 84 ?? ?? ?? ?? }  // test eax, eax + je (long offset)\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\71e499ce826b286a\\iter1_v2.yar"
    },
    {
      "iteration": 2,
      "prompt_version": "v2",
      "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 ?? ?? ?? ?? }  // test eax, eax + je (early check)\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? }   // test eax, eax + je (variant offset)\n        $pattern2 = { 8B CE E8 ?? ?? ?? ?? }     // mov ecx, esi + call (evasion chain)\n\n    condition:\n        any of them\n}",
      "pattern_type": "CALL_TEST_JE",
      "confidence": 98,
      "opcodes": "",
      "task_id": "1722",
      "status": "bypass_crashed",
      "rule_hit": true,
      "baseline_signatures": 15,
      "new_signatures": 19,
      "new_signature_names": [
        "stealth_window",
        "cmdline_obfuscation",
        "queries_computer_name",
        "dynamic_function_loading",
        "uses_windows_utilities",
        "infostealer_cookies",
        "stealth_timeout",
        "antiav_detectfile",
        "injection_write_process",
        "queries_keyboard_layout",
        "http_request",
        "createtoolhelp32snapshot_module_enumeration",
        "recon_beacon",
        "antisandbox_sleep",
        "queries_locale_api",
        "suspicious_command_tools",
        "persistence_autorun_tasks",
        "resumethread_remote_process",
        "uses_windows_utilities_to_create_scheduled_task"
      ],
      "new_signature_details": [
        {
          "name": "queries_computer_name",
          "description": "Queries computer hostname",
          "categories": [
            "system_discovery"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 6100,
              "cid": 133
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "dynamic_function_loading",
          "description": "Dynamic (imported) function loading detected",
          "categories": [
            "anti-debug"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 40,
          "references": [],
          "data": [
            {
              "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3898
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3899
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3900
            },
            {
              "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3901
            },
            {
              "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3902
            },
            {
              "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3903
            },
            {
              "DynamicLoader": "apphelp.dll/SdbQueryContext"
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3904
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 155
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 156
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 157
            },
            {
              "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 158
            },
            {
              "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 159
            },
            {
              "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 160
            },
            {
              "DynamicLoader": "apphelp.dll/SdbQueryContext"
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 161
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "queries_keyboard_layout",
          "description": "Queries the keyboard layout",
          "categories": [
            "location_discovery"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 8344,
              "cid": 3975
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4603
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5138
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "queries_locale_api",
          "description": "Queries the computer locale (possible geofencing)",
          "categories": [
            "location_discovery",
            "geofence"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 8344,
              "cid": 1067
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 1088
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3753
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4073
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4094
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4478
            },
            {
              "type": "call",
              "pid": 6100,
              "cid": 136
            },
            {
              "type": "call",
              "pid": 6100,
              "cid": 141
            },
            {
              "type": "call",
              "pid": 6100,
              "cid": 164
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 71
            },
            {
              "type": "call",
              "pid": 7756,
              "cid": 67
            },
            {
              "type": "call",
              "pid": 1552,
              "cid": 22
            },
            {
              "type": "call",
              "pid": 1552,
              "cid": 31
            },
            {
              "type": "call",
              "pid": 6960,
              "cid": 22
            },
            {
              "type": "call",
              "pid": 6960,
              "cid": 31
            },
            {
              "type": "call",
              "pid": 1844,
              "cid": 67
            },
            {
              "type": "call",
              "pid": 2348,
              "cid": 22
            },
            {
              "type": "call",
              "pid": 2348,
              "cid": 31
            },
            {
              "type": "call",
              "pid": 8248,
              "cid": 23
            },
            {
              "type": "call",
              "pid": 8248,
              "cid": 32
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "stealth_timeout",
          "description": "Possible date expiration check, exits too soon after checking local time",
          "categories": [
            "stealth"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 40,
          "references": [],
          "data": [
            {
              "process": "nxE26Ej.exe, PID 8852"
            },
            {
              "type": "call",
              "pid": 8852,
              "cid": 469
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antisandbox_sleep",
          "description": "A process attempted to delay the analysis task.",
          "categories": [
            "anti-sandbox"
          ],
          "severity": 2,
          "weight": 4,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 692,
              "cid": 843
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 918
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 999
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 1005
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 1011
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4598
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4657
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4660
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4811
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5008
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5050
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5060
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5071
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5140
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5161
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5197
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5200
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5211
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5226
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5227
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5262
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5275
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5288
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5298
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5328
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5345
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5366
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5367
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5402
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5430
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5444
            },
            {
              "type": "call",
              "pid": 4588,
              "cid": 1003
            },
            {
              "note": "mnolyk.exe tried to sleep 1036.25 seconds, actually delayed analysis time by 0.0 seconds"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "http_request",
          "description": "Performs HTTP requests potentially not found in PCAP.",
          "categories": [
            "network"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 8344,
              "cid": 5144
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5217
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5279
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5349
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5435
            },
            {
              "url": "193.233.20.4:80//t6r48nSa/index.php"
            },
            {
              "url": "193.233.20.4:80//t6r48nSa/index.php"
            },
            {
              "url": "193.233.20.4:80//t6r48nSa/index.php"
            },
            {
              "url": "193.233.20.4:80//t6r48nSa/index.php"
            },
            {
              "url": "193.233.20.4:80//t6r48nSa/index.php"
            },
            {
              "url": "http://193.233.20.4/t6r48nSa/Plugins/clip64.dll"
            },
            {
              "url": "http://193.233.20.4/t6r48nSa/Plugins/cred64.dll"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "resumethread_remote_process",
          "description": "Resumed a thread in another process",
          "categories": [
            "injection",
            "unpacking"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "thread_resumed": "Process mnolyk.exe with process ID 8344 resumed a thread in another process with the process ID 6100"
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3923
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4547
            },
            {
              "thread_resumed": "Process cmd.exe with process ID 1240 resumed a thread in another process with the process ID 7756"
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 175
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 247
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 306
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 357
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 428
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 488
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "injection_write_process",
          "description": "Writes to the memory another process",
          "categories": [
            "injection",
            "unpacking"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "write_memory": "Process mnolyk.exe with process ID 8344 wrote to the memory of process handle 0x00000500"
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3914
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3916
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3917
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4534
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4536
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4537
            },
            {
              "write_memory": "Process cmd.exe with process ID 1240 wrote to the memory of process handle 0x000002d0"
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 171
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 173
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 174
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 243
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 245
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 246
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 302
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 304
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 305
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 353
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 355
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 356
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 424
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 426
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 427
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 484
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 486
            },
            {
              "type": "call",
              "pid": 1240,
              "cid": 487
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "createtoolhelp32snapshot_module_enumeration",
          "description": "Enumerates the modules from a process (may be used to locate base addresses in process injection)",
          "categories": [
            "discovery"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 1408,
              "cid": 260
            },
            {
              "module": "pid 1408 module ntdll.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 262
            },
            {
              "module": "pid 1408 module KERNEL32.DLL"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 263
            },
            {
              "module": "pid 1408 module KERNELBASE.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 264
            },
            {
              "module": "pid 1408 module apphelp.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 265
            },
            {
              "module": "pid 1408 module AcLayers.DLL"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 266
            },
            {
              "module": "pid 1408 module msvcrt.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 267
            },
            {
              "module": "pid 1408 module USER32.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 268
            },
            {
              "module": "pid 1408 module win32u.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 269
            },
            {
              "module": "pid 1408 module GDI32.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 270
            },
            {
              "module": "pid 1408 module gdi32full.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 271
            },
            {
              "module": "pid 1408 module msvcp_win.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 272
            },
            {
              "module": "pid 1408 module ucrtbase.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 273
            },
            {
              "module": "pid 1408 module SHELL32.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 274
            },
            {
              "module": "pid 1408 module SHLWAPI.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 275
            },
            {
              "module": "pid 1408 module OLEAUT32.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 276
            },
            {
              "module": "pid 1408 module combase.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 277
            },
            {
              "module": "pid 1408 module RPCRT4.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 278
            },
            {
              "module": "pid 1408 module SETUPAPI.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 279
            },
            {
              "module": "pid 1408 module cfgmgr32.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 280
            },
            {
              "module": "pid 1408 module bcrypt.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 281
            },
            {
              "module": "pid 1408 module MPR.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 282
            },
            {
              "module": "pid 1408 module sfc.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 283
            },
            {
              "module": "pid 1408 module WINSPOOL.DRV"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 284
            },
            {
              "module": "pid 1408 module sfc_os.DLL"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 285
            },
            {
              "module": "pid 1408 module IMM32.DLL"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 286
            },
            {
              "module": "pid 1408 module CRYPT32.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 287
            },
            {
              "module": "pid 1408 module WS2_32.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 288
            },
            {
              "module": "pid 1408 module ADVAPI32.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 289
            },
            {
              "module": "pid 1408 module sechost.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 290
            },
            {
              "module": "pid 1408 module ole32.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 291
            },
            {
              "module": "pid 1408 module WINHTTP.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 292
            },
            {
              "module": "pid 1408 module CRYPTBASE.DLL"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 293
            },
            {
              "module": "pid 1408 module SspiCli.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 294
            },
            {
              "module": "pid 1408 module msimg32.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 295
            },
            {
              "module": "pid 1408 module kernel.appcore.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 296
            },
            {
              "module": "pid 1408 module bcryptPrimitives.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 297
            },
            {
              "module": "pid 1408 module uxtheme.dll"
            },
            {
              "type": "call",
              "pid": 1408,
              "cid": 298
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "stealth_window",
          "description": "A process created a hidden window",
          "categories": [
            "stealth"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "process": "nxE26Ej.exe -> C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe"
            },
            {
              "type": "call",
              "pid": 8852,
              "cid": 464
            },
            {
              "process": "mnolyk.exe -> SCHTASKS"
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3974
            },
            {
              "process": "mnolyk.exe -> cmd"
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 4593
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "uses_windows_utilities",
          "description": "Uses Windows utilities for basic functionality",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
            },
            {
              "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
            },
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "C:\\Windows\\system32\\cmd.exe  /S /D /c\" echo Y\""
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "uses_windows_utilities_to_create_scheduled_task",
          "description": "Uses Windows utilities to create a scheduled task",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "infostealer_cookies",
          "description": "Touches a file containing cookies, possibly for information gathering",
          "categories": [
            "infostealer"
          ],
          "severity": 3,
          "weight": 4,
          "confidence": 100,
          "references": [],
          "data": [],
          "new_data": [
            {
              "process": {
                "process_name": "mnolyk.exe",
                "process_id": 8344
              },
              "signs": [
                {
                  "type": "file",
                  "value": "C:\\Users\\sanya\\AppData\\Local\\Microsoft\\Windows\\INetCookies"
                }
              ]
            }
          ],
          "alert": false,
          "families": []
        },
        {
          "name": "persistence_autorun_tasks",
          "description": "Installs itself for autorun at Windows startup",
          "categories": [
            "persistence"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 6128,
              "cid": 214
            },
            {
              "type": "call",
              "pid": 3520,
              "cid": 215
            },
            {
              "type": "call",
              "pid": 2224,
              "cid": 204
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 960
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 966
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 970
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 974
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 978
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 984
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 988
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 995
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 1017
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 1020
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 1024
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 1028
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 1032
            },
            {
              "type": "call",
              "pid": 692,
              "cid": 1036
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 36
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3226
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3227
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3228
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3229
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3318
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3319
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3320
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 3321
            },
            {
              "task": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "recon_beacon",
          "description": "A process sent information about the computer to a remote location.",
          "categories": [
            "network",
            "discovery"
          ],
          "severity": 3,
          "weight": 2,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 8344,
              "cid": 4672
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5054
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5165
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5205
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5256
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5292
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5332
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5371
            },
            {
              "type": "call",
              "pid": 8344,
              "cid": 5412
            },
            {
              "Beacon": "mnolyk.exe: id=260811189190&vs=3.66&sd=3c9b7e&os=1&bi=1&ar=1&pc=DESKTOP-KJGI8L3&un=sanya&dm=&av=13&lv=0&og=1"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antiav_detectfile",
          "description": "Attempts to identify installed AV products by installation directory",
          "categories": [
            "anti-av"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "file": "C:\\ProgramData\\AVAST Software"
            },
            {
              "file": "C:\\ProgramData\\Avira"
            },
            {
              "file": "C:\\ProgramData\\Kaspersky Lab"
            },
            {
              "file": "C:\\ProgramData\\ESET"
            },
            {
              "file": "C:\\ProgramData\\Panda Security"
            },
            {
              "file": "C:\\ProgramData\\Bitdefender"
            },
            {
              "file": "C:\\ProgramData\\AVG"
            },
            {
              "file": "C:\\ProgramData\\Doctor Web"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "cmdline_obfuscation",
          "description": "Appears to use command line obfuscation",
          "categories": [
            "command"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [
            "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf"
          ],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "suspicious_command_tools",
          "description": "Uses suspicious command line tools or Windows utilities",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
            },
            {
              "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
            },
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "CACLS  \"mnolyk.exe\" /P \"sanya:N\""
            },
            {
              "command": "CACLS  \"mnolyk.exe\" /P \"sanya:R\" /E"
            },
            {
              "command": "CACLS  \"..\\5eb6b96734\" /P \"sanya:N\""
            },
            {
              "command": "CACLS  \"..\\5eb6b96734\" /P \"sanya:R\" /E"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        }
      ],
      "failure_reason": "Rule caused crash: ['exec_crash']",
      "improvement_suggestions": [],
      "debugger_log": "=== 1408.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 02:43:28 2025\nBreakpoint 2 hit by instruction at 0x04108758 (thread 4276) EAX=0x4341440 ECX=0x434132c EDX=0xd ESI=0x434132c EDI=0x9da5a8 ESP=0x19ca98 *ESP=0x9da5a8 EBP=0x19cac0\n0x04108758  53                       PUSH      EBX                           \nActionDispatcher: skipping instruction.\n0x04108759  8BCE                     MOV       ECX, ESI                      \n\n\n=== 692.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 02:43:00 2025\nBreakpoint 1 hit by instruction at 0x00007FFA7FA94CCD (thread 5732) RBX=0xefdf20 RCX=0xefddf8 RDX=0x4823768 RSI=0xefddf8 RDI=0xefdda8 RSP=0xefdd50 \"pY\" *RSP=0x1075970 RBP=0xefde10 R8=0x1075970 R9=0x1 R10=0x4 R11=0x3 R12=0x1 R13=0x106e298 R14=0xefdf20 R15=0x4 Xmm1.Low=0x7fb480f0\n0x00007FFA7FA94CCD  488BF1                   MOV       RSI, RCX                      \nActionDispatcher: skipping instruction.\n0x00007FFA7FA94CD0  488BFA                   MOV       RDI, RDX                      \nBreakpoint 1 hit by instruction at 0x00007FFA7FA94CCD (thread 5732) RBX=0xefdf20 RCX=0xefdde8 RDX=0x48237d0 RSI=0xefdde8 RDI=0xefdda8 \" 0\" RSP=0xefdd50 \"Pa\" *RSP=0x1076150 RBP=0xefde10 R9=0x7ff58829227e R10=0x4 R11=0xefd660 R12=0x1 R13=0x106e298 R14=0xefdf20 R15=0x4 Xmm1.Low=0x7fb48028\n0x00007FFA7FA94CCD  488BF1                   MOV       RSI, RCX                      \nActionDispatcher: skipping instruction.\n0x00007FFA7FA94CD0  488BFA                   MOV       RDI, RDX                      \n\n\n=== 8344.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 02:43:46 2025\nBreakpoint 0 hit by instruction at 0x003A15BD (thread 3384) EAX=0x8ff048 EBX=0x4e4 ECX=0x72 EDX=0xa4038a locale.nls ESI=0x8ff048 EDI=0x1 ESP=0x8ff034 *ESP=0x8ff278 EBP=0x8ff034\nBreak at 0x003A15BD in mnolyk.exe (RVA 0x215bd, thread 3384, Stack 0x008F2000-0x00900000, ImageBase 0x00380000)\n0x003A15BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x003A15BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x003A15BD (thread 3384) EAX=0x8fede8 EBX=0x8feff8 EDX=0x8fefe8 ESI=0x100 EDI=0x8fede8 ESP=0x8fedd4 *ESP=0x8ff218 EBP=0x8fedd4\n0x003A15BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x003A15BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x003A15BD (thread 3384) EAX=0x8feff8 EBX=0x8feff8 ECX=0x8fede8 EDX=0x8fefe8 ESI=0x100 EDI=0x8fede8 ESP=0x8fedd4 *ESP=0x8ff218 EBP=0x8fedd4\n0x003A15BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x003A15BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x003A15BD (thread 3384) EAX=0x8fee08 EBX=0x8ff018 EDX=0x8ff008 ESI=0x100 EDI=0x8fee08 ESP=0x8fedf4 *ESP=0x8ff234 EBP=0x8fedf4\n0x003A15BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x003A15BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x003A15BD (thread 3384) EAX=0x8ff018 EBX=0x8ff018 ECX=0x8fee08 EDX=0x8ff008 ESI=0x100 EDI=0x8fee08 ESP=0x8fedf4 *ESP=0x8ff234 EBP=0x8fedf4\n0x003A15BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x003A15BF  7412                     JZ        0x14                          \n\n\n=== 8412.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 02:43:17 2025\nBreakpoint 2 hit by instruction at 0x067B8758 (thread 8436) ECX=0x6acd92ee clr.dll EDX=0xaebc98 \"TL\" ESI=0x42c1420 EDI=0xb17198 ESP=0x8fec48 *ESP=0xb17198 EBP=0x8fec70\n0x067B8758  53                       PUSH      EBX                           \nActionDispatcher: skipping instruction.\n0x067B8759  8BCE                     MOV       ECX, ESI                      \n\n\n=== 8852.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 02:43:37 2025\nBreakpoint 0 hit by instruction at 0x007015BD (thread 2584) EAX=0x10ff428 EBX=0x4e4 ECX=0x72 EDX=0x110038a locale.nls ESI=0x10ff428 EDI=0x1 ESP=0x10ff414 *ESP=0x10ff654 EBP=0x10ff414\nBreak at 0x007015BD in nxE26Ej.exe (RVA 0x215bd, thread 2584, Stack 0x010F2000-0x01100000, ImageBase 0x006E0000)\n0x007015BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007015BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x007015BD (thread 2584) EAX=0x10ff1c8 EBX=0x10ff3d8 EDX=0x10ff3c8 ESI=0x100 EDI=0x10ff1c8 ESP=0x10ff1b4 *ESP=0x10ff5f4 EBP=0x10ff1b4\n0x007015BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007015BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x007015BD (thread 2584) EAX=0x10ff3d8 EBX=0x10ff3d8 ECX=0x10ff1c8 EDX=0x10ff3c8 ESI=0x100 EDI=0x10ff1c8 ESP=0x10ff1b4 *ESP=0x10ff5f4 EBP=0x10ff1b4\n0x007015BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007015BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x007015BD (thread 2584) EAX=0x10ff1e8 EBX=0x10ff3f8 EDX=0x10ff3e8 ESI=0x100 EDI=0x10ff1e8 ESP=0x10ff1d4 *ESP=0x10ff610 EBP=0x10ff1d4\n0x007015BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007015BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x007015BD (thread 2584) EAX=0x10ff3f8 EBX=0x10ff3f8 ECX=0x10ff1e8 EDX=0x10ff3e8 ESI=0x100 EDI=0x10ff1e8 ESP=0x10ff1d4 *ESP=0x10ff610 EBP=0x10ff1d4\n0x007015BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007015BF  7412                     JZ        0x14                          \n",
      "raw_response": "**EVOLUTION_REASONING**: The previous attempt targeted the ExitProcess call directly, causing a crash. To avoid this, I focus on earlier evasion checks (Strategy A) and conditional logic before exit (Strategy B). The selected patterns target test+je sequences and call chains in the first 30% of the trace, which are more likely to trigger detection without crashing. By using concrete byte sequences from the trace, I ensure specificity while avoiding volatile addresses.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 98\n\n**REASONING**: These patterns target critical evasion checks (test+je) and call chains in the early trace, which are less likely to cause crashes than direct exit hooks. The concrete byte sequences from the trace ensure specificity, while wildcards for offsets allow flexibility for variants. This approach bypasses detection by altering the decision logic before termination.\n\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 ?? ?? ?? ?? }  // test eax, eax + je (early check)\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? }   // test eax, eax + je (variant offset)\n        $pattern2 = { 8B CE E8 ?? ?? ?? ?? }     // mov ecx, esi + call (evasion chain)\n\n    condition:\n        any of them\n}\n```",
      "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\71e499ce826b286a\\iter2_v2.yar"
    }
  ],
  "best_attempt": {
    "iteration": 2,
    "prompt_version": "v2",
    "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 ?? ?? ?? ?? }  // test eax, eax + je (early check)\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? }   // test eax, eax + je (variant offset)\n        $pattern2 = { 8B CE E8 ?? ?? ?? ?? }     // mov ecx, esi + call (evasion chain)\n\n    condition:\n        any of them\n}",
    "pattern_type": "CALL_TEST_JE",
    "confidence": 98,
    "opcodes": "",
    "task_id": "1722",
    "status": "bypass_crashed",
    "rule_hit": true,
    "baseline_signatures": 15,
    "new_signatures": 19,
    "new_signature_names": [
      "stealth_window",
      "cmdline_obfuscation",
      "queries_computer_name",
      "dynamic_function_loading",
      "uses_windows_utilities",
      "infostealer_cookies",
      "stealth_timeout",
      "antiav_detectfile",
      "injection_write_process",
      "queries_keyboard_layout",
      "http_request",
      "createtoolhelp32snapshot_module_enumeration",
      "recon_beacon",
      "antisandbox_sleep",
      "queries_locale_api",
      "suspicious_command_tools",
      "persistence_autorun_tasks",
      "resumethread_remote_process",
      "uses_windows_utilities_to_create_scheduled_task"
    ],
    "new_signature_details": [
      {
        "name": "queries_computer_name",
        "description": "Queries computer hostname",
        "categories": [
          "system_discovery"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 6100,
            "cid": 133
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "dynamic_function_loading",
        "description": "Dynamic (imported) function loading detected",
        "categories": [
          "anti-debug"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 40,
        "references": [],
        "data": [
          {
            "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3898
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3899
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3900
          },
          {
            "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3901
          },
          {
            "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3902
          },
          {
            "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3903
          },
          {
            "DynamicLoader": "apphelp.dll/SdbQueryContext"
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3904
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 155
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 156
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 157
          },
          {
            "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 158
          },
          {
            "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 159
          },
          {
            "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 160
          },
          {
            "DynamicLoader": "apphelp.dll/SdbQueryContext"
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 161
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "queries_keyboard_layout",
        "description": "Queries the keyboard layout",
        "categories": [
          "location_discovery"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 8344,
            "cid": 3975
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4603
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5138
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "queries_locale_api",
        "description": "Queries the computer locale (possible geofencing)",
        "categories": [
          "location_discovery",
          "geofence"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 8344,
            "cid": 1067
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 1088
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3753
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4073
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4094
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4478
          },
          {
            "type": "call",
            "pid": 6100,
            "cid": 136
          },
          {
            "type": "call",
            "pid": 6100,
            "cid": 141
          },
          {
            "type": "call",
            "pid": 6100,
            "cid": 164
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 71
          },
          {
            "type": "call",
            "pid": 7756,
            "cid": 67
          },
          {
            "type": "call",
            "pid": 1552,
            "cid": 22
          },
          {
            "type": "call",
            "pid": 1552,
            "cid": 31
          },
          {
            "type": "call",
            "pid": 6960,
            "cid": 22
          },
          {
            "type": "call",
            "pid": 6960,
            "cid": 31
          },
          {
            "type": "call",
            "pid": 1844,
            "cid": 67
          },
          {
            "type": "call",
            "pid": 2348,
            "cid": 22
          },
          {
            "type": "call",
            "pid": 2348,
            "cid": 31
          },
          {
            "type": "call",
            "pid": 8248,
            "cid": 23
          },
          {
            "type": "call",
            "pid": 8248,
            "cid": 32
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "stealth_timeout",
        "description": "Possible date expiration check, exits too soon after checking local time",
        "categories": [
          "stealth"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 40,
        "references": [],
        "data": [
          {
            "process": "nxE26Ej.exe, PID 8852"
          },
          {
            "type": "call",
            "pid": 8852,
            "cid": 469
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "antisandbox_sleep",
        "description": "A process attempted to delay the analysis task.",
        "categories": [
          "anti-sandbox"
        ],
        "severity": 2,
        "weight": 4,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 692,
            "cid": 843
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 918
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 999
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 1005
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 1011
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4598
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4657
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4660
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4811
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5008
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5050
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5060
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5071
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5140
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5161
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5197
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5200
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5211
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5226
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5227
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5262
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5275
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5288
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5298
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5328
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5345
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5366
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5367
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5402
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5430
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5444
          },
          {
            "type": "call",
            "pid": 4588,
            "cid": 1003
          },
          {
            "note": "mnolyk.exe tried to sleep 1036.25 seconds, actually delayed analysis time by 0.0 seconds"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "http_request",
        "description": "Performs HTTP requests potentially not found in PCAP.",
        "categories": [
          "network"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 8344,
            "cid": 5144
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5217
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5279
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5349
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5435
          },
          {
            "url": "193.233.20.4:80//t6r48nSa/index.php"
          },
          {
            "url": "193.233.20.4:80//t6r48nSa/index.php"
          },
          {
            "url": "193.233.20.4:80//t6r48nSa/index.php"
          },
          {
            "url": "193.233.20.4:80//t6r48nSa/index.php"
          },
          {
            "url": "193.233.20.4:80//t6r48nSa/index.php"
          },
          {
            "url": "http://193.233.20.4/t6r48nSa/Plugins/clip64.dll"
          },
          {
            "url": "http://193.233.20.4/t6r48nSa/Plugins/cred64.dll"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "resumethread_remote_process",
        "description": "Resumed a thread in another process",
        "categories": [
          "injection",
          "unpacking"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "thread_resumed": "Process mnolyk.exe with process ID 8344 resumed a thread in another process with the process ID 6100"
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3923
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4547
          },
          {
            "thread_resumed": "Process cmd.exe with process ID 1240 resumed a thread in another process with the process ID 7756"
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 175
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 247
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 306
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 357
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 428
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 488
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "injection_write_process",
        "description": "Writes to the memory another process",
        "categories": [
          "injection",
          "unpacking"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "write_memory": "Process mnolyk.exe with process ID 8344 wrote to the memory of process handle 0x00000500"
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3914
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3916
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3917
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4534
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4536
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4537
          },
          {
            "write_memory": "Process cmd.exe with process ID 1240 wrote to the memory of process handle 0x000002d0"
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 171
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 173
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 174
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 243
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 245
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 246
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 302
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 304
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 305
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 353
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 355
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 356
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 424
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 426
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 427
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 484
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 486
          },
          {
            "type": "call",
            "pid": 1240,
            "cid": 487
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "createtoolhelp32snapshot_module_enumeration",
        "description": "Enumerates the modules from a process (may be used to locate base addresses in process injection)",
        "categories": [
          "discovery"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 1408,
            "cid": 260
          },
          {
            "module": "pid 1408 module ntdll.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 262
          },
          {
            "module": "pid 1408 module KERNEL32.DLL"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 263
          },
          {
            "module": "pid 1408 module KERNELBASE.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 264
          },
          {
            "module": "pid 1408 module apphelp.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 265
          },
          {
            "module": "pid 1408 module AcLayers.DLL"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 266
          },
          {
            "module": "pid 1408 module msvcrt.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 267
          },
          {
            "module": "pid 1408 module USER32.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 268
          },
          {
            "module": "pid 1408 module win32u.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 269
          },
          {
            "module": "pid 1408 module GDI32.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 270
          },
          {
            "module": "pid 1408 module gdi32full.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 271
          },
          {
            "module": "pid 1408 module msvcp_win.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 272
          },
          {
            "module": "pid 1408 module ucrtbase.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 273
          },
          {
            "module": "pid 1408 module SHELL32.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 274
          },
          {
            "module": "pid 1408 module SHLWAPI.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 275
          },
          {
            "module": "pid 1408 module OLEAUT32.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 276
          },
          {
            "module": "pid 1408 module combase.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 277
          },
          {
            "module": "pid 1408 module RPCRT4.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 278
          },
          {
            "module": "pid 1408 module SETUPAPI.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 279
          },
          {
            "module": "pid 1408 module cfgmgr32.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 280
          },
          {
            "module": "pid 1408 module bcrypt.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 281
          },
          {
            "module": "pid 1408 module MPR.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 282
          },
          {
            "module": "pid 1408 module sfc.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 283
          },
          {
            "module": "pid 1408 module WINSPOOL.DRV"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 284
          },
          {
            "module": "pid 1408 module sfc_os.DLL"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 285
          },
          {
            "module": "pid 1408 module IMM32.DLL"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 286
          },
          {
            "module": "pid 1408 module CRYPT32.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 287
          },
          {
            "module": "pid 1408 module WS2_32.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 288
          },
          {
            "module": "pid 1408 module ADVAPI32.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 289
          },
          {
            "module": "pid 1408 module sechost.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 290
          },
          {
            "module": "pid 1408 module ole32.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 291
          },
          {
            "module": "pid 1408 module WINHTTP.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 292
          },
          {
            "module": "pid 1408 module CRYPTBASE.DLL"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 293
          },
          {
            "module": "pid 1408 module SspiCli.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 294
          },
          {
            "module": "pid 1408 module msimg32.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 295
          },
          {
            "module": "pid 1408 module kernel.appcore.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 296
          },
          {
            "module": "pid 1408 module bcryptPrimitives.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 297
          },
          {
            "module": "pid 1408 module uxtheme.dll"
          },
          {
            "type": "call",
            "pid": 1408,
            "cid": 298
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "stealth_window",
        "description": "A process created a hidden window",
        "categories": [
          "stealth"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "process": "nxE26Ej.exe -> C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe"
          },
          {
            "type": "call",
            "pid": 8852,
            "cid": 464
          },
          {
            "process": "mnolyk.exe -> SCHTASKS"
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3974
          },
          {
            "process": "mnolyk.exe -> cmd"
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 4593
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "uses_windows_utilities",
        "description": "Uses Windows utilities for basic functionality",
        "categories": [
          "command",
          "lateral"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 80,
        "references": [],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
          },
          {
            "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
          },
          {
            "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "C:\\Windows\\system32\\cmd.exe  /S /D /c\" echo Y\""
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "uses_windows_utilities_to_create_scheduled_task",
        "description": "Uses Windows utilities to create a scheduled task",
        "categories": [
          "command",
          "lateral"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 80,
        "references": [],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "infostealer_cookies",
        "description": "Touches a file containing cookies, possibly for information gathering",
        "categories": [
          "infostealer"
        ],
        "severity": 3,
        "weight": 4,
        "confidence": 100,
        "references": [],
        "data": [],
        "new_data": [
          {
            "process": {
              "process_name": "mnolyk.exe",
              "process_id": 8344
            },
            "signs": [
              {
                "type": "file",
                "value": "C:\\Users\\sanya\\AppData\\Local\\Microsoft\\Windows\\INetCookies"
              }
            ]
          }
        ],
        "alert": false,
        "families": []
      },
      {
        "name": "persistence_autorun_tasks",
        "description": "Installs itself for autorun at Windows startup",
        "categories": [
          "persistence"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 6128,
            "cid": 214
          },
          {
            "type": "call",
            "pid": 3520,
            "cid": 215
          },
          {
            "type": "call",
            "pid": 2224,
            "cid": 204
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 960
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 966
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 970
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 974
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 978
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 984
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 988
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 995
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 1017
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 1020
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 1024
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 1028
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 1032
          },
          {
            "type": "call",
            "pid": 692,
            "cid": 1036
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 36
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3226
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3227
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3228
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3229
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3318
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3319
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3320
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 3321
          },
          {
            "task": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "recon_beacon",
        "description": "A process sent information about the computer to a remote location.",
        "categories": [
          "network",
          "discovery"
        ],
        "severity": 3,
        "weight": 2,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 8344,
            "cid": 4672
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5054
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5165
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5205
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5256
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5292
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5332
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5371
          },
          {
            "type": "call",
            "pid": 8344,
            "cid": 5412
          },
          {
            "Beacon": "mnolyk.exe: id=260811189190&vs=3.66&sd=3c9b7e&os=1&bi=1&ar=1&pc=DESKTOP-KJGI8L3&un=sanya&dm=&av=13&lv=0&og=1"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "antiav_detectfile",
        "description": "Attempts to identify installed AV products by installation directory",
        "categories": [
          "anti-av"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "file": "C:\\ProgramData\\AVAST Software"
          },
          {
            "file": "C:\\ProgramData\\Avira"
          },
          {
            "file": "C:\\ProgramData\\Kaspersky Lab"
          },
          {
            "file": "C:\\ProgramData\\ESET"
          },
          {
            "file": "C:\\ProgramData\\Panda Security"
          },
          {
            "file": "C:\\ProgramData\\Bitdefender"
          },
          {
            "file": "C:\\ProgramData\\AVG"
          },
          {
            "file": "C:\\ProgramData\\Doctor Web"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "cmdline_obfuscation",
        "description": "Appears to use command line obfuscation",
        "categories": [
          "command"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [
          "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf"
        ],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "suspicious_command_tools",
        "description": "Uses suspicious command line tools or Windows utilities",
        "categories": [
          "command",
          "lateral"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 80,
        "references": [],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
          },
          {
            "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
          },
          {
            "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "CACLS  \"mnolyk.exe\" /P \"sanya:N\""
          },
          {
            "command": "CACLS  \"mnolyk.exe\" /P \"sanya:R\" /E"
          },
          {
            "command": "CACLS  \"..\\5eb6b96734\" /P \"sanya:N\""
          },
          {
            "command": "CACLS  \"..\\5eb6b96734\" /P \"sanya:R\" /E"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      }
    ],
    "failure_reason": "Rule caused crash: ['exec_crash']",
    "improvement_suggestions": [],
    "debugger_log": "=== 1408.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 02:43:28 2025\nBreakpoint 2 hit by instruction at 0x04108758 (thread 4276) EAX=0x4341440 ECX=0x434132c EDX=0xd ESI=0x434132c EDI=0x9da5a8 ESP=0x19ca98 *ESP=0x9da5a8 EBP=0x19cac0\n0x04108758  53                       PUSH      EBX                           \nActionDispatcher: skipping instruction.\n0x04108759  8BCE                     MOV       ECX, ESI                      \n\n\n=== 692.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 02:43:00 2025\nBreakpoint 1 hit by instruction at 0x00007FFA7FA94CCD (thread 5732) RBX=0xefdf20 RCX=0xefddf8 RDX=0x4823768 RSI=0xefddf8 RDI=0xefdda8 RSP=0xefdd50 \"pY\" *RSP=0x1075970 RBP=0xefde10 R8=0x1075970 R9=0x1 R10=0x4 R11=0x3 R12=0x1 R13=0x106e298 R14=0xefdf20 R15=0x4 Xmm1.Low=0x7fb480f0\n0x00007FFA7FA94CCD  488BF1                   MOV       RSI, RCX                      \nActionDispatcher: skipping instruction.\n0x00007FFA7FA94CD0  488BFA                   MOV       RDI, RDX                      \nBreakpoint 1 hit by instruction at 0x00007FFA7FA94CCD (thread 5732) RBX=0xefdf20 RCX=0xefdde8 RDX=0x48237d0 RSI=0xefdde8 RDI=0xefdda8 \" 0\" RSP=0xefdd50 \"Pa\" *RSP=0x1076150 RBP=0xefde10 R9=0x7ff58829227e R10=0x4 R11=0xefd660 R12=0x1 R13=0x106e298 R14=0xefdf20 R15=0x4 Xmm1.Low=0x7fb48028\n0x00007FFA7FA94CCD  488BF1                   MOV       RSI, RCX                      \nActionDispatcher: skipping instruction.\n0x00007FFA7FA94CD0  488BFA                   MOV       RDI, RDX                      \n\n\n=== 8344.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 02:43:46 2025\nBreakpoint 0 hit by instruction at 0x003A15BD (thread 3384) EAX=0x8ff048 EBX=0x4e4 ECX=0x72 EDX=0xa4038a locale.nls ESI=0x8ff048 EDI=0x1 ESP=0x8ff034 *ESP=0x8ff278 EBP=0x8ff034\nBreak at 0x003A15BD in mnolyk.exe (RVA 0x215bd, thread 3384, Stack 0x008F2000-0x00900000, ImageBase 0x00380000)\n0x003A15BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x003A15BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x003A15BD (thread 3384) EAX=0x8fede8 EBX=0x8feff8 EDX=0x8fefe8 ESI=0x100 EDI=0x8fede8 ESP=0x8fedd4 *ESP=0x8ff218 EBP=0x8fedd4\n0x003A15BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x003A15BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x003A15BD (thread 3384) EAX=0x8feff8 EBX=0x8feff8 ECX=0x8fede8 EDX=0x8fefe8 ESI=0x100 EDI=0x8fede8 ESP=0x8fedd4 *ESP=0x8ff218 EBP=0x8fedd4\n0x003A15BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x003A15BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x003A15BD (thread 3384) EAX=0x8fee08 EBX=0x8ff018 EDX=0x8ff008 ESI=0x100 EDI=0x8fee08 ESP=0x8fedf4 *ESP=0x8ff234 EBP=0x8fedf4\n0x003A15BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x003A15BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x003A15BD (thread 3384) EAX=0x8ff018 EBX=0x8ff018 ECX=0x8fee08 EDX=0x8ff008 ESI=0x100 EDI=0x8fee08 ESP=0x8fedf4 *ESP=0x8ff234 EBP=0x8fedf4\n0x003A15BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x003A15BF  7412                     JZ        0x14                          \n\n\n=== 8412.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 02:43:17 2025\nBreakpoint 2 hit by instruction at 0x067B8758 (thread 8436) ECX=0x6acd92ee clr.dll EDX=0xaebc98 \"TL\" ESI=0x42c1420 EDI=0xb17198 ESP=0x8fec48 *ESP=0xb17198 EBP=0x8fec70\n0x067B8758  53                       PUSH      EBX                           \nActionDispatcher: skipping instruction.\n0x067B8759  8BCE                     MOV       ECX, ESI                      \n\n\n=== 8852.log ===\nCAPE Sandbox - Debugger log: Tue Dec 16 02:43:37 2025\nBreakpoint 0 hit by instruction at 0x007015BD (thread 2584) EAX=0x10ff428 EBX=0x4e4 ECX=0x72 EDX=0x110038a locale.nls ESI=0x10ff428 EDI=0x1 ESP=0x10ff414 *ESP=0x10ff654 EBP=0x10ff414\nBreak at 0x007015BD in nxE26Ej.exe (RVA 0x215bd, thread 2584, Stack 0x010F2000-0x01100000, ImageBase 0x006E0000)\n0x007015BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007015BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x007015BD (thread 2584) EAX=0x10ff1c8 EBX=0x10ff3d8 EDX=0x10ff3c8 ESI=0x100 EDI=0x10ff1c8 ESP=0x10ff1b4 *ESP=0x10ff5f4 EBP=0x10ff1b4\n0x007015BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007015BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x007015BD (thread 2584) EAX=0x10ff3d8 EBX=0x10ff3d8 ECX=0x10ff1c8 EDX=0x10ff3c8 ESI=0x100 EDI=0x10ff1c8 ESP=0x10ff1b4 *ESP=0x10ff5f4 EBP=0x10ff1b4\n0x007015BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007015BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x007015BD (thread 2584) EAX=0x10ff1e8 EBX=0x10ff3f8 EDX=0x10ff3e8 ESI=0x100 EDI=0x10ff1e8 ESP=0x10ff1d4 *ESP=0x10ff610 EBP=0x10ff1d4\n0x007015BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007015BF  7412                     JZ        0x14                          \nBreakpoint 0 hit by instruction at 0x007015BD (thread 2584) EAX=0x10ff3f8 EBX=0x10ff3f8 ECX=0x10ff1e8 EDX=0x10ff3e8 ESI=0x100 EDI=0x10ff1e8 ESP=0x10ff1d4 *ESP=0x10ff610 EBP=0x10ff1d4\n0x007015BD  85C0                     TEST      EAX, EAX                      \nActionDispatcher: skipping instruction.\n0x007015BF  7412                     JZ        0x14                          \n",
    "raw_response": "**EVOLUTION_REASONING**: The previous attempt targeted the ExitProcess call directly, causing a crash. To avoid this, I focus on earlier evasion checks (Strategy A) and conditional logic before exit (Strategy B). The selected patterns target test+je sequences and call chains in the first 30% of the trace, which are more likely to trigger detection without crashing. By using concrete byte sequences from the trace, I ensure specificity while avoiding volatile addresses.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 98\n\n**REASONING**: These patterns target critical evasion checks (test+je) and call chains in the early trace, which are less likely to cause crashes than direct exit hooks. The concrete byte sequences from the trace ensure specificity, while wildcards for offsets allow flexibility for variants. This approach bypasses detection by altering the decision logic before termination.\n\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 74 12 ?? ?? ?? ?? }  // test eax, eax + je (early check)\n        $pattern1 = { 85 C0 0F 84 ?? ?? ?? ?? }   // test eax, eax + je (variant offset)\n        $pattern2 = { 8B CE E8 ?? ?? ?? ?? }     // mov ecx, esi + call (evasion chain)\n\n    condition:\n        any of them\n}\n```",
    "yara_file": "ablation_results\\qwen3_latest\\Iter\\Iter\\71e499ce826b286a\\iter2_v2.yar"
  },
  "best_score": 19,
  "optimization_history": [
    "Iteration 1: rule_hit - Rule hit but no new signatures",
    "Iteration 2: bypass_crashed - Rule caused crash: ['exec_crash']",
    "Iteration 3: SUCCESS - 19 new signatures"
  ],
  "successful_patterns": [
    ""
  ],
  "failed_patterns": [
    "",
    ""
  ]
}