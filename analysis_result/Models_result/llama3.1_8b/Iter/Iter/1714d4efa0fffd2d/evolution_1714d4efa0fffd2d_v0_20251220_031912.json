{
  "sha256": "1714d4efa0fffd2d33e1257d95ebd6ff8b9417f3fcc2710e7171c7827e8ae0cb",
  "prompt_version": "v0",
  "iterations": [
    {
      "iteration": 0,
      "prompt_version": "v0",
      "yara_rule": "rule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 53 FF 15 ?? ?? ?? ?? 3F }\n        $pattern1 = { 33 C9 E8 ?? ?? ?? ?? A1 ?? ?? ?? ?? }\n        $pattern2 = { 53 FF 15 ?? ?? ?? ?? D1 }\n\n    condition:\n        any of them\n}",
      "pattern_type": "UNKNOWN",
      "confidence": 50,
      "opcodes": "",
      "task_id": "1928",
      "status": "rule_hit",
      "rule_hit": true,
      "baseline_signatures": 15,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule hit but no new signatures",
      "improvement_suggestions": [
        "To avoid crashes and find more signatures, we should use wildcards to match variants of the instructions instead of exact sequences."
      ],
      "debugger_log": null,
      "raw_response": "Based on the provided trace data, I will extract three different evasion point-specific patterns that meet the requirements.\n\n### Pattern 1\nFrom Trace #1, at address `013761F8`:\n```assembly\nFF152CA13701     call dword ptr [0137A12Ch]\n```\nThis instruction is part of a suspicious sequence, so we'll include surrounding context to make it more specific.\n```assembly\n53               push ebx\nFF152CA13701     call dword ptr [0137A12Ch]\n33FF             xor edi, edi\n```\nCombining these instructions into a single pattern:\n```yara\n$pattern0 = { 53 FF15 ?? ?? ?? ?? 3F }\n```\n\n### Pattern 2\nFrom Trace #1, at address `013761E7`:\n```assembly\nA188853701       mov eax, dword ptr [01378588h]\n```\nThis instruction is a memory access that might be used for evasion. We'll include surrounding context to make it more specific.\n```assembly\n33C9             xor ecx, ecx\nE8B3030000       call 013744B9h\nA188853701       mov eax, dword ptr [01378588h]\n```\nCombining these instructions into a single pattern:\n```yara\n$pattern1 = { 33 C9 E8 ?? ?? ?? ?? A1 ?? ?? ?? ?? }\n```\n\n### Pattern 3\nFrom Trace #2, at address `011D61F8`:\n```assembly\nFF152CA11D01     call dword ptr [011DA12Ch]\n```\nSimilar to the first pattern, we'll include surrounding context to make it more specific.\n```assembly\n53               push ebx\nFF152CA11D01     call dword ptr [011DA12Ch]\n33FF             xor edi, edi\n```\nCombining these instructions into a single pattern:\n```yara\n$pattern2 = { 53 FF15 ?? ?? ?? ?? D1 }\n```\n\nNow that we have the three patterns, let's format them according to the YARA output requirements.\n\n```yara\nrule Bypass_Sample\n{\n    meta:\n        description = \"Evasion bypass rule\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 53 FF15 ?? ?? ?? ?? 3F }\n        $pattern1 = { 33 C9 E8 ?? ?? ?? ?? A1 ?? ?? ?? ?? }\n        $pattern2 = { 53 FF15 ?? ?? ?? ?? D1 }\n\n    condition:\n        any of them\n}\n```\n\nThis YARA rule targets the three suspicious evasion points identified in the trace data. Each pattern is specific enough to match only the target location, and they meet the requirements for length and wildcard usage.",
      "yara_file": "ablation_results\\llama3.1_8b\\Iter\\Iter\\1714d4efa0fffd2d\\iter0_v0.yar"
    },
    {
      "iteration": 1,
      "prompt_version": "v0",
      "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 0F 84 ?? ?? ?? ?? 8B 45 FC }  // test+je+mov (specific stack offset)\n        $pattern1 = { 83 F8 01 74 12 8B 4D F8 }  // cmp+je+mov (concrete bytes, very specific)\n        $pattern2 = { 3D 00 10 00 00 0F 82 }  // cmp eax,imm32 + jb (concrete comparison value)\n\n    condition:\n        any of them\n}",
      "pattern_type": "UNKNOWN",
      "confidence": 50,
      "opcodes": "",
      "task_id": "1929",
      "status": "rule_hit",
      "rule_hit": true,
      "baseline_signatures": 15,
      "new_signatures": 0,
      "new_signature_names": [],
      "new_signature_details": [],
      "failure_reason": "Rule hit but no new signatures",
      "improvement_suggestions": [
        "We should target a different instruction sequence that is more generic but still relevant to the evasion technique. This could involve using wildcards or reorganizing the pattern to match multiple variants."
      ],
      "debugger_log": null,
      "raw_response": "## EVOLUTION_REASONING:\nWe will evolve a YARA bypass rule by creating three distinct patterns based on the provided trace data. These patterns aim to target specific evasion techniques used in the malware sample, specifically related to exit-related instructions.\n\n## PATTERN_TYPE:\nThe evolved patterns will be of types: CALL_TEST_JE (Strategy A), API_CHECK (Strategy B), and CMP_SETZ (Strategy C).\n\n## CONFIDENCE:\nWe estimate a 60% success rate for Strategy A, 25% for Strategy B, and 15% for Strategy C.\n\n## REASONING:\nOur reasoning is based on the analysis of the provided trace data. We will target specific sequences related to exit-related instructions, conditional checks before exit, and unique instruction sequences.\n\n## YARA_RULE:\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 0F 84 ?? ?? ?? ?? 8B 45 FC }  -- test+je+mov (specific stack offset)\n        $pattern1 = { 83 F8 01 74 12 8B 4D F8 }  -- cmp+je+mov (concrete bytes, very specific)\n        $pattern2 = { 3D 00 10 00 00 0F 82 }  -- cmp eax,imm32 + jb (concrete comparison value)\n\n    condition:\n        any of them\n}\n```\n\nNote that the exact byte sequences are copied from the provided trace data to ensure specificity. The `$pattern0` targets exit-related instructions with a specific stack offset, `$pattern1` targets conditional checks before exit with concrete bytes, and `$pattern2` targets unique instruction sequences related to timing checks.",
      "yara_file": "ablation_results\\llama3.1_8b\\Iter\\Iter\\1714d4efa0fffd2d\\iter1_v0.yar"
    },
    {
      "iteration": 2,
      "prompt_version": "v0",
      "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 0F 84 ?? ?? ?? ?? }  // test eax, je\n        $pattern1 = { 8B CE E8 ?? ?? ?? ?? }  // mov ecx, esi, call\n        $pattern2 = { 85 C0 0F 83 ?? ?? ?? ?? }  // test eax, jne\n\n    condition:\n        any of them\n}",
      "pattern_type": "CALL_TEST_JE",
      "confidence": 80,
      "opcodes": "",
      "task_id": "1930",
      "status": "bypass_crashed",
      "rule_hit": true,
      "baseline_signatures": 15,
      "new_signatures": 23,
      "new_signature_names": [
        "antisandbox_unhook",
        "injection_write_process",
        "creates_suspended_process",
        "resumethread_remote_process",
        "suspicious_command_tools",
        "createtoolhelp32snapshot_module_enumeration",
        "dynamic_function_loading",
        "queries_computer_name",
        "recon_beacon",
        "persistence_autorun_tasks",
        "antivm_generic_system",
        "queries_keyboard_layout",
        "cmdline_obfuscation",
        "antisandbox_sleep",
        "queries_locale_api",
        "stealth_timeout",
        "terminates_remote_process",
        "uses_windows_utilities",
        "uses_windows_utilities_to_create_scheduled_task",
        "infostealer_cookies",
        "http_request",
        "stealth_window",
        "antiav_detectfile"
      ],
      "new_signature_details": [
        {
          "name": "queries_computer_name",
          "description": "Queries computer hostname",
          "categories": [
            "system_discovery"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 8584,
              "cid": 133
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "dynamic_function_loading",
          "description": "Dynamic (imported) function loading detected",
          "categories": [
            "anti-debug"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 40,
          "references": [],
          "data": [
            {
              "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3908
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3909
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3910
            },
            {
              "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3911
            },
            {
              "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3912
            },
            {
              "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3913
            },
            {
              "DynamicLoader": "apphelp.dll/SdbQueryContext"
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3914
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 155
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 156
            },
            {
              "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 157
            },
            {
              "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 158
            },
            {
              "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 159
            },
            {
              "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 160
            },
            {
              "DynamicLoader": "apphelp.dll/SdbQueryContext"
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 161
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "queries_keyboard_layout",
          "description": "Queries the keyboard layout",
          "categories": [
            "location_discovery"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 7880,
              "cid": 3985
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 4608
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5175
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "queries_locale_api",
          "description": "Queries the computer locale (possible geofencing)",
          "categories": [
            "location_discovery",
            "geofence"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 7880,
              "cid": 1068
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 1089
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3762
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 4080
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 4101
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 4484
            },
            {
              "type": "call",
              "pid": 8584,
              "cid": 135
            },
            {
              "type": "call",
              "pid": 8584,
              "cid": 140
            },
            {
              "type": "call",
              "pid": 8584,
              "cid": 164
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 71
            },
            {
              "type": "call",
              "pid": 3832,
              "cid": 67
            },
            {
              "type": "call",
              "pid": 3804,
              "cid": 22
            },
            {
              "type": "call",
              "pid": 3804,
              "cid": 31
            },
            {
              "type": "call",
              "pid": 7008,
              "cid": 21
            },
            {
              "type": "call",
              "pid": 7008,
              "cid": 30
            },
            {
              "type": "call",
              "pid": 7596,
              "cid": 67
            },
            {
              "type": "call",
              "pid": 1744,
              "cid": 22
            },
            {
              "type": "call",
              "pid": 1744,
              "cid": 31
            },
            {
              "type": "call",
              "pid": 9148,
              "cid": 23
            },
            {
              "type": "call",
              "pid": 9148,
              "cid": 32
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 2502
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 6871
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 10519
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 14165
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 17813
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 21453
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 25093
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 28734
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 2540
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 6908
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 10555
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 14198
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 17830
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 21472
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 25108
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 28738
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 31340
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 34036
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 37005
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 40710
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "stealth_timeout",
          "description": "Possible date expiration check, exits too soon after checking local time",
          "categories": [
            "stealth"
          ],
          "severity": 1,
          "weight": 1,
          "confidence": 40,
          "references": [],
          "data": [
            {
              "process": "njJ99fo.exe, PID 4852"
            },
            {
              "type": "call",
              "pid": 4852,
              "cid": 478
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antisandbox_sleep",
          "description": "A process attempted to delay the analysis task.",
          "categories": [
            "anti-sandbox"
          ],
          "severity": 2,
          "weight": 4,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 3296,
              "cid": 845
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 920
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 1000
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 1006
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 1012
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 4611
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 4693
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 4697
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5048
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5088
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5099
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5108
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5177
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5198
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5232
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5247
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5262
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5263
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5303
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5316
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5329
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5339
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5370
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5387
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5394
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5409
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5448
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5449
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5476
            },
            {
              "type": "call",
              "pid": 7892,
              "cid": 1005
            },
            {
              "type": "call",
              "pid": 1476,
              "cid": 448
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 5836
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 6124
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 15990
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 27086
            },
            {
              "type": "call",
              "pid": 3504,
              "cid": 31292
            },
            {
              "type": "call",
              "pid": 1260,
              "cid": 393
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 6145
            },
            {
              "type": "call",
              "pid": 7972,
              "cid": 33758
            },
            {
              "note": "mnolyk.exe tried to sleep 1181.0 seconds, actually delayed analysis time by 0.0 seconds"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "http_request",
          "description": "Performs HTTP requests potentially not found in PCAP.",
          "categories": [
            "network"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 7880,
              "cid": 5181
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5253
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5320
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5391
            },
            {
              "url": "193.233.20.4:80//t6r48nSa/index.php"
            },
            {
              "url": "193.233.20.4:80//t6r48nSa/index.php"
            },
            {
              "url": "193.233.20.4:80//t6r48nSa/index.php"
            },
            {
              "url": "193.233.20.4:80//t6r48nSa/index.php"
            },
            {
              "url": "193.233.20.4:80//t6r48nSa/index.php"
            },
            {
              "url": "http://193.233.20.4/t6r48nSa/Plugins/clip64.dll"
            },
            {
              "url": "http://193.233.20.4/t6r48nSa/Plugins/cred64.dll"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "creates_suspended_process",
          "description": "Creates a process in a suspended state, likely for injection",
          "categories": [
            "injection",
            "process hollowing"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 50,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 1056,
              "cid": 11
            },
            {
              "type": "call",
              "pid": 1056,
              "cid": 24
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "resumethread_remote_process",
          "description": "Resumed a thread in another process",
          "categories": [
            "injection",
            "unpacking"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "thread_resumed": "Process mnolyk.exe with process ID 7880 resumed a thread in another process with the process ID 8584"
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3933
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 4553
            },
            {
              "thread_resumed": "Process cmd.exe with process ID 7036 resumed a thread in another process with the process ID 3832"
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 175
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 247
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 306
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 357
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 428
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 488
            },
            {
              "thread_resumed": "Process svchost.exe with process ID 1056 resumed a thread in another process with the process ID 3504"
            },
            {
              "type": "call",
              "pid": 1056,
              "cid": 12
            },
            {
              "type": "call",
              "pid": 1056,
              "cid": 25
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "injection_write_process",
          "description": "Writes to the memory another process",
          "categories": [
            "injection",
            "unpacking"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "write_memory": "Process mnolyk.exe with process ID 7880 wrote to the memory of process handle 0x00000538"
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3924
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3926
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3927
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 4540
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 4542
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 4543
            },
            {
              "write_memory": "Process cmd.exe with process ID 7036 wrote to the memory of process handle 0x000002d0"
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 171
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 173
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 174
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 243
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 245
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 246
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 302
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 304
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 305
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 353
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 355
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 356
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 424
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 426
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 427
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 484
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 486
            },
            {
              "type": "call",
              "pid": 7036,
              "cid": 487
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "createtoolhelp32snapshot_module_enumeration",
          "description": "Enumerates the modules from a process (may be used to locate base addresses in process injection)",
          "categories": [
            "discovery"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 7824,
              "cid": 248
            },
            {
              "module": "pid 7824 module ntdll.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 250
            },
            {
              "module": "pid 7824 module KERNEL32.DLL"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 251
            },
            {
              "module": "pid 7824 module KERNELBASE.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 252
            },
            {
              "module": "pid 7824 module apphelp.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 253
            },
            {
              "module": "pid 7824 module AcLayers.DLL"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 254
            },
            {
              "module": "pid 7824 module msvcrt.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 255
            },
            {
              "module": "pid 7824 module USER32.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 256
            },
            {
              "module": "pid 7824 module win32u.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 257
            },
            {
              "module": "pid 7824 module GDI32.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 258
            },
            {
              "module": "pid 7824 module gdi32full.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 259
            },
            {
              "module": "pid 7824 module msvcp_win.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 260
            },
            {
              "module": "pid 7824 module ucrtbase.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 261
            },
            {
              "module": "pid 7824 module SHELL32.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 262
            },
            {
              "module": "pid 7824 module SHLWAPI.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 263
            },
            {
              "module": "pid 7824 module OLEAUT32.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 264
            },
            {
              "module": "pid 7824 module combase.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 265
            },
            {
              "module": "pid 7824 module RPCRT4.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 266
            },
            {
              "module": "pid 7824 module SETUPAPI.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 267
            },
            {
              "module": "pid 7824 module cfgmgr32.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 268
            },
            {
              "module": "pid 7824 module bcrypt.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 269
            },
            {
              "module": "pid 7824 module MPR.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 270
            },
            {
              "module": "pid 7824 module sfc.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 271
            },
            {
              "module": "pid 7824 module WINSPOOL.DRV"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 272
            },
            {
              "module": "pid 7824 module sfc_os.DLL"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 273
            },
            {
              "module": "pid 7824 module IMM32.DLL"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 274
            },
            {
              "module": "pid 7824 module CRYPT32.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 275
            },
            {
              "module": "pid 7824 module WS2_32.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 276
            },
            {
              "module": "pid 7824 module ADVAPI32.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 277
            },
            {
              "module": "pid 7824 module sechost.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 278
            },
            {
              "module": "pid 7824 module ole32.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 279
            },
            {
              "module": "pid 7824 module CRYPTBASE.DLL"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 280
            },
            {
              "module": "pid 7824 module SspiCli.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 281
            },
            {
              "module": "pid 7824 module msimg32.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 282
            },
            {
              "module": "pid 7824 module kernel.appcore.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 283
            },
            {
              "module": "pid 7824 module bcryptPrimitives.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 284
            },
            {
              "module": "pid 7824 module uxtheme.dll"
            },
            {
              "type": "call",
              "pid": 7824,
              "cid": 285
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "stealth_window",
          "description": "A process created a hidden window",
          "categories": [
            "stealth"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "process": "njJ99fo.exe -> C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe"
            },
            {
              "type": "call",
              "pid": 4852,
              "cid": 473
            },
            {
              "process": "mnolyk.exe -> SCHTASKS"
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3976
            },
            {
              "process": "mnolyk.exe -> cmd"
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 4609
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "terminates_remote_process",
          "description": "Terminates another process",
          "categories": [
            "persistence",
            "stealth"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 1056,
              "cid": 21
            },
            {
              "process": "svchost.exe"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "uses_windows_utilities",
          "description": "Uses Windows utilities for basic functionality",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
            },
            {
              "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
            },
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "C:\\Windows\\system32\\cmd.exe  /S /D /c\" echo Y\""
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "uses_windows_utilities_to_create_scheduled_task",
          "description": "Uses Windows utilities to create a scheduled task",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 2,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antisandbox_unhook",
          "description": "Tries to unhook or modify Windows functions monitored by CAPE",
          "categories": [
            "anti-sandbox"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 60,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 1476,
              "cid": 442
            },
            {
              "type": "call",
              "pid": 1260,
              "cid": 270
            },
            {
              "unhook": "function_name: VarBstrCat, type: removal"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antivm_generic_system",
          "description": "Checks the system manufacturer, likely for anti-virtualization",
          "categories": [
            "anti-vm"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [],
          "new_data": [
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 3504
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            },
            {
              "process": {
                "process_name": "wermgr.exe",
                "process_id": 7972
              },
              "signs": [
                {
                  "type": "registry",
                  "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
                }
              ]
            }
          ],
          "alert": false,
          "families": []
        },
        {
          "name": "infostealer_cookies",
          "description": "Touches a file containing cookies, possibly for information gathering",
          "categories": [
            "infostealer"
          ],
          "severity": 3,
          "weight": 4,
          "confidence": 100,
          "references": [],
          "data": [],
          "new_data": [
            {
              "process": {
                "process_name": "mnolyk.exe",
                "process_id": 7880
              },
              "signs": [
                {
                  "type": "file",
                  "value": "C:\\Users\\sanya\\AppData\\Local\\Microsoft\\Windows\\INetCookies"
                }
              ]
            }
          ],
          "alert": false,
          "families": []
        },
        {
          "name": "persistence_autorun_tasks",
          "description": "Installs itself for autorun at Windows startup",
          "categories": [
            "persistence"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 5188,
              "cid": 213
            },
            {
              "type": "call",
              "pid": 3252,
              "cid": 213
            },
            {
              "type": "call",
              "pid": 2028,
              "cid": 205
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 961
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 967
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 971
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 975
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 979
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 985
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 989
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 996
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 1018
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 1021
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 1025
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 1029
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 1033
            },
            {
              "type": "call",
              "pid": 3296,
              "cid": 1037
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 38
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3233
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3234
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3235
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3236
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3325
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3326
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3327
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 3328
            },
            {
              "task": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "recon_beacon",
          "description": "A process sent information about the computer to a remote location.",
          "categories": [
            "network",
            "discovery"
          ],
          "severity": 3,
          "weight": 2,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "type": "call",
              "pid": 7880,
              "cid": 4709
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5093
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5202
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5241
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5291
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5333
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5374
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5442
            },
            {
              "type": "call",
              "pid": 7880,
              "cid": 5459
            },
            {
              "Beacon": "mnolyk.exe: id=260811189190&vs=3.66&sd=3c9b7e&os=1&bi=1&ar=1&pc=DESKTOP-KJGI8L3&un=sanya&dm=&av=13&lv=0&og=1"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "antiav_detectfile",
          "description": "Attempts to identify installed AV products by installation directory",
          "categories": [
            "anti-av"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [],
          "data": [
            {
              "file": "C:\\ProgramData\\AVAST Software"
            },
            {
              "file": "C:\\ProgramData\\Avira"
            },
            {
              "file": "C:\\ProgramData\\Kaspersky Lab"
            },
            {
              "file": "C:\\ProgramData\\ESET"
            },
            {
              "file": "C:\\ProgramData\\Panda Security"
            },
            {
              "file": "C:\\ProgramData\\Bitdefender"
            },
            {
              "file": "C:\\ProgramData\\AVG"
            },
            {
              "file": "C:\\ProgramData\\Doctor Web"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "cmdline_obfuscation",
          "description": "Appears to use command line obfuscation",
          "categories": [
            "command"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 100,
          "references": [
            "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf"
          ],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        },
        {
          "name": "suspicious_command_tools",
          "description": "Uses suspicious command line tools or Windows utilities",
          "categories": [
            "command",
            "lateral"
          ],
          "severity": 3,
          "weight": 1,
          "confidence": 80,
          "references": [],
          "data": [
            {
              "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
            },
            {
              "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
            },
            {
              "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
            },
            {
              "command": "CACLS  \"mnolyk.exe\" /P \"sanya:N\""
            },
            {
              "command": "CACLS  \"mnolyk.exe\" /P \"sanya:R\" /E"
            },
            {
              "command": "CACLS  \"..\\5eb6b96734\" /P \"sanya:N\""
            },
            {
              "command": "CACLS  \"..\\5eb6b96734\" /P \"sanya:R\" /E"
            }
          ],
          "new_data": [],
          "alert": false,
          "families": []
        }
      ],
      "failure_reason": "Rule caused crash: ['exec_crash']",
      "improvement_suggestions": [],
      "debugger_log": "=== 3296.log ===\nCAPE Sandbox - Debugger log: Sat Dec 20 18:34:31 2025\nBreakpoint 0 hit by instruction at 0x00007FFA7FA84CCD (thread 6124) RBX=0x36e110 RCX=0x36dfe8 RDX=0x4083768 RSI=0x36dfe8 RDI=0x36df98 RSP=0x36df40 *RSP=0x835df0 RBP=0x36e000 R8=0x835df0 R9=0x1 R10=0x4 R11=0x3 R12=0x1 R13=0x82e298 R14=0x36e110 R15=0x4 Xmm1.Low=0x7fb380f0\n0x00007FFA7FA84CCD  488BF1                   MOV       RSI, RCX                      \nActionDispatcher: skipping instruction.\n0x00007FFA7FA84CD0  488BFA                   MOV       RDI, RDX                      \nBreakpoint 0 hit by instruction at 0x00007FFA7FA84CCD (thread 6124) RBX=0x36e110 RCX=0x36dfd8 RDX=0x40837d0 RSI=0x36dfd8 RDI=0x36df98 \" 0\" RSP=0x36df40 \"Pa\" *RSP=0x836150 RBP=0x36e000 R9=0x7ff5b606208e R10=0x4 R11=0x36d850 R12=0x1 R13=0x82e298 R14=0x36e110 R15=0x4 Xmm1.Low=0x7fb38028\n0x00007FFA7FA84CCD  488BF1                   MOV       RSI, RCX                      \nActionDispatcher: skipping instruction.\n0x00007FFA7FA84CD0  488BFA                   MOV       RDI, RDX                      \n\n\n=== 5264.log ===\nCAPE Sandbox - Debugger log: Sat Dec 20 18:34:48 2025\nBreakpoint 1 hit by instruction at 0x06B58758 (thread 2384) ECX=0x6acd92ee clr.dll EDX=0xcbb540 \"TL\" ESI=0x4661420 EDI=0xce4bf8 ESP=0x9ced58 *ESP=0xce4bf8 EBP=0x9ced80\n0x06B58758  53                       PUSH      EBX                           \nActionDispatcher: skipping instruction.\n0x06B58759  8BCE                     MOV       ECX, ESI                      \n\n\n=== 7824.log ===\nCAPE Sandbox - Debugger log: Sat Dec 20 18:35:09 2025\nBreakpoint 1 hit by instruction at 0x04198758 (thread 7844) EAX=0x4241440 ECX=0x424132c EDX=0xd ESI=0x424132c EDI=0x74b050 ESP=0x19d358 *ESP=0x74b050 EBP=0x19d380\n0x04198758  53                       PUSH      EBX                           \nActionDispatcher: skipping instruction.\n0x04198759  8BCE                     MOV       ECX, ESI                      \n",
      "raw_response": "**EVOLUTION_REASONING**: We are evolving the YARA bypass rule to target the evasion technique used by the malware sample with SHA256: 1714d4efa0fffd2d33e1257d95ebd6ff8b9417f3fcc2710e7171c7827e8ae0cb. The previous attempts resulted in \"Rule hit but no new signatures,\" indicating that the pattern matched, but the wrong location was targeted.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 80\n\n**REASONING**: Based on the analysis of the original trace, we will target the evasion check at the beginning of the malware's execution. We observed a sequence of instructions that includes a conditional check (TEST EAX) followed by a jump (JE/JNE). This is a common evasion technique used to delay or prevent detection.\n\n**YARA_RULE**:\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 0F 84 ?? ?? ?? ?? }  // test eax, je\n        $pattern1 = { 8B CE E8 ?? ?? ?? ?? }  // mov ecx, esi, call\n        $pattern2 = { 85 C0 0F 83 ?? ?? ?? ?? }  // test eax, jne\n\n    condition:\n        any of them\n}\n```\nThe three patterns target the evasion check sequence:\n\n1. `$pattern0` matches the TEST EAX instruction (85 C0) followed by a jump (0F 84).\n2. `$pattern1` targets the MOV ECX, ESI instruction (8B CE) and the CALL instruction (E8).\n3. `$pattern2` matches the second occurrence of the TEST EAX instruction (85 C0) followed by a jump (0F 83).\n\nEach pattern is approximately 6-10 bytes long, with wildcards used for address/offset bytes to ensure specificity without over-reliance on exact addresses.\n\nThis rule targets the evasion check at the beginning of the malware's execution and has a confidence level of 80% based on the analysis of the original trace.",
      "yara_file": "ablation_results\\llama3.1_8b\\Iter\\Iter\\1714d4efa0fffd2d\\iter2_v0.yar"
    }
  ],
  "best_attempt": {
    "iteration": 2,
    "prompt_version": "v0",
    "yara_rule": "rule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 0F 84 ?? ?? ?? ?? }  // test eax, je\n        $pattern1 = { 8B CE E8 ?? ?? ?? ?? }  // mov ecx, esi, call\n        $pattern2 = { 85 C0 0F 83 ?? ?? ?? ?? }  // test eax, jne\n\n    condition:\n        any of them\n}",
    "pattern_type": "CALL_TEST_JE",
    "confidence": 80,
    "opcodes": "",
    "task_id": "1930",
    "status": "bypass_crashed",
    "rule_hit": true,
    "baseline_signatures": 15,
    "new_signatures": 23,
    "new_signature_names": [
      "antisandbox_unhook",
      "injection_write_process",
      "creates_suspended_process",
      "resumethread_remote_process",
      "suspicious_command_tools",
      "createtoolhelp32snapshot_module_enumeration",
      "dynamic_function_loading",
      "queries_computer_name",
      "recon_beacon",
      "persistence_autorun_tasks",
      "antivm_generic_system",
      "queries_keyboard_layout",
      "cmdline_obfuscation",
      "antisandbox_sleep",
      "queries_locale_api",
      "stealth_timeout",
      "terminates_remote_process",
      "uses_windows_utilities",
      "uses_windows_utilities_to_create_scheduled_task",
      "infostealer_cookies",
      "http_request",
      "stealth_window",
      "antiav_detectfile"
    ],
    "new_signature_details": [
      {
        "name": "queries_computer_name",
        "description": "Queries computer hostname",
        "categories": [
          "system_discovery"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 8584,
            "cid": 133
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "dynamic_function_loading",
        "description": "Dynamic (imported) function loading detected",
        "categories": [
          "anti-debug"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 40,
        "references": [],
        "data": [
          {
            "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3908
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3909
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3910
          },
          {
            "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3911
          },
          {
            "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3912
          },
          {
            "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3913
          },
          {
            "DynamicLoader": "apphelp.dll/SdbQueryContext"
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3914
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpQueryModuleDataEx"
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 155
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpCreateAppcompatData"
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 156
          },
          {
            "DynamicLoader": "apphelp.dll/ApphelpChpeModSettingsFromQueryResult"
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 157
          },
          {
            "DynamicLoader": "apphelp.dll/SdbInitDatabaseEx"
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 158
          },
          {
            "DynamicLoader": "apphelp.dll/SdbReleaseDatabase"
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 159
          },
          {
            "DynamicLoader": "apphelp.dll/SdbUnpackQueryResult"
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 160
          },
          {
            "DynamicLoader": "apphelp.dll/SdbQueryContext"
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 161
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "queries_keyboard_layout",
        "description": "Queries the keyboard layout",
        "categories": [
          "location_discovery"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 7880,
            "cid": 3985
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 4608
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5175
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "queries_locale_api",
        "description": "Queries the computer locale (possible geofencing)",
        "categories": [
          "location_discovery",
          "geofence"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 7880,
            "cid": 1068
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 1089
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3762
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 4080
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 4101
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 4484
          },
          {
            "type": "call",
            "pid": 8584,
            "cid": 135
          },
          {
            "type": "call",
            "pid": 8584,
            "cid": 140
          },
          {
            "type": "call",
            "pid": 8584,
            "cid": 164
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 71
          },
          {
            "type": "call",
            "pid": 3832,
            "cid": 67
          },
          {
            "type": "call",
            "pid": 3804,
            "cid": 22
          },
          {
            "type": "call",
            "pid": 3804,
            "cid": 31
          },
          {
            "type": "call",
            "pid": 7008,
            "cid": 21
          },
          {
            "type": "call",
            "pid": 7008,
            "cid": 30
          },
          {
            "type": "call",
            "pid": 7596,
            "cid": 67
          },
          {
            "type": "call",
            "pid": 1744,
            "cid": 22
          },
          {
            "type": "call",
            "pid": 1744,
            "cid": 31
          },
          {
            "type": "call",
            "pid": 9148,
            "cid": 23
          },
          {
            "type": "call",
            "pid": 9148,
            "cid": 32
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 2502
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 6871
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 10519
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 14165
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 17813
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 21453
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 25093
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 28734
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 2540
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 6908
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 10555
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 14198
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 17830
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 21472
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 25108
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 28738
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 31340
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 34036
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 37005
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 40710
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "stealth_timeout",
        "description": "Possible date expiration check, exits too soon after checking local time",
        "categories": [
          "stealth"
        ],
        "severity": 1,
        "weight": 1,
        "confidence": 40,
        "references": [],
        "data": [
          {
            "process": "njJ99fo.exe, PID 4852"
          },
          {
            "type": "call",
            "pid": 4852,
            "cid": 478
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "antisandbox_sleep",
        "description": "A process attempted to delay the analysis task.",
        "categories": [
          "anti-sandbox"
        ],
        "severity": 2,
        "weight": 4,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 3296,
            "cid": 845
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 920
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 1000
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 1006
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 1012
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 4611
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 4693
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 4697
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5048
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5088
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5099
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5108
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5177
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5198
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5232
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5247
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5262
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5263
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5303
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5316
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5329
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5339
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5370
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5387
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5394
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5409
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5448
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5449
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5476
          },
          {
            "type": "call",
            "pid": 7892,
            "cid": 1005
          },
          {
            "type": "call",
            "pid": 1476,
            "cid": 448
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 5836
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 6124
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 15990
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 27086
          },
          {
            "type": "call",
            "pid": 3504,
            "cid": 31292
          },
          {
            "type": "call",
            "pid": 1260,
            "cid": 393
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 6145
          },
          {
            "type": "call",
            "pid": 7972,
            "cid": 33758
          },
          {
            "note": "mnolyk.exe tried to sleep 1181.0 seconds, actually delayed analysis time by 0.0 seconds"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "http_request",
        "description": "Performs HTTP requests potentially not found in PCAP.",
        "categories": [
          "network"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 7880,
            "cid": 5181
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5253
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5320
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5391
          },
          {
            "url": "193.233.20.4:80//t6r48nSa/index.php"
          },
          {
            "url": "193.233.20.4:80//t6r48nSa/index.php"
          },
          {
            "url": "193.233.20.4:80//t6r48nSa/index.php"
          },
          {
            "url": "193.233.20.4:80//t6r48nSa/index.php"
          },
          {
            "url": "193.233.20.4:80//t6r48nSa/index.php"
          },
          {
            "url": "http://193.233.20.4/t6r48nSa/Plugins/clip64.dll"
          },
          {
            "url": "http://193.233.20.4/t6r48nSa/Plugins/cred64.dll"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "creates_suspended_process",
        "description": "Creates a process in a suspended state, likely for injection",
        "categories": [
          "injection",
          "process hollowing"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 50,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 1056,
            "cid": 11
          },
          {
            "type": "call",
            "pid": 1056,
            "cid": 24
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "resumethread_remote_process",
        "description": "Resumed a thread in another process",
        "categories": [
          "injection",
          "unpacking"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "thread_resumed": "Process mnolyk.exe with process ID 7880 resumed a thread in another process with the process ID 8584"
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3933
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 4553
          },
          {
            "thread_resumed": "Process cmd.exe with process ID 7036 resumed a thread in another process with the process ID 3832"
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 175
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 247
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 306
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 357
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 428
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 488
          },
          {
            "thread_resumed": "Process svchost.exe with process ID 1056 resumed a thread in another process with the process ID 3504"
          },
          {
            "type": "call",
            "pid": 1056,
            "cid": 12
          },
          {
            "type": "call",
            "pid": 1056,
            "cid": 25
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "injection_write_process",
        "description": "Writes to the memory another process",
        "categories": [
          "injection",
          "unpacking"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "write_memory": "Process mnolyk.exe with process ID 7880 wrote to the memory of process handle 0x00000538"
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3924
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3926
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3927
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 4540
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 4542
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 4543
          },
          {
            "write_memory": "Process cmd.exe with process ID 7036 wrote to the memory of process handle 0x000002d0"
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 171
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 173
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 174
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 243
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 245
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 246
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 302
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 304
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 305
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 353
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 355
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 356
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 424
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 426
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 427
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 484
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 486
          },
          {
            "type": "call",
            "pid": 7036,
            "cid": 487
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "createtoolhelp32snapshot_module_enumeration",
        "description": "Enumerates the modules from a process (may be used to locate base addresses in process injection)",
        "categories": [
          "discovery"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 7824,
            "cid": 248
          },
          {
            "module": "pid 7824 module ntdll.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 250
          },
          {
            "module": "pid 7824 module KERNEL32.DLL"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 251
          },
          {
            "module": "pid 7824 module KERNELBASE.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 252
          },
          {
            "module": "pid 7824 module apphelp.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 253
          },
          {
            "module": "pid 7824 module AcLayers.DLL"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 254
          },
          {
            "module": "pid 7824 module msvcrt.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 255
          },
          {
            "module": "pid 7824 module USER32.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 256
          },
          {
            "module": "pid 7824 module win32u.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 257
          },
          {
            "module": "pid 7824 module GDI32.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 258
          },
          {
            "module": "pid 7824 module gdi32full.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 259
          },
          {
            "module": "pid 7824 module msvcp_win.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 260
          },
          {
            "module": "pid 7824 module ucrtbase.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 261
          },
          {
            "module": "pid 7824 module SHELL32.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 262
          },
          {
            "module": "pid 7824 module SHLWAPI.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 263
          },
          {
            "module": "pid 7824 module OLEAUT32.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 264
          },
          {
            "module": "pid 7824 module combase.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 265
          },
          {
            "module": "pid 7824 module RPCRT4.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 266
          },
          {
            "module": "pid 7824 module SETUPAPI.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 267
          },
          {
            "module": "pid 7824 module cfgmgr32.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 268
          },
          {
            "module": "pid 7824 module bcrypt.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 269
          },
          {
            "module": "pid 7824 module MPR.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 270
          },
          {
            "module": "pid 7824 module sfc.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 271
          },
          {
            "module": "pid 7824 module WINSPOOL.DRV"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 272
          },
          {
            "module": "pid 7824 module sfc_os.DLL"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 273
          },
          {
            "module": "pid 7824 module IMM32.DLL"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 274
          },
          {
            "module": "pid 7824 module CRYPT32.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 275
          },
          {
            "module": "pid 7824 module WS2_32.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 276
          },
          {
            "module": "pid 7824 module ADVAPI32.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 277
          },
          {
            "module": "pid 7824 module sechost.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 278
          },
          {
            "module": "pid 7824 module ole32.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 279
          },
          {
            "module": "pid 7824 module CRYPTBASE.DLL"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 280
          },
          {
            "module": "pid 7824 module SspiCli.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 281
          },
          {
            "module": "pid 7824 module msimg32.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 282
          },
          {
            "module": "pid 7824 module kernel.appcore.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 283
          },
          {
            "module": "pid 7824 module bcryptPrimitives.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 284
          },
          {
            "module": "pid 7824 module uxtheme.dll"
          },
          {
            "type": "call",
            "pid": 7824,
            "cid": 285
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "stealth_window",
        "description": "A process created a hidden window",
        "categories": [
          "stealth"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "process": "njJ99fo.exe -> C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe"
          },
          {
            "type": "call",
            "pid": 4852,
            "cid": 473
          },
          {
            "process": "mnolyk.exe -> SCHTASKS"
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3976
          },
          {
            "process": "mnolyk.exe -> cmd"
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 4609
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "terminates_remote_process",
        "description": "Terminates another process",
        "categories": [
          "persistence",
          "stealth"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 1056,
            "cid": 21
          },
          {
            "process": "svchost.exe"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "uses_windows_utilities",
        "description": "Uses Windows utilities for basic functionality",
        "categories": [
          "command",
          "lateral"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 80,
        "references": [],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
          },
          {
            "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
          },
          {
            "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "C:\\Windows\\system32\\cmd.exe  /S /D /c\" echo Y\""
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "uses_windows_utilities_to_create_scheduled_task",
        "description": "Uses Windows utilities to create a scheduled task",
        "categories": [
          "command",
          "lateral"
        ],
        "severity": 2,
        "weight": 1,
        "confidence": 80,
        "references": [],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "antisandbox_unhook",
        "description": "Tries to unhook or modify Windows functions monitored by CAPE",
        "categories": [
          "anti-sandbox"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 60,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 1476,
            "cid": 442
          },
          {
            "type": "call",
            "pid": 1260,
            "cid": 270
          },
          {
            "unhook": "function_name: VarBstrCat, type: removal"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "antivm_generic_system",
        "description": "Checks the system manufacturer, likely for anti-virtualization",
        "categories": [
          "anti-vm"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [],
        "new_data": [
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 3504
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          },
          {
            "process": {
              "process_name": "wermgr.exe",
              "process_id": 7972
            },
            "signs": [
              {
                "type": "registry",
                "value": "HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\SystemInformation\\SystemManufacturer"
              }
            ]
          }
        ],
        "alert": false,
        "families": []
      },
      {
        "name": "infostealer_cookies",
        "description": "Touches a file containing cookies, possibly for information gathering",
        "categories": [
          "infostealer"
        ],
        "severity": 3,
        "weight": 4,
        "confidence": 100,
        "references": [],
        "data": [],
        "new_data": [
          {
            "process": {
              "process_name": "mnolyk.exe",
              "process_id": 7880
            },
            "signs": [
              {
                "type": "file",
                "value": "C:\\Users\\sanya\\AppData\\Local\\Microsoft\\Windows\\INetCookies"
              }
            ]
          }
        ],
        "alert": false,
        "families": []
      },
      {
        "name": "persistence_autorun_tasks",
        "description": "Installs itself for autorun at Windows startup",
        "categories": [
          "persistence"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 5188,
            "cid": 213
          },
          {
            "type": "call",
            "pid": 3252,
            "cid": 213
          },
          {
            "type": "call",
            "pid": 2028,
            "cid": 205
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 961
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 967
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 971
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 975
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 979
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 985
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 989
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 996
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 1018
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 1021
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 1025
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 1029
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 1033
          },
          {
            "type": "call",
            "pid": 3296,
            "cid": 1037
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 38
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3233
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3234
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3235
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3236
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3325
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3326
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3327
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 3328
          },
          {
            "task": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "recon_beacon",
        "description": "A process sent information about the computer to a remote location.",
        "categories": [
          "network",
          "discovery"
        ],
        "severity": 3,
        "weight": 2,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "type": "call",
            "pid": 7880,
            "cid": 4709
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5093
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5202
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5241
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5291
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5333
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5374
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5442
          },
          {
            "type": "call",
            "pid": 7880,
            "cid": 5459
          },
          {
            "Beacon": "mnolyk.exe: id=260811189190&vs=3.66&sd=3c9b7e&os=1&bi=1&ar=1&pc=DESKTOP-KJGI8L3&un=sanya&dm=&av=13&lv=0&og=1"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "antiav_detectfile",
        "description": "Attempts to identify installed AV products by installation directory",
        "categories": [
          "anti-av"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [],
        "data": [
          {
            "file": "C:\\ProgramData\\AVAST Software"
          },
          {
            "file": "C:\\ProgramData\\Avira"
          },
          {
            "file": "C:\\ProgramData\\Kaspersky Lab"
          },
          {
            "file": "C:\\ProgramData\\ESET"
          },
          {
            "file": "C:\\ProgramData\\Panda Security"
          },
          {
            "file": "C:\\ProgramData\\Bitdefender"
          },
          {
            "file": "C:\\ProgramData\\AVG"
          },
          {
            "file": "C:\\ProgramData\\Doctor Web"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "cmdline_obfuscation",
        "description": "Appears to use command line obfuscation",
        "categories": [
          "command"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 100,
        "references": [
          "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf"
        ],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      },
      {
        "name": "suspicious_command_tools",
        "description": "Uses suspicious command line tools or Windows utilities",
        "categories": [
          "command",
          "lateral"
        ],
        "severity": 3,
        "weight": 1,
        "confidence": 80,
        "references": [],
        "data": [
          {
            "command": "\"C:\\Windows\\System32\\schtasks.exe\" /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
          },
          {
            "command": "SCHTASKS /Create /SC MINUTE /MO 1 /TN mnolyk.exe /TR \"C:\\Users\\sanya\\AppData\\Local\\Temp\\5eb6b96734\\mnolyk.exe\" /F"
          },
          {
            "command": "\"C:\\Windows\\System32\\cmd.exe\" /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "cmd /k echo Y|CACLS \"mnolyk.exe\" /P \"sanya:N\"&&CACLS \"mnolyk.exe\" /P \"sanya:R\" /E&&echo Y|CACLS \"..\\5eb6b96734\" /P \"sanya:N\"&&CACLS \"..\\5eb6b96734\" /P \"sanya:R\" /E&&Exit"
          },
          {
            "command": "CACLS  \"mnolyk.exe\" /P \"sanya:N\""
          },
          {
            "command": "CACLS  \"mnolyk.exe\" /P \"sanya:R\" /E"
          },
          {
            "command": "CACLS  \"..\\5eb6b96734\" /P \"sanya:N\""
          },
          {
            "command": "CACLS  \"..\\5eb6b96734\" /P \"sanya:R\" /E"
          }
        ],
        "new_data": [],
        "alert": false,
        "families": []
      }
    ],
    "failure_reason": "Rule caused crash: ['exec_crash']",
    "improvement_suggestions": [],
    "debugger_log": "=== 3296.log ===\nCAPE Sandbox - Debugger log: Sat Dec 20 18:34:31 2025\nBreakpoint 0 hit by instruction at 0x00007FFA7FA84CCD (thread 6124) RBX=0x36e110 RCX=0x36dfe8 RDX=0x4083768 RSI=0x36dfe8 RDI=0x36df98 RSP=0x36df40 *RSP=0x835df0 RBP=0x36e000 R8=0x835df0 R9=0x1 R10=0x4 R11=0x3 R12=0x1 R13=0x82e298 R14=0x36e110 R15=0x4 Xmm1.Low=0x7fb380f0\n0x00007FFA7FA84CCD  488BF1                   MOV       RSI, RCX                      \nActionDispatcher: skipping instruction.\n0x00007FFA7FA84CD0  488BFA                   MOV       RDI, RDX                      \nBreakpoint 0 hit by instruction at 0x00007FFA7FA84CCD (thread 6124) RBX=0x36e110 RCX=0x36dfd8 RDX=0x40837d0 RSI=0x36dfd8 RDI=0x36df98 \" 0\" RSP=0x36df40 \"Pa\" *RSP=0x836150 RBP=0x36e000 R9=0x7ff5b606208e R10=0x4 R11=0x36d850 R12=0x1 R13=0x82e298 R14=0x36e110 R15=0x4 Xmm1.Low=0x7fb38028\n0x00007FFA7FA84CCD  488BF1                   MOV       RSI, RCX                      \nActionDispatcher: skipping instruction.\n0x00007FFA7FA84CD0  488BFA                   MOV       RDI, RDX                      \n\n\n=== 5264.log ===\nCAPE Sandbox - Debugger log: Sat Dec 20 18:34:48 2025\nBreakpoint 1 hit by instruction at 0x06B58758 (thread 2384) ECX=0x6acd92ee clr.dll EDX=0xcbb540 \"TL\" ESI=0x4661420 EDI=0xce4bf8 ESP=0x9ced58 *ESP=0xce4bf8 EBP=0x9ced80\n0x06B58758  53                       PUSH      EBX                           \nActionDispatcher: skipping instruction.\n0x06B58759  8BCE                     MOV       ECX, ESI                      \n\n\n=== 7824.log ===\nCAPE Sandbox - Debugger log: Sat Dec 20 18:35:09 2025\nBreakpoint 1 hit by instruction at 0x04198758 (thread 7844) EAX=0x4241440 ECX=0x424132c EDX=0xd ESI=0x424132c EDI=0x74b050 ESP=0x19d358 *ESP=0x74b050 EBP=0x19d380\n0x04198758  53                       PUSH      EBX                           \nActionDispatcher: skipping instruction.\n0x04198759  8BCE                     MOV       ECX, ESI                      \n",
    "raw_response": "**EVOLUTION_REASONING**: We are evolving the YARA bypass rule to target the evasion technique used by the malware sample with SHA256: 1714d4efa0fffd2d33e1257d95ebd6ff8b9417f3fcc2710e7171c7827e8ae0cb. The previous attempts resulted in \"Rule hit but no new signatures,\" indicating that the pattern matched, but the wrong location was targeted.\n\n**PATTERN_TYPE**: CALL_TEST_JE\n\n**CONFIDENCE**: 80\n\n**REASONING**: Based on the analysis of the original trace, we will target the evasion check at the beginning of the malware's execution. We observed a sequence of instructions that includes a conditional check (TEST EAX) followed by a jump (JE/JNE). This is a common evasion technique used to delay or prevent detection.\n\n**YARA_RULE**:\n```yara\nrule Bypass_Sample_Evolved\n{\n    meta:\n        description = \"Evasion bypass rule - evolved\"\n        cape_options = \"bp0=$pattern0+0,action0=skip,bp1=$pattern1+0,action1=skip,bp2=$pattern2+0,action2=skip,count=0\"\n\n    strings:\n        $pattern0 = { 85 C0 0F 84 ?? ?? ?? ?? }  // test eax, je\n        $pattern1 = { 8B CE E8 ?? ?? ?? ?? }  // mov ecx, esi, call\n        $pattern2 = { 85 C0 0F 83 ?? ?? ?? ?? }  // test eax, jne\n\n    condition:\n        any of them\n}\n```\nThe three patterns target the evasion check sequence:\n\n1. `$pattern0` matches the TEST EAX instruction (85 C0) followed by a jump (0F 84).\n2. `$pattern1` targets the MOV ECX, ESI instruction (8B CE) and the CALL instruction (E8).\n3. `$pattern2` matches the second occurrence of the TEST EAX instruction (85 C0) followed by a jump (0F 83).\n\nEach pattern is approximately 6-10 bytes long, with wildcards used for address/offset bytes to ensure specificity without over-reliance on exact addresses.\n\nThis rule targets the evasion check at the beginning of the malware's execution and has a confidence level of 80% based on the analysis of the original trace.",
    "yara_file": "ablation_results\\llama3.1_8b\\Iter\\Iter\\1714d4efa0fffd2d\\iter2_v0.yar"
  },
  "best_score": 23,
  "optimization_history": [
    "Iteration 1: rule_hit - Rule hit but no new signatures",
    "Iteration 2: rule_hit - Rule hit but no new signatures",
    "Iteration 3: SUCCESS - 23 new signatures"
  ],
  "successful_patterns": [
    ""
  ],
  "failed_patterns": [
    "",
    ""
  ]
}